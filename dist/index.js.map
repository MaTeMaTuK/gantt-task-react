{"version":3,"file":"index.js","sources":["../src/types/public-types.ts","../src/helpers/date-helper.ts","../src/helpers/dicts.ts","../src/components/other/tooltip.tsx","../src/components/icons/unconnection.js","../src/components/icons/connection.js","../src/components/other/deleteTooltip.tsx","../src/components/other/vertical-scroll.tsx","../src/contsxt.ts","../src/components/grid/grid-body.tsx","../src/components/grid/grid.tsx","../src/components/calendar/top-part-of-calendar.tsx","../src/components/calendar/calendar.tsx","../node_modules/babel-plugin-transform-async-to-promises/helpers.js","../src/components/other/arrow.tsx","../src/helpers/other-helper.ts","../src/helpers/bar-helper.ts","../src/components/task-item/bar/bar-display.tsx","../src/components/task-item/bar/bar-date-handle.tsx","../src/components/task-item/bar/bar-progress-handle.tsx","../src/helpers/jsPlumbConfig.ts","../src/components/task-item/hook.ts","../src/components/task-item/bar/bar.tsx","../src/components/task-item/bar/bar-small.tsx","../src/components/task-item/bar/parent-bar-display.tsx","../src/components/task-item/bar/bar-parent.tsx","../src/components/task-item/milestone/utils.ts","../src/components/task-item/milestone/milestone.tsx","../src/components/task-item/project/project.tsx","../src/components/task-item/task-item.tsx","../src/components/task-item/task-item-log.tsx","../src/components/gantt/task-gantt-content.tsx","../src/components/gantt/task-gantt.tsx","../src/components/other/horizontal-scroll.tsx","../src/components/gantt-config/time-modal.tsx","../src/components/icons/warning.js","../src/components/gantt-config/time.tsx","../src/components/gantt-config/other-config.tsx","../src/components/gantt-config/baseline/add-edit.tsx","../src/components/icons/checked.js","../src/components/gantt-config/baseline/index.tsx","../src/components/gantt-config/display.tsx","../src/components/icons/collapseIcon.js","../src/components/gantt-config/index.tsx","../src/components/gantt/guide-modal.tsx","../src/components/icons/arrow.js","../src/helpers/utils.ts","../src/components/gantt/data-mode.tsx","../src/components/gantt/gantt.tsx"],"sourcesContent":["import React from \"react\";\r\n\r\nexport enum ViewMode {\r\n  QuarterDay = \"Quarter Day\",\r\n  HalfDay = \"Half Day\",\r\n  Day = \"Day\",\r\n  /** ISO-8601 week */\r\n  Week = \"Week\",\r\n  Month = \"Month\",\r\n  Year = \"Year\",\r\n  Quarter = \"Quarter\",\r\n}\r\nexport const viewModeOptions = [\r\n  {\r\n    label: \"日\",\r\n    value: \"Day\",\r\n  },\r\n  {\r\n    label: \"周\",\r\n    value: \"Week\",\r\n  },\r\n  {\r\n    label: \"月\",\r\n    value: \"Month\",\r\n  },\r\n  {\r\n    label: \"季\",\r\n    value: \"Quarter\",\r\n  },\r\n\r\n  {\r\n    label: \"年\",\r\n    value: \"Year\",\r\n  },\r\n];\r\nexport type TaskType = \"task\" | \"milestone\" | \"project\" | \"parent\";\r\n\r\nexport interface OptionsProp {\r\n  label: string;\r\n  value: string;\r\n  objectId?: string;\r\n}\r\nexport interface Task {\r\n  id: string;\r\n  type: TaskType;\r\n  name: string;\r\n  start: Date;\r\n  end: Date;\r\n  progress: number;\r\n  styles?: {\r\n    backgroundColor?: string;\r\n    backgroundSelectedColor?: string;\r\n    progressColor?: string;\r\n    progressSelectedColor?: string;\r\n  };\r\n  isDisabled?: boolean;\r\n  project?: string;\r\n  dependencies?: string[];\r\n  item?: {\r\n    [propName: string]: any;\r\n  };\r\n}\r\nexport interface ItemLink {\r\n  objectId: string;\r\n  destination: object;\r\n  linkType: object;\r\n  source: object;\r\n  [propName: string]: any;\r\n}\r\n\r\nexport interface EventOption {\r\n  /**\r\n   * Time step value for date changes.\r\n   */\r\n  timeStep?: number;\r\n  /**\r\n   * Invokes on bar select on unselect.\r\n   */\r\n  onSelect?: (task: Task, isSelected: boolean) => void;\r\n  /**\r\n   * Invokes on bar double click.\r\n   */\r\n  onDoubleClick?: (task: Task) => void;\r\n  /**\r\n   * Invokes on end and start time change. Chart undoes operation if method return false or error.\r\n   */\r\n  onDateChange?: (\r\n    task: Task\r\n  ) => void | boolean | Promise<void> | Promise<boolean>;\r\n  /**\r\n   * Invokes on progress change. Chart undoes operation if method return false or error.\r\n   */\r\n  onProgressChange?: (\r\n    task: Task\r\n  ) => void | boolean | Promise<void> | Promise<boolean>;\r\n  /**\r\n   * Invokes on delete selected task. Chart undoes operation if method return false or error.\r\n   */\r\n  onDelete?: (task: Task) => void | boolean | Promise<void> | Promise<boolean>;\r\n}\r\n\r\nexport interface DisplayOption {\r\n  viewMode?: ViewMode;\r\n  /**\r\n   * Specifies the month name language. Able formats: ISO 639-2, Java Locale\r\n   */\r\n  locale?: string;\r\n}\r\nexport interface ConfigOption {\r\n  isBaseLine?: boolean; // 是否显示基线\r\n  isDisplayConfig?: boolean; // 是否有显示配置\r\n  isSetting?: boolean; // 是否显示配置按钮\r\n  isViewModeChange?: boolean; // 是否视图切换\r\n  isToToday?: boolean; // 是否定位到当天\r\n}\r\nexport interface StylingOption {\r\n  headerHeight?: number;\r\n  columnWidth?: number;\r\n  listCellWidth?: string;\r\n  rowHeight?: number;\r\n  ganttHeight?: number;\r\n  barCornerRadius?: number;\r\n  handleWidth?: number;\r\n  fontFamily?: string;\r\n  fontSize?: string;\r\n  listWidth?: number;\r\n  listBottomHeight?: number;\r\n  /**\r\n   * How many of row width can be taken by task.\r\n   * From 0 to 100\r\n   */\r\n  barFill?: number;\r\n  barProgressColor?: string;\r\n  barProgressSelectedColor?: string;\r\n  barBackgroundColor?: string;\r\n  barBackgroundSelectedColor?: string;\r\n  projectProgressColor?: string;\r\n  projectProgressSelectedColor?: string;\r\n  projectBackgroundColor?: string;\r\n  projectBackgroundSelectedColor?: string;\r\n  milestoneBackgroundColor?: string;\r\n  milestoneBackgroundSelectedColor?: string;\r\n  arrowColor?: string;\r\n  arrowIndent?: number;\r\n  todayColor?: string;\r\n  TooltipContent?: React.FC<{\r\n    task: Task;\r\n    fontSize: string;\r\n    fontFamily: string;\r\n  }>;\r\n  TaskListHeader?: React.FC<{\r\n    headerHeight: number;\r\n    rowWidth: string;\r\n    fontFamily: string;\r\n    fontSize: string;\r\n  }>;\r\n  TaskListTable?: React.FC<{\r\n    rowHeight: number;\r\n    rowWidth: string;\r\n    fontFamily: string;\r\n    fontSize: string;\r\n    locale: string;\r\n    tasks: Task[];\r\n    selectedTaskId: string;\r\n    /**\r\n     * Sets selected task by id\r\n     */\r\n    setSelectedTask: (taskId: string) => void;\r\n  }>;\r\n}\r\n\r\nexport interface ConnectionProps {\r\n  delConnection?: (value: string) => void;\r\n  addConnection?: (params: {\r\n    source: string;\r\n    destination: string;\r\n    linkType: string;\r\n  }) => void;\r\n  itemLinks?: ItemLink[];\r\n  setCurrentConnection?: (connection: any) => void;\r\n  currentConnection?: any;\r\n}\r\nexport interface TimeItemProps {\r\n  itemType?: string;\r\n  startDate?: string;\r\n  endDate?: string;\r\n  baseLineStartDate?: string;\r\n  baseLineEndDate?: string;\r\n  percentage?: string;\r\n  isDefault?: boolean;\r\n}\r\nexport interface FieldsTypeProps extends OptionsProp {\r\n  [propName: string]: any;\r\n}\r\nexport interface FieldAndItemProps extends OptionsProp {\r\n  fieldType?: FieldsTypeProps;\r\n  icon?: string;\r\n}\r\n\r\nexport interface MilestoneProps {\r\n  itemType: string;\r\n  startDate: string;\r\n}\r\nexport interface OtherConfigProps {\r\n  overdue?: boolean;\r\n  autoPatch?: boolean;\r\n  pivotalPath?: boolean;\r\n  [propName: string]: any;\r\n}\r\nexport interface GanttConfigProps {\r\n  time?: TimeItemProps[];\r\n  milestone?: MilestoneProps;\r\n  currentPanel?: string;\r\n  otherConfig?: OtherConfigProps;\r\n  [propName: string]: any;\r\n}\r\nexport interface BaselineProps {\r\n  name?: string;\r\n  description?: string;\r\n  [propName: string]: any;\r\n}\r\nexport interface GanttProps\r\n  extends EventOption,\r\n    DisplayOption,\r\n    StylingOption,\r\n    ConfigOption,\r\n    ConnectionProps {\r\n  tasks: Task[];\r\n  baseLineLog?: Task[];\r\n  itemTypeData?: OptionsProp[];\r\n  customeFieldData?: OptionsProp[];\r\n  ganttConfig?: GanttConfigProps;\r\n  baselineList?: BaselineProps[];\r\n  configHandle?: (value: GanttConfigProps) => void;\r\n  baseLineHandle?: (\r\n    value?: BaselineProps,\r\n    type?: \"add\" | \"edit\" | \"delete\"\r\n  ) => void;\r\n  setItemTypeValue?: (value: string) => void;\r\n  setCurrentLog?: (value: BaselineProps) => void;\r\n  renderTaskListComponent?: () => JSX.Element;\r\n  renderUserAvatar?: (assignee: Assignee[]) => JSX.Element;\r\n  renderOverflowTooltip?: (value: string) => JSX.Element;\r\n  isUpdate?: boolean;\r\n  currentLog?: BaselineProps;\r\n  actionRef?: React.MutableRefObject<any>;\r\n  workspaceId?: string;\r\n  getCustomFields?: (val: TimeItemProps) => Promise<any>;\r\n  isConnect?: boolean; // 是否允许连线\r\n  onMouseEvent?: (type?: string, task?: Task) => void;\r\n  onClickEvent?: (type?: string, task?: Task) => void;\r\n  configVisibleChange?: (val: boolean) => void;\r\n  tableQuerySelector?: string;\r\n}\r\n\r\nexport interface TabConfigProps {\r\n  currentTab: string;\r\n}\r\n// 特殊时间精度\r\nexport const DateDeltaInit = {\r\n  [ViewMode.Month]: {\r\n    1: 31 * 24 * 3600 * 1000,\r\n    2: 28 * 24 * 3600 * 1000,\r\n    3: 31 * 24 * 3600 * 1000,\r\n    4: 30 * 24 * 3600 * 1000,\r\n    5: 31 * 24 * 3600 * 1000,\r\n    6: 30 * 24 * 3600 * 1000,\r\n    7: 31 * 24 * 3600 * 1000,\r\n    8: 31 * 24 * 3600 * 1000,\r\n    9: 30 * 24 * 3600 * 1000,\r\n    10: 31 * 24 * 3600 * 1000,\r\n    11: 30 * 24 * 3600 * 1000,\r\n    12: 31 * 24 * 3600 * 1000,\r\n  },\r\n  [ViewMode.Year]: {\r\n    common: 365 * 24 * 3600 * 1000,\r\n    leap: 366 * 24 * 3600 * 1000,\r\n  },\r\n  [ViewMode.Quarter]: {\r\n    1: (31 + 28 + 31) * 24 * 3600 * 1000,\r\n    2: (30 + 31 + 30) * 24 * 3600 * 1000,\r\n    3: (31 + 31 + 30) * 24 * 3600 * 1000,\r\n    4: (30 + 30 + 31) * 24 * 3600 * 1000,\r\n  },\r\n  LeapMounth: 29 * 24 * 3600 * 1000,\r\n  LeapQuarter: (31 + 29 + 31) * 24 * 3600 * 1000,\r\n};\r\nexport interface Assignee {\r\n  enabled?: boolean;\r\n  label: string;\r\n  nickname: string;\r\n  username: string;\r\n  value: string;\r\n}\r\n","import { ViewMode } from \"../types/public-types\";\r\nimport DateTimeFormatOptions = Intl.DateTimeFormatOptions;\r\nimport DateTimeFormat = Intl.DateTimeFormat;\r\n\r\ntype DateHelperScales =\r\n  | \"year\"\r\n  | \"month\"\r\n  | \"day\"\r\n  | \"hour\"\r\n  | \"minute\"\r\n  | \"second\"\r\n  | \"millisecond\";\r\n\r\nconst intlDTCache = {};\r\nconst getCachedDateTimeFormat = (locString: string | string[], opts: DateTimeFormatOptions = {}): DateTimeFormat => {\r\n  const key = JSON.stringify([locString, opts]);\r\n  let dtf = intlDTCache[key];\r\n  if (!dtf) {\r\n    dtf = new Intl.DateTimeFormat(locString, opts);\r\n    intlDTCache[key] = dtf;\r\n  }\r\n  return dtf;\r\n};\r\n\r\nexport const addToDate = (\r\n  date: Date,\r\n  quantity: number,\r\n  scale: DateHelperScales\r\n) => {\r\n  const newDate = new Date(\r\n    date.getFullYear() + (scale === \"year\" ? quantity : 0),\r\n    date.getMonth() + (scale === \"month\" ? quantity : 0),\r\n    date.getDate() + (scale === \"day\" ? quantity : 0),\r\n    date.getHours() + (scale === \"hour\" ? quantity : 0),\r\n    date.getMinutes() + (scale === \"minute\" ? quantity : 0),\r\n    date.getSeconds() + (scale === \"second\" ? quantity : 0),\r\n    date.getMilliseconds() + (scale === \"millisecond\" ? quantity : 0)\r\n  );\r\n  return newDate;\r\n};\r\n\r\nexport const startOfDate = (date: Date, scale: DateHelperScales) => {\r\n  const scores = [\r\n    \"millisecond\",\r\n    \"second\",\r\n    \"minute\",\r\n    \"hour\",\r\n    \"day\",\r\n    \"month\",\r\n    \"year\",\r\n  ];\r\n\r\n  const shouldReset = (_scale: DateHelperScales) => {\r\n    const maxScore = scores.indexOf(scale);\r\n    return scores.indexOf(_scale) <= maxScore;\r\n  };\r\n  const newDate = new Date(\r\n    date.getFullYear(),\r\n    shouldReset(\"year\") ? 0 : date.getMonth(),\r\n    shouldReset(\"month\") ? 1 : date.getDate(),\r\n    shouldReset(\"day\") ? 0 : date.getHours(),\r\n    shouldReset(\"hour\") ? 0 : date.getMinutes(),\r\n    shouldReset(\"minute\") ? 0 : date.getSeconds(),\r\n    shouldReset(\"second\") ? 0 : date.getMilliseconds()\r\n  );\r\n  return newDate;\r\n};\r\nexport const ganttDateRange = (viewMode: ViewMode) => {\r\n  let newStartDate: Date = new Date(Date.now());\r\n  let newEndDate: Date = new Date(Date.now());\r\n  const year = 10; // 10年\r\n  const oneYear = 1; // 1年\r\n  // 只有week 、 day 是一年 其他的是10年\r\n  switch (viewMode) {\r\n    case ViewMode.Month:\r\n      newStartDate = addToDate(newStartDate, -year * 12 - 1, \"month\");\r\n      newStartDate = startOfDate(newStartDate, \"month\");\r\n      newEndDate = addToDate(newEndDate, year + 1, \"year\");\r\n      newEndDate = startOfDate(newEndDate, \"year\");\r\n      break;\r\n    case ViewMode.Week: // 周要是7的倍速，否则会显示不准确\r\n      newStartDate = startOfDate(newStartDate, \"day\");\r\n      newEndDate = startOfDate(newEndDate, \"day\");\r\n      newStartDate = addToDate(\r\n        getMonday(newStartDate),\r\n        -7 * 52 * oneYear,\r\n        \"day\"\r\n      );\r\n      newEndDate = addToDate(newEndDate, oneYear + 1, \"year\");\r\n      break;\r\n    case ViewMode.Day:\r\n      newStartDate = startOfDate(newStartDate, \"day\");\r\n      newEndDate = startOfDate(newEndDate, \"day\");\r\n      newStartDate = addToDate(newStartDate, -oneYear, \"year\");\r\n      newEndDate = addToDate(newStartDate, oneYear + 1, \"year\");\r\n      break;\r\n    case ViewMode.Quarter:\r\n    case ViewMode.Year:\r\n      newStartDate = addToDate(newStartDate, -year, \"year\");\r\n      newEndDate = addToDate(newEndDate, year + 1, \"year\");\r\n      newStartDate = startOfDate(newStartDate, \"year\");\r\n      newEndDate = startOfDate(newEndDate, \"year\");\r\n      break;\r\n    default:\r\n      newStartDate = startOfDate(newStartDate, \"day\");\r\n      newEndDate = startOfDate(newEndDate, \"day\");\r\n      newStartDate = addToDate(newStartDate, -1, \"day\");\r\n      newEndDate = addToDate(newEndDate, 5, \"day\");\r\n      break;\r\n  }\r\n  return [newStartDate, newEndDate];\r\n};\r\nexport const seedDates = (\r\n  startDate: Date,\r\n  endDate: Date,\r\n  viewMode: ViewMode\r\n) => {\r\n  let currentDate: Date = new Date(startDate);\r\n  const dates: Date[] = [currentDate];\r\n  while (currentDate < endDate) {\r\n    switch (viewMode) {\r\n      case ViewMode.Year:\r\n        currentDate = addToDate(currentDate, 1, \"year\");\r\n        break;\r\n      case ViewMode.Quarter:\r\n        currentDate = addToDate(currentDate, 3, \"month\");\r\n        break;\r\n      case ViewMode.Month:\r\n        currentDate = addToDate(currentDate, 1, \"month\");\r\n        break;\r\n      case ViewMode.Week:\r\n        currentDate = addToDate(currentDate, 7, \"day\");\r\n        break;\r\n      case ViewMode.Day:\r\n        currentDate = addToDate(currentDate, 1, \"day\");\r\n        break;\r\n      case ViewMode.HalfDay:\r\n        currentDate = addToDate(currentDate, 12, \"hour\");\r\n        break;\r\n      case ViewMode.QuarterDay:\r\n        currentDate = addToDate(currentDate, 6, \"hour\");\r\n        break;\r\n    }\r\n    dates.push(currentDate);\r\n  }\r\n  return dates;\r\n};\r\n\r\nexport const getLocaleMonth = (date: Date, locale: string) => {\r\n  let bottomValue = getCachedDateTimeFormat(locale, {\r\n    month: \"long\",\r\n  }).format(date);\r\n  bottomValue = bottomValue.replace(\r\n    bottomValue[0],\r\n    bottomValue[0].toLocaleUpperCase()\r\n  );\r\n  return bottomValue;\r\n};\r\nconst getMonday = (date: Date) => {\r\n  const day = date.getDay();\r\n  const diff = date.getDate() - day + (day === 0 ? -6 : 1); // adjust when day is sunday\r\n  return new Date(date.setDate(diff));\r\n};\r\nexport const getWeekNumberISO8601 = (date: Date) => {\r\n  const tmpDate = new Date(date.valueOf());\r\n  const dayNumber = (tmpDate.getDay() + 6) % 7;\r\n  tmpDate.setDate(tmpDate.getDate() - dayNumber + 3);\r\n  const firstThursday = tmpDate.valueOf();\r\n  tmpDate.setMonth(0, 1);\r\n  if (tmpDate.getDay() !== 4) {\r\n    tmpDate.setMonth(0, 1 + ((4 - tmpDate.getDay() + 7) % 7));\r\n  }\r\n  const weekNumber = (\r\n    1 + Math.ceil((firstThursday - tmpDate.valueOf()) / 604800000)\r\n  ).toString();\r\n\r\n  if (weekNumber.length === 1) {\r\n    return `0${weekNumber}`;\r\n  } else {\r\n    return weekNumber;\r\n  }\r\n};\r\n","export const barBackgroundColorPivotalPath = \"#8777D9\";\r\n\r\nexport const barBackgroundColorTimeError = \"#FF8F73\";\r\n\r\nexport const errorLinkBorderColor = \"#FF8F73\";\r\n\r\nexport const pivotalPathLinkBorderColor = \"#6554C0\";\r\n\r\n// 滚动条的高度\r\nexport const scrollBarHeight = 4;\r\n\r\nexport const dayFormat = \"YYYY-MM-DD\";\r\nexport const dayTimeFormat = \" YYYY-MM-DD HH:mm:ss\";\r\n\r\nexport const drawerWidth = 600;\r\n\r\n// 一天秒数\r\nexport const daySeconds = 24 * 60 * 60 * 1000;\r\n","import React, { useRef, useEffect, useState, memo, useMemo } from \"react\";\r\nimport { Task, Assignee } from \"../../types/public-types\";\r\nimport { dayFormat } from \"../../helpers/dicts\";\r\nimport dayjs from \"dayjs\";\r\nimport { BarTask } from \"../../types/bar-task\";\r\n\r\nimport styles from \"./tooltip.module.css\";\r\n\r\nexport type TooltipProps = {\r\n  task: BarTask;\r\n  arrowIndent: number;\r\n  svgContainerHeight: number;\r\n  svgContainerWidth: number;\r\n  headerHeight: number;\r\n  taskListWidth: number;\r\n  scrollX: number;\r\n  scrollY: number;\r\n  rowHeight: number;\r\n  fontSize: string;\r\n  fontFamily: string;\r\n  TooltipContent: React.FC<{\r\n    task: Task;\r\n    fontSize: string;\r\n    fontFamily: string;\r\n    userAvatar?: JSX.Element;\r\n  }>;\r\n  renderUserAvatar?: (assignee: Assignee[]) => JSX.Element;\r\n};\r\nexport const Tooltip: React.FC<TooltipProps> = memo(\r\n  ({\r\n    task,\r\n    rowHeight,\r\n    svgContainerHeight,\r\n    svgContainerWidth,\r\n    scrollX,\r\n    scrollY,\r\n    arrowIndent,\r\n    fontSize,\r\n    fontFamily,\r\n    headerHeight,\r\n    taskListWidth,\r\n    TooltipContent,\r\n    renderUserAvatar,\r\n  }) => {\r\n    const tooltipRef = useRef<HTMLDivElement | null>(null);\r\n    const [relatedY, setRelatedY] = useState(0);\r\n    const [relatedX, setRelatedX] = useState(0);\r\n    const UserAvatar = useMemo(() => {\r\n      if (typeof renderUserAvatar === \"function\") {\r\n        return renderUserAvatar(task?.item?.assignee);\r\n      }\r\n      return <React.Fragment />;\r\n    }, [renderUserAvatar, task?.item?.assignee]);\r\n    useEffect(() => {\r\n      if (tooltipRef.current) {\r\n        let newRelatedX =\r\n          task.x2 + arrowIndent + arrowIndent * 0.5 + taskListWidth - scrollX;\r\n        let newRelatedY = task.index * rowHeight - scrollY + headerHeight;\r\n\r\n        const tooltipHeight = tooltipRef.current.offsetHeight * 1.1;\r\n        const tooltipWidth = tooltipRef.current.offsetWidth * 1.1;\r\n\r\n        const tooltipLowerPoint = tooltipHeight + newRelatedY - scrollY;\r\n        const tooltipLeftmostPoint = tooltipWidth + newRelatedX;\r\n        const fullChartWidth = taskListWidth + svgContainerWidth;\r\n\r\n        if (tooltipLeftmostPoint > fullChartWidth) {\r\n          newRelatedX =\r\n            task.x1 +\r\n            taskListWidth -\r\n            arrowIndent -\r\n            arrowIndent * 0.5 -\r\n            scrollX -\r\n            tooltipWidth;\r\n        }\r\n        if (newRelatedX < taskListWidth) {\r\n          newRelatedX = svgContainerWidth + taskListWidth - tooltipWidth;\r\n          newRelatedY += rowHeight;\r\n        } else if (tooltipLowerPoint > svgContainerHeight - scrollY) {\r\n          newRelatedX = newRelatedX + 50;\r\n          newRelatedY = svgContainerHeight - tooltipHeight;\r\n        }\r\n        setRelatedY(newRelatedY);\r\n        setRelatedX(newRelatedX);\r\n      }\r\n    }, [\r\n      task,\r\n      arrowIndent,\r\n      scrollX,\r\n      scrollY,\r\n      headerHeight,\r\n      taskListWidth,\r\n      rowHeight,\r\n      svgContainerHeight,\r\n      svgContainerWidth,\r\n    ]);\r\n    return (\r\n      <div\r\n        ref={tooltipRef}\r\n        className={\r\n          relatedX\r\n            ? styles.tooltipDetailsContainer\r\n            : styles.tooltipDetailsContainerHidden\r\n        }\r\n        style={{\r\n          left: task?.type === \"milestone\" ? relatedX + 10 : relatedX + 30,\r\n          top: relatedY < -40 ? -40 : relatedY,\r\n        }}\r\n      >\r\n        <TooltipContent\r\n          task={task}\r\n          fontSize={fontSize}\r\n          fontFamily={fontFamily}\r\n          userAvatar={UserAvatar}\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n);\r\n\r\nexport const StandardTooltipContent: React.FC<{\r\n  task: Task;\r\n  fontSize: string;\r\n  fontFamily: string;\r\n  userAvatar?: JSX.Element;\r\n}> = ({ task, fontSize, fontFamily, userAvatar }) => {\r\n  const style = {\r\n    fontSize,\r\n    fontFamily,\r\n  };\r\n  return (\r\n    <div className={styles.tooltipDefaultContainer} style={style}>\r\n      {task.type !== \"milestone\" ? (\r\n        <div className={styles.tooltipId}>{task?.item?.key}</div>\r\n      ) : null}\r\n      <div className={styles.tooltipName}>{task.name}</div>\r\n      {task.type === \"milestone\" ? (\r\n        <div className={styles.item}>\r\n          <div>\r\n            <span className={styles.lightColor}>状态：</span>\r\n            <span className={styles.status}>{task?.item?.status?.name}</span>\r\n          </div>\r\n          <div>\r\n            <span className={styles.lightColor}>负责人：</span>\r\n            {userAvatar}\r\n          </div>\r\n          <div className={styles.lightColor}>\r\n            <span>计划完成时间：</span>\r\n            <span>{dayjs(task.end).format(dayFormat)}</span>\r\n          </div>\r\n        </div>\r\n      ) : (\r\n        <div className={`${styles.lightColor} ${styles.item}`}>\r\n          <div>\r\n            <span>开始日期：</span>\r\n            <span>{dayjs(task.start).format(dayFormat)}</span>\r\n          </div>\r\n          <div>\r\n            <span>结束日期：</span>\r\n            <span>{dayjs(task.end).format(dayFormat)}</span>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport Icon from \"@ant-design/icons\";\r\n\r\nconst Svg = () => (\r\n  <svg width=\"24px\" height=\"24px\" viewBox=\"0 0 24 24\" version=\"1.1\">\r\n    <path\r\n      d=\"M13.721 14.43a.972.972 0 00-1.37-.004l-2.088 2.059a1.928 1.928 0 01-1.37.568c-.588 0-1.135-.26-1.525-.738-.634-.777-.505-1.933.203-2.643l1.321-1.322.002.001.688-.686a.974.974 0 000-1.377l-.002-.003a.972.972 0 00-1.375 0l-2.068 2.07a3.892 3.892 0 000 5.497l.009.01A3.87 3.87 0 008.892 19a3.87 3.87 0 002.746-1.139l2.083-2.085a.951.951 0 000-1.345zm-3.442-4.86a.972.972 0 001.37.004l2.088-2.058c.366-.367.853-.57 1.37-.57.588 0 1.135.26 1.525.739.634.777.505 1.933-.203 2.643l-1.321 1.322-.002-.001-.688.686a.974.974 0 000 1.377l.002.003c.38.38.995.38 1.375 0l2.068-2.07a3.892 3.892 0 000-5.497l-.009-.01A3.87 3.87 0 0015.108 5a3.87 3.87 0 00-2.746 1.139l-2.083 2.085a.951.951 0 000 1.345zM8.924 4.618l.401.968a1 1 0 11-1.848.765l-.4-.968a1 1 0 111.848-.765M5.383 7.076l.968.401a1.001 1.001 0 01-.766 1.848l-.968-.4a1.001 1.001 0 01.766-1.848m9.932 10.413a1.003 1.003 0 00-.542 1.307l.402.968A1 1 0 1017.023 19l-.401-.967a1 1 0 00-1.307-.542zm2.176-2.174a1 1 0 00.54 1.306l.969.401a1.001 1.001 0 00.766-1.848l-.969-.4a1 1 0 00-1.306.542z\"\r\n      fill=\"currentColor\"\r\n      fill-rule=\"evenodd\"\r\n    ></path>\r\n  </svg>\r\n);\r\nconst IconComponent = props => <Icon component={Svg} {...props} />;\r\nexport default IconComponent;\r\n","import React from \"react\";\r\nimport Icon from \"@ant-design/icons\";\r\n\r\nconst Svg = () => (\r\n  <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 24 24\" version=\"1.1\">\r\n    <g fill=\"#fff\" fill-rule=\"evenodd\">\r\n      <path d=\"M12.856 5.457l-.937.92a1.002 1.002 0 000 1.437 1.047 1.047 0 001.463 0l.984-.966c.967-.95 2.542-1.135 3.602-.288a2.54 2.54 0 01.203 3.81l-2.903 2.852a2.646 2.646 0 01-3.696 0l-1.11-1.09L9 13.57l1.108 1.089c1.822 1.788 4.802 1.788 6.622 0l2.905-2.852a4.558 4.558 0 00-.357-6.82c-1.893-1.517-4.695-1.226-6.422.47\"></path>\r\n      <path d=\"M11.144 19.543l.937-.92a1.002 1.002 0 000-1.437 1.047 1.047 0 00-1.462 0l-.985.966c-.967.95-2.542 1.135-3.602.288a2.54 2.54 0 01-.203-3.81l2.903-2.852a2.646 2.646 0 013.696 0l1.11 1.09L15 11.43l-1.108-1.089c-1.822-1.788-4.802-1.788-6.622 0l-2.905 2.852a4.558 4.558 0 00.357 6.82c1.893 1.517 4.695 1.226 6.422-.47\"></path>\r\n    </g>\r\n  </svg>\r\n);\r\nconst IconComponent = props => <Icon component={Svg} {...props} />;\r\nexport default IconComponent;\r\n","import React, { useRef, useEffect, useState, memo, useMemo } from \"react\";\r\nimport { Task, ConnectionProps } from \"../../types/public-types\";\r\nimport UnconnectionIcon from \"../icons/unconnection\";\r\nimport ConnectionIcon from \"../icons/connection\";\r\nimport { Tooltip } from \"antd\";\r\nimport { dayFormat } from \"../../helpers/dicts\";\r\nimport dayjs from \"dayjs\";\r\n\r\nimport styles from \"./deleteTooltip.module.css\";\r\n\r\nexport type TooltipProps = ConnectionProps & {\r\n  tasks: Task[];\r\n  taskListWidth: number;\r\n  currentConnection?: any;\r\n  boundTop: number;\r\n  svgContainerHeight: number;\r\n};\r\nexport const DeleteTooltip: React.FC<TooltipProps> = memo(\r\n  ({\r\n    tasks,\r\n    delConnection,\r\n    taskListWidth,\r\n    itemLinks,\r\n    currentConnection,\r\n    boundTop,\r\n    setCurrentConnection,\r\n    svgContainerHeight,\r\n  }) => {\r\n    const path = window.location.origin;\r\n    const tooltipRef = useRef<HTMLDivElement | null>(null);\r\n    const [relatedY, setRelatedY] = useState(0);\r\n    const [relatedX, setRelatedX] = useState(0);\r\n    const sourceTask = useMemo(() => {\r\n      return tasks.filter(ele => {\r\n        return ele.id === currentConnection.connection.sourceId;\r\n      });\r\n    }, [currentConnection.connection.sourceId, tasks]);\r\n    const targetTask = useMemo(() => {\r\n      return tasks.filter(\r\n        ele => ele.id === currentConnection.connection.targetId\r\n      );\r\n    }, [currentConnection.connection.targetId, tasks]);\r\n    useEffect(() => {\r\n      if (tooltipRef.current) {\r\n        const tooltipHeight = tooltipRef.current.offsetHeight;\r\n        const newRelatedY =\r\n          currentConnection?.originalEvent?.clientY - boundTop + tooltipHeight >\r\n          svgContainerHeight\r\n            ? currentConnection?.originalEvent?.clientY -\r\n              boundTop -\r\n              tooltipHeight\r\n            : currentConnection?.originalEvent?.clientY - boundTop;\r\n        const newRelatedX =\r\n          currentConnection?.originalEvent?.clientX - taskListWidth;\r\n        setRelatedY(newRelatedY);\r\n        setRelatedX(newRelatedX);\r\n      }\r\n    }, [\r\n      tasks,\r\n      taskListWidth,\r\n      boundTop,\r\n      currentConnection?.originalEvent?.clientX,\r\n      currentConnection?.originalEvent?.clientY,\r\n      svgContainerHeight,\r\n    ]);\r\n    const removeConnection = async () => {\r\n      const currentLink = itemLinks?.filter((ele: any) => {\r\n        return (\r\n          ele.source?.objectId === currentConnection.connection?.sourceId &&\r\n          ele.destination?.objectId ===\r\n            currentConnection.connection?.targetId &&\r\n          ele.linkType?.objectId === currentConnection.connection.getData()\r\n        );\r\n      });\r\n      if (currentLink?.length) {\r\n        await delConnection?.(currentLink?.[0]?.objectId);\r\n        setCurrentConnection?.(null);\r\n      }\r\n    };\r\n    return (\r\n      <div\r\n        ref={tooltipRef}\r\n        className={styles.tooltipDeleteContainer}\r\n        style={{ left: relatedX + 30, top: relatedY < -40 ? -40 : relatedY }}\r\n      >\r\n        {currentConnection && (\r\n          <div className={styles.tooltipDeleteDefaultContainer}>\r\n            <div className={styles.taskInfo}>\r\n              <div className={styles.title}>\r\n                {sourceTask[0]?.item?.itemType?.icon && (\r\n                  <img src={`${path}${sourceTask[0].item.itemType.icon}`} />\r\n                )}\r\n\r\n                <span> {sourceTask[0]?.name}</span>\r\n              </div>\r\n              <div className={styles.date}>\r\n                {currentConnection.connection?.endpoints?.[0].anchor\r\n                  ?.cssClass === \"Right\"\r\n                  ? `结束日期：${dayjs(sourceTask[0]?.end).format(dayFormat)}`\r\n                  : `开始日期：${dayjs(sourceTask[0]?.start).format(\r\n                      dayFormat\r\n                    )}`}\r\n              </div>\r\n            </div>\r\n            <div className={styles.connect}>\r\n              <div className={styles.connection}>\r\n                <div className={styles.connectionLine} />\r\n                <span className={styles.connectionIcon}>\r\n                  <ConnectionIcon style={{ fontSize: \"18px\" }} />\r\n                </span>\r\n                <div className={styles.connectionLine} />\r\n              </div>\r\n              <Tooltip title=\"解除事项链接\" className={styles.unconnectionIcon}>\r\n                <span onClick={removeConnection}>\r\n                  <UnconnectionIcon />\r\n                </span>\r\n              </Tooltip>\r\n            </div>\r\n            <div className={styles.taskInfo}>\r\n              <div className={styles.title}>\r\n                {targetTask[0]?.item?.itemType?.icon && (\r\n                  <img src={`${path}${targetTask[0].item.itemType.icon}`} />\r\n                )}\r\n\r\n                <span>{targetTask[0]?.name}</span>\r\n              </div>\r\n              <div className={styles.date}>\r\n                {currentConnection.connection?.endpoints[1]?.anchor\r\n                  ?.cssClass === \"Right\"\r\n                  ? `结束日期：${dayjs(targetTask[0]?.end).format(dayFormat)}`\r\n                  : `开始日期：${dayjs(targetTask[0]?.start).format(\r\n                      dayFormat\r\n                    )}`}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n);\r\n","import React, { SyntheticEvent, forwardRef, memo } from \"react\";\r\nimport styles from \"./vertical-scroll.module.css\";\r\n\r\nconst VerticalScrollComponent: React.ForwardRefRenderFunction<\r\n  any,\r\n  {\r\n    ganttHeight: number;\r\n    ganttFullHeight: number;\r\n    headerHeight: number;\r\n    listBottomHeight: number;\r\n    onScroll: (event: SyntheticEvent<HTMLDivElement>) => void;\r\n  }\r\n> = (\r\n  { ganttHeight, ganttFullHeight, headerHeight, onScroll, listBottomHeight },\r\n  ref\r\n) => {\r\n  const scrollHeight = 16;\r\n  return (\r\n    <div\r\n      style={{\r\n        height: ganttHeight || \"auto\",\r\n        marginTop: headerHeight,\r\n        marginBottom: `${listBottomHeight + scrollHeight}px`,\r\n      }}\r\n      className={styles.scroll}\r\n      onScroll={onScroll}\r\n      ref={ref}\r\n    >\r\n      <div style={{ height: ganttFullHeight, width: 1 }} />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport const VerticalScroll = memo(forwardRef(VerticalScrollComponent));\r\n","import { createContext } from \"react\";\r\nexport const GanttConfigContext = createContext<any>(null);\r\nexport const ConfigHandleContext = createContext<any>(null);\r\nexport const BaseLineContext = createContext<any>(null);\r\n","import React, {\r\n  ReactChild,\r\n  useState,\r\n  useEffect,\r\n  useContext,\r\n  memo,\r\n  useCallback,\r\n} from \"react\";\r\nimport { Task, ViewMode, EventOption } from \"../../types/public-types\";\r\nimport { addToDate } from \"../../helpers/date-helper\";\r\nimport { GanttConfigContext } from \"../../contsxt\";\r\n\r\nimport styles from \"./grid.module.css\";\r\nimport dayjs from \"dayjs\";\r\nimport weekday from \"dayjs/plugin/weekday\";\r\ndayjs.extend(weekday);\r\nexport type GridBodyProps = {\r\n  tasks: Task[];\r\n  dates: Date[];\r\n  svgWidth: number;\r\n  rowHeight: number;\r\n  columnWidth: number;\r\n  todayColor: string;\r\n  viewMode?: string;\r\n  scrollX: number;\r\n  offsetLeft: number;\r\n  taskListHeight?: number;\r\n} & EventOption;\r\n// 判断是否为周末\r\n// 之前用是dayjs的weekday()方法获取周几，本地运行可以，但是线上包计算有无，具体原因不确定，所以采用getDay方法\r\nconst isRestDay = (date: Date) => {\r\n  const dt = new Date(date);\r\n  return [0, 6].includes(dt.getDay());\r\n};\r\nexport const GridBody: React.FC<GridBodyProps> = memo(\r\n  ({\r\n    tasks,\r\n    dates,\r\n    rowHeight,\r\n    svgWidth,\r\n    columnWidth,\r\n    todayColor,\r\n    viewMode,\r\n    scrollX,\r\n    offsetLeft,\r\n    taskListHeight,\r\n    onDateChange,\r\n  }) => {\r\n    const { ganttConfig } = useContext(GanttConfigContext);\r\n    const [translateX, setTranslateX] = useState(0);\r\n    const [translateY, setTranslateY] = useState(0);\r\n    const [isShow, setIsShow] = useState(false);\r\n    const [parts, setParts] = useState(1);\r\n    // 余的天数\r\n    const [remainderDays, setRemainderDays] = useState(0);\r\n    //\r\n    const [currentIndex, setCurrentDataIndex] = useState(0);\r\n    useEffect(() => {\r\n      setParts(1);\r\n      setRemainderDays(0);\r\n      setCurrentDataIndex(0);\r\n      // 一个时间刻度分成多少小份： 一月分为28、29、30、31份\r\n    }, [viewMode]);\r\n    let y = 0;\r\n    const invalidColumn: ReactChild[] = [];\r\n    const gridRows: ReactChild[] = [];\r\n    const rowLines: ReactChild[] = [\r\n      <line\r\n        key=\"RowLineFirst\"\r\n        x=\"0\"\r\n        y1={0}\r\n        x2={svgWidth}\r\n        y2={0}\r\n        className={styles.gridRowLine}\r\n      />,\r\n    ];\r\n    const handleMouseMove = useCallback(\r\n      (event: any, index: number) => {\r\n        const pointerX = event.clientX - offsetLeft - 24;\r\n        // 整数\r\n        const currentDataIndex = Math.floor((pointerX + scrollX) / columnWidth);\r\n        setCurrentDataIndex(currentDataIndex);\r\n        let translateX = 0;\r\n        // 天或周\r\n        if (viewMode === ViewMode.Day || viewMode === ViewMode.Week) {\r\n          setParts(1);\r\n          setRemainderDays(0);\r\n          translateX = currentDataIndex * columnWidth;\r\n        }\r\n        // 月\r\n        if (viewMode === ViewMode.Month) {\r\n          // 余数\r\n          const dateRemainder =\r\n            pointerX + scrollX - currentDataIndex * columnWidth;\r\n          // 获取当前月下的天数\r\n          const parts = new Date(\r\n            dates[currentDataIndex]?.getFullYear(),\r\n            dates[currentDataIndex]?.getMonth() + 1,\r\n            0\r\n          ).getDate();\r\n          setParts(parts);\r\n          // 一天对应的宽度\r\n          const dayWidth = columnWidth / parts;\r\n          const remainder = Math.floor(dateRemainder / dayWidth);\r\n          setRemainderDays(remainder);\r\n          translateX =\r\n            currentDataIndex * columnWidth + (remainder / parts) * columnWidth;\r\n        }\r\n        // 季度\r\n        if (viewMode === ViewMode.Quarter) {\r\n          const dateRemainder =\r\n            pointerX + scrollX - currentDataIndex * columnWidth;\r\n          const parts = 3;\r\n          setParts(3);\r\n          // 一天对应的宽度\r\n          const dayWidth = columnWidth / parts;\r\n          const remainder = Math.floor(dateRemainder / dayWidth);\r\n          setRemainderDays(remainder);\r\n          translateX =\r\n            currentDataIndex * columnWidth + (remainder / parts) * columnWidth;\r\n        }\r\n        // 年\r\n        if (viewMode === ViewMode.Year) {\r\n          const dateRemainder =\r\n            pointerX + scrollX - currentDataIndex * columnWidth;\r\n          const parts = 12;\r\n          setParts(12);\r\n          // 一天对应的宽度\r\n          const dayWidth = columnWidth / parts;\r\n          const remainder = Math.floor(dateRemainder / dayWidth);\r\n          setRemainderDays(remainder);\r\n          translateX =\r\n            currentDataIndex * columnWidth + (remainder / parts) * columnWidth;\r\n        }\r\n        setTranslateX(translateX);\r\n        setTranslateY(index * rowHeight);\r\n      },\r\n      [columnWidth, dates, offsetLeft, rowHeight, scrollX, viewMode]\r\n    );\r\n    const handleInvalidColumnMouseMove = useCallback(\r\n      (index: number, row: any) => {\r\n        setTranslateY(index * rowHeight);\r\n        setIsShow(!row.start);\r\n      },\r\n      [rowHeight]\r\n    );\r\n    const invalidBarClick = () => {\r\n      const taskIndex = translateY / rowHeight;\r\n      let startDate, endDate;\r\n      if (viewMode === ViewMode.Day) {\r\n        startDate = dayjs(\r\n          dates[0].valueOf() + (translateX / columnWidth) * 86400000\r\n        );\r\n        endDate = dayjs(\r\n          dates[0].valueOf() + (translateX / columnWidth) * 86400000 + 86400000\r\n        );\r\n      }\r\n      if (viewMode === ViewMode.Week) {\r\n        startDate = dayjs(\r\n          dates[0].valueOf() + (translateX / columnWidth) * 86400000 * 7\r\n        );\r\n        endDate = dayjs(\r\n          dates[0].valueOf() +\r\n            (translateX / columnWidth) * 86400000 * 7 +\r\n            86400000 * 7\r\n        );\r\n      }\r\n      if (viewMode === ViewMode.Month) {\r\n        startDate = dayjs(\r\n          dates[currentIndex].valueOf() + remainderDays * 86400000\r\n        );\r\n        endDate = dayjs(\r\n          dates[currentIndex].valueOf() + remainderDays * 86400000 + 86400000\r\n        );\r\n      }\r\n      if (viewMode === ViewMode.Quarter || viewMode === ViewMode.Year) {\r\n        startDate = dayjs(\r\n          new Date(\r\n            dates[currentIndex].getFullYear(),\r\n            dates[currentIndex].getMonth() + remainderDays\r\n          )\r\n        );\r\n        endDate = dayjs(\r\n          new Date(\r\n            dates[currentIndex].getFullYear(),\r\n            dates[currentIndex].getMonth() + remainderDays + 1\r\n          )\r\n        );\r\n      }\r\n      onDateChange?.(\r\n        Object.assign(tasks[taskIndex], {\r\n          start: ganttConfig?.time?.length\r\n            ? startDate?.startOf(\"day\").toDate()\r\n            : null,\r\n          end: ganttConfig?.time?.length\r\n            ? endDate?.startOf(\"day\").toDate()\r\n            : null,\r\n        })\r\n      );\r\n    };\r\n    for (let i = 0; i < tasks.length; i++) {\r\n      gridRows.push(\r\n        <g\r\n          key={`Cell-${i}`}\r\n          onMouseEnter={(e: any) => {\r\n            const ele = e.target.parentNode.firstChild;\r\n            ele && (ele.style.fill = \"#f3f3f3\");\r\n          }}\r\n          onMouseLeave={(e: any) => {\r\n            const ele = e.target.parentNode.firstChild;\r\n            ele && (ele.style.fill = \"\");\r\n          }}\r\n          // @ts-ignore\r\n          index={i}\r\n        >\r\n          <rect\r\n            key={\"Row\" + tasks[i].id + i}\r\n            x=\"0\"\r\n            y={y}\r\n            width={svgWidth}\r\n            height={rowHeight}\r\n            className={styles.gridRow}\r\n            onMouseMove={(e: any) => {\r\n              handleMouseMove(e, i);\r\n            }}\r\n          />\r\n          <rect\r\n            key={\"Cell\" + tasks[i].id + i}\r\n            x={translateX + 0.5}\r\n            y={y}\r\n            width={columnWidth / parts}\r\n            height={rowHeight}\r\n            fill=\"transparent\"\r\n            ry={4}\r\n            rx={4}\r\n            onMouseMove={() => {\r\n              handleInvalidColumnMouseMove(i, tasks[i]);\r\n            }}\r\n          />\r\n          {/* 卡片为空时不能添加时间 */}\r\n          {tasks[i].id && (\r\n            <rect\r\n              key={\"Time\" + tasks[i].id + i}\r\n              x={translateX}\r\n              y={y + rowHeight / 2 - 30 / 2}\r\n              width={columnWidth / parts}\r\n              height={30}\r\n              fill=\"transparent\"\r\n              onClick={isShow ? invalidBarClick : () => {}}\r\n              cursor={isShow ? \"pointer\" : \"default\"}\r\n              onMouseEnter={(e: any) => {\r\n                const ele = e.target.parentNode;\r\n                const index = ele.getAttribute(\"index\");\r\n                if (isShow && i === Number(index)) {\r\n                  e.target.style.fill = \"#AFCBFF\";\r\n                }\r\n              }}\r\n              onMouseLeave={(e: any) => {\r\n                e.target.style.fill = \"transparent\";\r\n              }}\r\n            />\r\n          )}\r\n        </g>\r\n      );\r\n      invalidColumn.push(\r\n        <rect\r\n          key={\"invalidColumn\" + tasks[i].id + i}\r\n          x={translateX + 0.5}\r\n          y={y}\r\n          width={columnWidth / parts}\r\n          height={rowHeight}\r\n          fill={isShow ? \"#DAE0FF\" : \"transparent\"}\r\n          onMouseMove={() => {\r\n            handleInvalidColumnMouseMove(i, tasks[i]);\r\n          }}\r\n        />\r\n      );\r\n      rowLines.push(\r\n        <line\r\n          key={\"RowLine\" + tasks[i].id + i}\r\n          x=\"0\"\r\n          y1={y + rowHeight}\r\n          x2={svgWidth}\r\n          y2={y + rowHeight}\r\n          className={styles.gridRowLine}\r\n        />\r\n      );\r\n      y += rowHeight;\r\n    }\r\n\r\n    const now = new Date();\r\n    let tickX = 0;\r\n    const ticks: ReactChild[] = [];\r\n    let today: ReactChild = <rect />;\r\n    for (let i = 0; i < dates.length; i++) {\r\n      const date = dates[i];\r\n      ticks.push(\r\n        <g key={`${date.getTime()}-${i}-ticks`}>\r\n          <line\r\n            key={`${date.getTime()}-${i}-line`}\r\n            x1={tickX}\r\n            y1={0}\r\n            x2={tickX}\r\n            y2={y < Number(taskListHeight) ? taskListHeight : y}\r\n            className={styles.gridTick}\r\n          />\r\n          {isRestDay(date) && viewMode === ViewMode.Day && (\r\n            <rect\r\n              key={`${date.getTime()}-${date.getTime()}-${i}-restday`}\r\n              x={tickX + 1}\r\n              y=\"0\"\r\n              width={columnWidth - 1}\r\n              height={y < Number(taskListHeight) ? taskListHeight : y}\r\n              className={styles.gridTickWeekday}\r\n            />\r\n          )}\r\n        </g>\r\n      );\r\n      if (\r\n        (i + 1 !== dates.length &&\r\n          date.getTime() < now.getTime() &&\r\n          dates[i + 1].getTime() >= now.getTime()) ||\r\n        // if current date is last\r\n        (i !== 0 &&\r\n          i + 1 === dates.length &&\r\n          date.getTime() < now.getTime() &&\r\n          addToDate(\r\n            date,\r\n            date.getTime() - dates[i - 1].getTime(),\r\n            \"millisecond\"\r\n          ).getTime() >= now.getTime())\r\n      ) {\r\n        // 当天的零点的时间戳（毫秒）\r\n        const currentStamp = new Date(\r\n          new Date().toLocaleDateString()\r\n        ).getTime();\r\n        // 当天和上一个时间的差\r\n        const currentMinus =\r\n          (currentStamp + 86400000 - dates[i].getTime()) / 86400000;\r\n        // 前后时间差\r\n        const totalMinus =\r\n          (dates[i + 1].getTime() - dates[i].getTime()) / 86400000;\r\n        const newTickX =\r\n          tickX +\r\n          columnWidth * (currentMinus / totalMinus) -\r\n          columnWidth / totalMinus / 2;\r\n        today = (\r\n          <g>\r\n            {/* <rect\r\n            x={tickX}\r\n            y={0}\r\n            width={columnWidth}\r\n            height={y}\r\n            fill={todayColor}\r\n          /> */}\r\n            <circle\r\n              cx={newTickX}\r\n              cy=\"3\"\r\n              r=\"3\"\r\n              stroke=\"black\"\r\n              strokeWidth=\"0\"\r\n              fill={todayColor}\r\n            />\r\n            <line\r\n              x1={newTickX}\r\n              y1=\"0\"\r\n              x2={newTickX}\r\n              y2={y < Number(taskListHeight) ? taskListHeight : y}\r\n              style={{ stroke: todayColor, strokeWidth: \"1\" }}\r\n            />\r\n          </g>\r\n        );\r\n      }\r\n      tickX += columnWidth;\r\n    }\r\n    const invalidBar = (\r\n      <g>\r\n        <rect\r\n          x={translateX}\r\n          y={translateY + rowHeight / 2 - 30 / 2}\r\n          width={columnWidth / parts}\r\n          height={30}\r\n          rx={4}\r\n          ry={4}\r\n          fill=\"#AFCBFF\"\r\n          onClick={invalidBarClick}\r\n          cursor=\"pointer\"\r\n        />\r\n      </g>\r\n    );\r\n    return (\r\n      <g\r\n        className=\"gridBody\"\r\n        onMouseLeave={() => {\r\n          setTranslateX(-500);\r\n        }}\r\n      >\r\n        <g className=\"ticks\">{ticks}</g>\r\n\r\n        <g className=\"rowLines\">{rowLines}</g>\r\n        <g className=\"rows\">{gridRows}</g>\r\n        {false && <g className=\"invalidColumn\">{invalidColumn}</g>}\r\n        {false && <g className=\"invalidBar\">{invalidBar}</g>}\r\n        <g className=\"today\">{today}</g>\r\n      </g>\r\n    );\r\n  }\r\n);\r\nGridBody.defaultProps = {\r\n  scrollX: 0,\r\n};\r\n","import React, { memo } from \"react\";\r\nimport { GridBody, GridBodyProps } from \"./grid-body\";\r\nexport type GridProps = GridBodyProps;\r\nexport const Grid: React.FC<GridProps> = memo(props => {\r\n  return (\r\n    <g className=\"grid\">\r\n      <GridBody {...props} />\r\n    </g>\r\n  );\r\n});\r\n","import React from \"react\";\r\nimport styles from \"./calendar.module.css\";\r\n\r\ntype TopPartOfCalendarProps = {\r\n  value: string;\r\n  x1Line: number;\r\n  y1Line: number;\r\n  y2Line: number;\r\n  xText: number;\r\n  yText: number;\r\n};\r\n\r\nexport const TopPartOfCalendar: React.FC<TopPartOfCalendarProps> = ({\r\n  value,\r\n  x1Line,\r\n  y1Line,\r\n  y2Line,\r\n  xText,\r\n  yText,\r\n}) => {\r\n  return (\r\n    <g className=\"calendarTop\">\r\n      <line\r\n        x1={x1Line}\r\n        y1={y1Line}\r\n        x2={x1Line}\r\n        y2={y2Line}\r\n        className={styles.calendarTopTick}\r\n        key={value + \"line\"}\r\n      />\r\n      <text\r\n        key={value + \"text\"}\r\n        y={yText}\r\n        x={xText}\r\n        className={styles.calendarTopText}\r\n      >\r\n        {value}\r\n      </text>\r\n    </g>\r\n  );\r\n};\r\n","import React, { ReactChild, memo, useCallback, useMemo } from \"react\";\r\nimport { ViewMode } from \"../../types/public-types\";\r\nimport { TopPartOfCalendar } from \"./top-part-of-calendar\";\r\nimport {\r\n  getLocaleMonth,\r\n  getWeekNumberISO8601,\r\n} from \"../../helpers/date-helper\";\r\nimport { DateSetup } from \"../../types/date-setup\";\r\nimport styles from \"./calendar.module.css\";\r\n\r\nexport type CalendarProps = {\r\n  dateSetup: DateSetup;\r\n  locale: string;\r\n  viewMode: ViewMode;\r\n  headerHeight: number;\r\n  columnWidth: number;\r\n  fontFamily: string;\r\n  fontSize: string;\r\n};\r\nexport const Calendar: React.FC<CalendarProps> = memo(\r\n  ({\r\n    dateSetup,\r\n    locale,\r\n    viewMode,\r\n    headerHeight,\r\n    columnWidth,\r\n    fontFamily,\r\n    fontSize,\r\n  }) => {\r\n    const bottomValuesInit = useCallback(\r\n      (bottomValue, date, headerHeight, i, type) => {\r\n        return (\r\n          <text\r\n            key={\r\n              [\"Day\", \"Other\", \"Week\"].includes(type)\r\n                ? date.getTime()\r\n                : bottomValue + date.getFullYear()\r\n            }\r\n            y={\r\n              [\"Day\", \"Week\"].includes(type)\r\n                ? headerHeight * 0.6 + 6\r\n                : headerHeight * 0.6\r\n            }\r\n            x={columnWidth * i + columnWidth * 0.5}\r\n            className={styles.calendarBottomText}\r\n          >\r\n            {bottomValue}\r\n          </text>\r\n        );\r\n      },\r\n      [columnWidth]\r\n    );\r\n    const getCalendarValuesForYear = useCallback(() => {\r\n      const topValues: ReactChild[] = [];\r\n      const bottomValues: ReactChild[] = [];\r\n      for (let i = 0; i < dateSetup.dates.length; i++) {\r\n        const date = dateSetup.dates[i];\r\n        const bottomValue = date.getFullYear().toString();\r\n        bottomValues.push(\r\n          bottomValuesInit(bottomValue, date, headerHeight, i, \"year\")\r\n        );\r\n      }\r\n      return [topValues, bottomValues];\r\n    }, [dateSetup.dates, headerHeight, bottomValuesInit]);\r\n    const getCalendarValuesForQuarter = useCallback(() => {\r\n      const topValues: ReactChild[] = [];\r\n      const bottomValues: ReactChild[] = [];\r\n      const topDefaultWidth = columnWidth * 3;\r\n      const topDefaultHeight = headerHeight * 0.5;\r\n      for (let i = 0; i < dateSetup.dates.length; i++) {\r\n        const date = dateSetup.dates[i];\r\n        const currentQuarter = Math.floor(\r\n          date.getMonth() % 3 === 0\r\n            ? date.getMonth() / 3 + 1\r\n            : date.getMonth() / 3 + 1\r\n        );\r\n        const bottomValue = `第${currentQuarter}季`;\r\n        bottomValues.push(\r\n          bottomValuesInit(bottomValue, date, headerHeight, i, \"Quarter\")\r\n        );\r\n        if (\r\n          i === 0 ||\r\n          date.getFullYear() !== dateSetup.dates[i - 1].getFullYear()\r\n        ) {\r\n          const topValue = date.getFullYear().toString();\r\n          topValues.push(\r\n            <TopPartOfCalendar\r\n              key={topValue}\r\n              value={topValue}\r\n              x1Line={columnWidth * i}\r\n              y1Line={0}\r\n              y2Line={topDefaultHeight}\r\n              xText={\r\n                topDefaultWidth + columnWidth * i - currentQuarter * columnWidth\r\n              }\r\n              yText={topDefaultHeight * 0.9}\r\n            />\r\n          );\r\n        }\r\n      }\r\n      return [topValues, bottomValues];\r\n    }, [columnWidth, dateSetup.dates, headerHeight, bottomValuesInit]);\r\n    const getCalendarValuesForMonth = useCallback(() => {\r\n      const topValues: ReactChild[] = [];\r\n      const bottomValues: ReactChild[] = [];\r\n      const topDefaultWidth = columnWidth * 6;\r\n      const topDefaultHeight = headerHeight * 0.5;\r\n      for (let i = 0; i < dateSetup.dates.length; i++) {\r\n        const date = dateSetup.dates[i];\r\n        const bottomValue = getLocaleMonth(date, locale);\r\n        bottomValues.push(\r\n          bottomValuesInit(bottomValue, date, headerHeight, i, \"Month\")\r\n        );\r\n        if (\r\n          i === 0 ||\r\n          date.getFullYear() !== dateSetup.dates[i - 1].getFullYear()\r\n        ) {\r\n          const topValue = date.getFullYear().toString();\r\n          topValues.push(\r\n            <TopPartOfCalendar\r\n              key={topValue}\r\n              value={topValue}\r\n              x1Line={columnWidth * i}\r\n              y1Line={0}\r\n              y2Line={topDefaultHeight}\r\n              xText={\r\n                topDefaultWidth +\r\n                columnWidth * i -\r\n                date.getMonth() * columnWidth\r\n              }\r\n              yText={topDefaultHeight * 0.9}\r\n            />\r\n          );\r\n        }\r\n      }\r\n      return [topValues, bottomValues];\r\n    }, [columnWidth, dateSetup.dates, headerHeight, locale, bottomValuesInit]);\r\n\r\n    const getCalendarValuesForWeek = useCallback(() => {\r\n      const topValues: ReactChild[] = [];\r\n      const bottomValues: ReactChild[] = [];\r\n      let weeksCount: number = 1;\r\n      const topDefaultHeight = headerHeight * 0.5;\r\n      const dates = dateSetup.dates;\r\n      for (let i = dates.length - 1; i >= 0; i--) {\r\n        const date = dates[i];\r\n        let topValue = \"\";\r\n        if (i === 0 || date.getMonth() !== dates[i - 1].getMonth()) {\r\n          // top\r\n          topValue = `${date.getFullYear()}年${date.getMonth() + 1}月`;\r\n        }\r\n        // bottom\r\n        const bottomValue = `第${getWeekNumberISO8601(date)}周`;\r\n\r\n        bottomValues.push(\r\n          bottomValuesInit(bottomValue, date, headerHeight, i, \"Week\")\r\n        );\r\n\r\n        if (topValue) {\r\n          // if last day is new month\r\n          if (i !== dates.length - 1) {\r\n            topValues.push(\r\n              <TopPartOfCalendar\r\n                key={topValue}\r\n                value={topValue}\r\n                x1Line={columnWidth * i + weeksCount * columnWidth}\r\n                y1Line={0}\r\n                y2Line={topDefaultHeight}\r\n                xText={columnWidth * i + columnWidth * weeksCount * 0.5}\r\n                yText={topDefaultHeight * 0.9 - 4}\r\n              />\r\n            );\r\n          }\r\n          weeksCount = 0;\r\n        }\r\n        weeksCount++;\r\n      }\r\n      return [topValues, bottomValues];\r\n    }, [columnWidth, dateSetup.dates, headerHeight, bottomValuesInit]);\r\n\r\n    const getCalendarValuesForDay = useCallback(() => {\r\n      const topValues: ReactChild[] = [];\r\n      const bottomValues: ReactChild[] = [];\r\n      const topDefaultHeight = headerHeight * 0.5;\r\n      const dates = dateSetup.dates;\r\n      for (let i = 0; i < dates.length; i++) {\r\n        const date = dates[i];\r\n        const bottomValue = date.getDate().toString();\r\n\r\n        bottomValues.push(\r\n          bottomValuesInit(bottomValue, date, headerHeight, i, \"Day\")\r\n        );\r\n        if (\r\n          i + 1 !== dates.length &&\r\n          date.getMonth() !== dates[i + 1].getMonth()\r\n        ) {\r\n          const topValue = `${date.getFullYear()}年${date.getMonth() + 1}月`;\r\n\r\n          topValues.push(\r\n            <TopPartOfCalendar\r\n              key={topValue + date.getFullYear()}\r\n              value={topValue}\r\n              x1Line={columnWidth * (i + 1)}\r\n              y1Line={0}\r\n              y2Line={topDefaultHeight}\r\n              xText={columnWidth * (i + 1) - date.getDate() * columnWidth * 0.5}\r\n              yText={topDefaultHeight * 0.9 - 4}\r\n            />\r\n          );\r\n        }\r\n      }\r\n      return [topValues, bottomValues];\r\n    }, [columnWidth, dateSetup.dates, headerHeight, bottomValuesInit]);\r\n\r\n    const getCalendarValuesForOther = useCallback(() => {\r\n      const topValues: ReactChild[] = [];\r\n      const bottomValues: ReactChild[] = [];\r\n      const ticks = viewMode === ViewMode.HalfDay ? 2 : 4;\r\n      const topDefaultHeight = headerHeight * 0.5;\r\n      const dates = dateSetup.dates;\r\n      for (let i = 0; i < dates.length; i++) {\r\n        const date = dates[i];\r\n        const bottomValue = Intl.DateTimeFormat(locale, {\r\n          hour: \"numeric\",\r\n        }).format(date);\r\n\r\n        bottomValues.push(\r\n          bottomValuesInit(bottomValue, date, headerHeight, i, \"Other\")\r\n        );\r\n        if (i === 0 || date.getDate() !== dates[i - 1].getDate()) {\r\n          const topValue = `${date.getDate()} ${getLocaleMonth(date, locale)}`;\r\n          topValues.push(\r\n            <TopPartOfCalendar\r\n              key={topValue + date.getFullYear()}\r\n              value={topValue}\r\n              x1Line={columnWidth * i + ticks * columnWidth}\r\n              y1Line={0}\r\n              y2Line={topDefaultHeight}\r\n              xText={columnWidth * i + ticks * columnWidth * 0.5}\r\n              yText={topDefaultHeight * 0.9}\r\n            />\r\n          );\r\n        }\r\n      }\r\n      return [topValues, bottomValues];\r\n    }, [\r\n      columnWidth,\r\n      dateSetup.dates,\r\n      headerHeight,\r\n      locale,\r\n      viewMode,\r\n      bottomValuesInit,\r\n    ]);\r\n    const [topValues, bottomValues] = useMemo(() => {\r\n      let topValues: ReactChild[] = [];\r\n      let bottomValues: ReactChild[] = [];\r\n      switch (dateSetup.viewMode) {\r\n        case ViewMode.Month:\r\n          [topValues, bottomValues] = getCalendarValuesForMonth();\r\n          break;\r\n        case ViewMode.Week:\r\n          [topValues, bottomValues] = getCalendarValuesForWeek();\r\n          break;\r\n        case ViewMode.Day:\r\n          [topValues, bottomValues] = getCalendarValuesForDay();\r\n          break;\r\n        case ViewMode.Year:\r\n          [topValues, bottomValues] = getCalendarValuesForYear();\r\n          break;\r\n        case ViewMode.Quarter:\r\n          [topValues, bottomValues] = getCalendarValuesForQuarter();\r\n          break;\r\n        default:\r\n          [topValues, bottomValues] = getCalendarValuesForOther();\r\n          break;\r\n      }\r\n      return [topValues, bottomValues];\r\n    }, [\r\n      dateSetup.viewMode,\r\n      getCalendarValuesForDay,\r\n      getCalendarValuesForMonth,\r\n      getCalendarValuesForOther,\r\n      getCalendarValuesForQuarter,\r\n      getCalendarValuesForWeek,\r\n      getCalendarValuesForYear,\r\n    ]);\r\n    return (\r\n      <g className=\"calendar\" fontSize={fontSize} fontFamily={fontFamily}>\r\n        <rect\r\n          x={0}\r\n          y={0}\r\n          width={columnWidth * dateSetup.dates.length}\r\n          height={headerHeight}\r\n          className={styles.calendarHeader}\r\n        />\r\n        {bottomValues}\r\n        {topValues}\r\n      </g>\r\n    );\r\n  }\r\n);\r\n","// A type of promise-like that resolves synchronously and supports only one observer\nexport const _Pact = /*#__PURE__*/(function() {\n\tfunction _Pact() {}\n\t_Pact.prototype.then = function(onFulfilled, onRejected) {\n\t\tconst result = new _Pact();\n\t\tconst state = this.s;\n\t\tif (state) {\n\t\t\tconst callback = state & 1 ? onFulfilled : onRejected;\n\t\t\tif (callback) {\n\t\t\t\ttry {\n\t\t\t\t\t_settle(result, 1, callback(this.v));\n\t\t\t\t} catch (e) {\n\t\t\t\t\t_settle(result, 2, e);\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t} else {\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}\n\t\tthis.o = function(_this) {\n\t\t\ttry {\n\t\t\t\tconst value = _this.v;\n\t\t\t\tif (_this.s & 1) {\n\t\t\t\t\t_settle(result, 1, onFulfilled ? onFulfilled(value) : value);\n\t\t\t\t} else if (onRejected) {\n\t\t\t\t\t_settle(result, 1, onRejected(value));\n\t\t\t\t} else {\n\t\t\t\t\t_settle(result, 2, value);\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\t_settle(result, 2, e);\n\t\t\t}\n\t\t};\n\t\treturn result;\n\t}\n\treturn _Pact;\n})();\n\n// Settles a pact synchronously\nexport function _settle(pact, state, value) {\n\tif (!pact.s) {\n\t\tif (value instanceof _Pact) {\n\t\t\tif (value.s) {\n\t\t\t\tif (state & 1) {\n\t\t\t\t\tstate = value.s;\n\t\t\t\t}\n\t\t\t\tvalue = value.v;\n\t\t\t} else {\n\t\t\t\tvalue.o = _settle.bind(null, pact, state);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tif (value && value.then) {\n\t\t\tvalue.then(_settle.bind(null, pact, state), _settle.bind(null, pact, 2));\n\t\t\treturn;\n\t\t}\n\t\tpact.s = state;\n\t\tpact.v = value;\n\t\tconst observer = pact.o;\n\t\tif (observer) {\n\t\t\tobserver(pact);\n\t\t}\n\t}\n}\n\nexport function _isSettledPact(thenable) {\n\treturn thenable instanceof _Pact && thenable.s & 1;\n}\n\n// Converts argument to a function that always returns a Promise\nexport function _async(f) {\n\treturn function() {\n\t\tfor (var args = [], i = 0; i < arguments.length; i++) {\n\t\t\targs[i] = arguments[i];\n\t\t}\n\t\ttry {\n\t\t\treturn Promise.resolve(f.apply(this, args));\n\t\t} catch(e) {\n\t\t\treturn Promise.reject(e);\n\t\t}\n\t}\n}\n\n// Awaits on a value that may or may not be a Promise (equivalent to the await keyword in ES2015, with continuations passed explicitly)\nexport function _await(value, then, direct) {\n\tif (direct) {\n\t\treturn then ? then(value) : value;\n\t}\n\tif (!value || !value.then) {\n\t\tvalue = Promise.resolve(value);\n\t}\n\treturn then ? value.then(then) : value;\n}\n\n// Awaits on a value that may or may not be a Promise, then ignores it\nexport function _awaitIgnored(value, direct) {\n\tif (!direct) {\n\t\treturn value && value.then ? value.then(_empty) : Promise.resolve();\n\t}\n}\n\n// Proceeds after a value has resolved, or proceeds immediately if the value is not thenable\nexport function _continue(value, then) {\n\treturn value && value.then ? value.then(then) : then(value);\n}\n\n// Proceeds after a value has resolved, or proceeds immediately if the value is not thenable\nexport function _continueIgnored(value) {\n\tif (value && value.then) {\n\t\treturn value.then(_empty);\n\t}\n}\n\n// Asynchronously iterate through an object that has a length property, passing the index as the first argument to the callback (even as the length property changes)\nexport function _forTo(array, body, check) {\n\tvar i = -1, pact, reject;\n\tfunction _cycle(result) {\n\t\ttry {\n\t\t\twhile (++i < array.length && (!check || !check())) {\n\t\t\t\tresult = body(i);\n\t\t\t\tif (result && result.then) {\n\t\t\t\t\tif (_isSettledPact(result)) {\n\t\t\t\t\t\tresult = result.v;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresult.then(_cycle, reject || (reject = _settle.bind(null, pact = new _Pact(), 2)));\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (pact) {\n\t\t\t\t_settle(pact, 1, result);\n\t\t\t} else {\n\t\t\t\tpact = result;\n\t\t\t}\n\t\t} catch (e) {\n\t\t\t_settle(pact || (pact = new _Pact()), 2, e);\n\t\t}\n\t}\n\t_cycle();\n\treturn pact;\n}\n\n// Asynchronously iterate through an object's properties (including properties inherited from the prototype)\n// Uses a snapshot of the object's properties\nexport function _forIn(target, body, check) {\n\tvar keys = [];\n\tfor (var key in target) {\n\t\tkeys.push(key);\n\t}\n\treturn _forTo(keys, function(i) { return body(keys[i]); }, check);\n}\n\n// Asynchronously iterate through an object's own properties (excluding properties inherited from the prototype)\n// Uses a snapshot of the object's properties\nexport function _forOwn(target, body, check) {\n\tvar keys = [];\n\tfor (var key in target) {\n\t\tif (Object.prototype.hasOwnProperty.call(target, key)) {\n\t\t\tkeys.push(key);\n\t\t}\n\t}\n\treturn _forTo(keys, function(i) { return body(keys[i]); }, check);\n}\n\nexport const _iteratorSymbol = /*#__PURE__*/ typeof Symbol !== \"undefined\" ? (Symbol.iterator || (Symbol.iterator = Symbol(\"Symbol.iterator\"))) : \"@@iterator\";\n\n// Asynchronously iterate through an object's values\n// Uses for...of if the runtime supports it, otherwise iterates until length on a copy\nexport function _forOf(target, body, check) {\n\tif (typeof target[_iteratorSymbol] === \"function\") {\n\t\tvar iterator = target[_iteratorSymbol](), step, pact, reject;\n\t\tfunction _cycle(result) {\n\t\t\ttry {\n\t\t\t\twhile (!(step = iterator.next()).done && (!check || !check())) {\n\t\t\t\t\tresult = body(step.value);\n\t\t\t\t\tif (result && result.then) {\n\t\t\t\t\t\tif (_isSettledPact(result)) {\n\t\t\t\t\t\t\tresult = result.v;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tresult.then(_cycle, reject || (reject = _settle.bind(null, pact = new _Pact(), 2)));\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (pact) {\n\t\t\t\t\t_settle(pact, 1, result);\n\t\t\t\t} else {\n\t\t\t\t\tpact = result;\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\t_settle(pact || (pact = new _Pact()), 2, e);\n\t\t\t}\n\t\t}\n\t\t_cycle();\n\t\tif (iterator.return) {\n\t\t\tvar _fixup = function(value) {\n\t\t\t\ttry {\n\t\t\t\t\tif (!step.done) {\n\t\t\t\t\t\titerator.return();\n\t\t\t\t\t}\n\t\t\t\t} catch(e) {\n\t\t\t\t}\n\t\t\t\treturn value;\n\t\t\t}\n\t\t\tif (pact && pact.then) {\n\t\t\t\treturn pact.then(_fixup, function(e) {\n\t\t\t\t\tthrow _fixup(e);\n\t\t\t\t});\n\t\t\t}\n\t\t\t_fixup();\n\t\t}\n\t\treturn pact;\n\t}\n\t// No support for Symbol.iterator\n\tif (!(\"length\" in target)) {\n\t\tthrow new TypeError(\"Object is not iterable\");\n\t}\n\t// Handle live collections properly\n\tvar values = [];\n\tfor (var i = 0; i < target.length; i++) {\n\t\tvalues.push(target[i]);\n\t}\n\treturn _forTo(values, function(i) { return body(values[i]); }, check);\n}\n\nexport const _asyncIteratorSymbol = /*#__PURE__*/ typeof Symbol !== \"undefined\" ? (Symbol.asyncIterator || (Symbol.asyncIterator = Symbol(\"Symbol.asyncIterator\"))) : \"@@asyncIterator\";\n\n// Asynchronously iterate on a value using it's async iterator if present, or its synchronous iterator if missing\nexport function _forAwaitOf(target, body, check) {\n\tif (typeof target[_asyncIteratorSymbol] === \"function\") {\n\t\tvar pact = new _Pact();\n\t\tvar iterator = target[_asyncIteratorSymbol]();\n\t\titerator.next().then(_resumeAfterNext).then(void 0, _reject);\n\t\treturn pact;\n\t\tfunction _resumeAfterBody(result) {\n\t\t\tif (check && check()) {\n\t\t\t\treturn _settle(pact, 1, iterator.return ? iterator.return().then(function() { return result; }) : result);\n\t\t\t}\n\t\t\titerator.next().then(_resumeAfterNext).then(void 0, _reject);\n\t\t}\n\t\tfunction _resumeAfterNext(step) {\n\t\t\tif (step.done) {\n\t\t\t\t_settle(pact, 1);\n\t\t\t} else {\n\t\t\t\tPromise.resolve(body(step.value)).then(_resumeAfterBody).then(void 0, _reject);\n\t\t\t}\n\t\t}\n\t\tfunction _reject(error) {\n\t\t\t_settle(pact, 2, iterator.return ? iterator.return().then(function() { return error; }) : error);\n\t\t}\n\t}\n\treturn Promise.resolve(_forOf(target, function(value) { return Promise.resolve(value).then(body); }, check));\n}\n\n// Asynchronously implement a generic for loop\nexport function _for(test, update, body) {\n\tvar stage;\n\tfor (;;) {\n\t\tvar shouldContinue = test();\n\t\tif (_isSettledPact(shouldContinue)) {\n\t\t\tshouldContinue = shouldContinue.v;\n\t\t}\n\t\tif (!shouldContinue) {\n\t\t\treturn result;\n\t\t}\n\t\tif (shouldContinue.then) {\n\t\t\tstage = 0;\n\t\t\tbreak;\n\t\t}\n\t\tvar result = body();\n\t\tif (result && result.then) {\n\t\t\tif (_isSettledPact(result)) {\n\t\t\t\tresult = result.s;\n\t\t\t} else {\n\t\t\t\tstage = 1;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (update) {\n\t\t\tvar updateValue = update();\n\t\t\tif (updateValue && updateValue.then && !_isSettledPact(updateValue)) {\n\t\t\t\tstage = 2;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tvar pact = new _Pact();\n\tvar reject = _settle.bind(null, pact, 2);\n\t(stage === 0 ? shouldContinue.then(_resumeAfterTest) : stage === 1 ? result.then(_resumeAfterBody) : updateValue.then(_resumeAfterUpdate)).then(void 0, reject);\n\treturn pact;\n\tfunction _resumeAfterBody(value) {\n\t\tresult = value;\n\t\tdo {\n\t\t\tif (update) {\n\t\t\t\tupdateValue = update();\n\t\t\t\tif (updateValue && updateValue.then && !_isSettledPact(updateValue)) {\n\t\t\t\t\tupdateValue.then(_resumeAfterUpdate).then(void 0, reject);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\tshouldContinue = test();\n\t\t\tif (!shouldContinue || (_isSettledPact(shouldContinue) && !shouldContinue.v)) {\n\t\t\t\t_settle(pact, 1, result);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (shouldContinue.then) {\n\t\t\t\tshouldContinue.then(_resumeAfterTest).then(void 0, reject);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tresult = body();\n\t\t\tif (_isSettledPact(result)) {\n\t\t\t\tresult = result.v;\n\t\t\t}\n\t\t} while (!result || !result.then);\n\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t}\n\tfunction _resumeAfterTest(shouldContinue) {\n\t\tif (shouldContinue) {\n\t\t\tresult = body();\n\t\t\tif (result && result.then) {\n\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t} else {\n\t\t\t\t_resumeAfterBody(result);\n\t\t\t}\n\t\t} else {\n\t\t\t_settle(pact, 1, result);\n\t\t}\n\t}\n\tfunction _resumeAfterUpdate() {\n\t\tif (shouldContinue = test()) {\n\t\t\tif (shouldContinue.then) {\n\t\t\t\tshouldContinue.then(_resumeAfterTest).then(void 0, reject);\n\t\t\t} else {\n\t\t\t\t_resumeAfterTest(shouldContinue);\n\t\t\t}\n\t\t} else {\n\t\t\t_settle(pact, 1, result);\n\t\t}\n\t}\n}\n\n// Asynchronously implement a do ... while loop\nexport function _do(body, test) {\n\tvar awaitBody;\n\tdo {\n\t\tvar result = body();\n\t\tif (result && result.then) {\n\t\t\tif (_isSettledPact(result)) {\n\t\t\t\tresult = result.v;\n\t\t\t} else {\n\t\t\t\tawaitBody = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tvar shouldContinue = test();\n\t\tif (_isSettledPact(shouldContinue)) {\n\t\t\tshouldContinue = shouldContinue.v;\n\t\t}\n\t\tif (!shouldContinue) {\n\t\t\treturn result;\n\t\t}\n\t} while (!shouldContinue.then);\n\tconst pact = new _Pact();\n\tconst reject = _settle.bind(null, pact, 2);\n\t(awaitBody ? result.then(_resumeAfterBody) : shouldContinue.then(_resumeAfterTest)).then(void 0, reject);\n\treturn pact;\n\tfunction _resumeAfterBody(value) {\n\t\tresult = value;\n\t\tfor (;;) {\n\t\t\tshouldContinue = test();\n\t\t\tif (_isSettledPact(shouldContinue)) {\n\t\t\t\tshouldContinue = shouldContinue.v;\n\t\t\t}\n\t\t\tif (!shouldContinue) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (shouldContinue.then) {\n\t\t\t\tshouldContinue.then(_resumeAfterTest).then(void 0, reject);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tresult = body();\n\t\t\tif (result && result.then) {\n\t\t\t\tif (_isSettledPact(result)) {\n\t\t\t\t\tresult = result.v;\n\t\t\t\t} else {\n\t\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t_settle(pact, 1, result);\n\t}\n\tfunction _resumeAfterTest(shouldContinue) {\n\t\tif (shouldContinue) {\n\t\t\tdo {\n\t\t\t\tresult = body();\n\t\t\t\tif (result && result.then) {\n\t\t\t\t\tif (_isSettledPact(result)) {\n\t\t\t\t\t\tresult = result.v;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tshouldContinue = test();\n\t\t\t\tif (_isSettledPact(shouldContinue)) {\n\t\t\t\t\tshouldContinue = shouldContinue.v;\n\t\t\t\t}\n\t\t\t\tif (!shouldContinue) {\n\t\t\t\t\t_settle(pact, 1, result);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t} while (!shouldContinue.then);\n\t\t\tshouldContinue.then(_resumeAfterTest).then(void 0, reject);\n\t\t} else {\n\t\t\t_settle(pact, 1, result);\n\t\t}\n\t}\n}\n\n// Asynchronously implement a switch statement\nexport function _switch(discriminant, cases) {\n\tvar dispatchIndex = -1;\n\tvar awaitBody;\n\touter: {\n\t\tfor (var i = 0; i < cases.length; i++) {\n\t\t\tvar test = cases[i][0];\n\t\t\tif (test) {\n\t\t\t\tvar testValue = test();\n\t\t\t\tif (testValue && testValue.then) {\n\t\t\t\t\tbreak outer;\n\t\t\t\t}\n\t\t\t\tif (testValue === discriminant) {\n\t\t\t\t\tdispatchIndex = i;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Found the default case, set it as the pending dispatch case\n\t\t\t\tdispatchIndex = i;\n\t\t\t}\n\t\t}\n\t\tif (dispatchIndex !== -1) {\n\t\t\tdo {\n\t\t\t\tvar body = cases[dispatchIndex][1];\n\t\t\t\twhile (!body) {\n\t\t\t\t\tdispatchIndex++;\n\t\t\t\t\tbody = cases[dispatchIndex][1];\n\t\t\t\t}\n\t\t\t\tvar result = body();\n\t\t\t\tif (result && result.then) {\n\t\t\t\t\tawaitBody = true;\n\t\t\t\t\tbreak outer;\n\t\t\t\t}\n\t\t\t\tvar fallthroughCheck = cases[dispatchIndex][2];\n\t\t\t\tdispatchIndex++;\n\t\t\t} while (fallthroughCheck && !fallthroughCheck());\n\t\t\treturn result;\n\t\t}\n\t}\n\tconst pact = new _Pact();\n\tconst reject = _settle.bind(null, pact, 2);\n\t(awaitBody ? result.then(_resumeAfterBody) : testValue.then(_resumeAfterTest)).then(void 0, reject);\n\treturn pact;\n\tfunction _resumeAfterTest(value) {\n\t\tfor (;;) {\n\t\t\tif (value === discriminant) {\n\t\t\t\tdispatchIndex = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (++i === cases.length) {\n\t\t\t\tif (dispatchIndex !== -1) {\n\t\t\t\t\tbreak;\n\t\t\t\t} else {\n\t\t\t\t\t_settle(pact, 1, result);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\ttest = cases[i][0];\n\t\t\tif (test) {\n\t\t\t\tvalue = test();\n\t\t\t\tif (value && value.then) {\n\t\t\t\t\tvalue.then(_resumeAfterTest).then(void 0, reject);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tdispatchIndex = i;\n\t\t\t}\n\t\t}\n\t\tdo {\n\t\t\tvar body = cases[dispatchIndex][1];\n\t\t\twhile (!body) {\n\t\t\t\tdispatchIndex++;\n\t\t\t\tbody = cases[dispatchIndex][1];\n\t\t\t}\n\t\t\tvar result = body();\n\t\t\tif (result && result.then) {\n\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar fallthroughCheck = cases[dispatchIndex][2];\n\t\t\tdispatchIndex++;\n\t\t} while (fallthroughCheck && !fallthroughCheck());\n\t\t_settle(pact, 1, result);\n\t}\n\tfunction _resumeAfterBody(result) {\n\t\tfor (;;) {\n\t\t\tvar fallthroughCheck = cases[dispatchIndex][2];\n\t\t\tif (!fallthroughCheck || fallthroughCheck()) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tdispatchIndex++;\n\t\t\tvar body = cases[dispatchIndex][1];\n\t\t\twhile (!body) {\n\t\t\t\tdispatchIndex++;\n\t\t\t\tbody = cases[dispatchIndex][1];\n\t\t\t}\n\t\t\tresult = body();\n\t\t\tif (result && result.then) {\n\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t_settle(pact, 1, result);\n\t}\n}\n\n// Asynchronously call a function and pass the result to explicitly passed continuations\nexport function _call(body, then, direct) {\n\tif (direct) {\n\t\treturn then ? then(body()) : body();\n\t}\n\ttry {\n\t\tvar result = Promise.resolve(body());\n\t\treturn then ? result.then(then) : result;\n\t} catch (e) {\n\t\treturn Promise.reject(e);\n\t}\n}\n\n// Asynchronously call a function and swallow the result\nexport function _callIgnored(body, direct) {\n\treturn _call(body, _empty, direct);\n}\n\n// Asynchronously call a function and pass the result to explicitly passed continuations\nexport function _invoke(body, then) {\n\tvar result = body();\n\tif (result && result.then) {\n\t\treturn result.then(then);\n\t}\n\treturn then(result);\n}\n\n// Asynchronously call a function and swallow the result\nexport function _invokeIgnored(body) {\n\tvar result = body();\n\tif (result && result.then) {\n\t\treturn result.then(_empty);\n\t}\n}\n\n// Asynchronously call a function and send errors to recovery continuation\nexport function _catch(body, recover) {\n\ttry {\n\t\tvar result = body();\n\t} catch(e) {\n\t\treturn recover(e);\n\t}\n\tif (result && result.then) {\n\t\treturn result.then(void 0, recover);\n\t}\n\treturn result;\n}\n\n// Asynchronously await a promise and pass the result to a finally continuation\nexport function _finallyRethrows(body, finalizer) {\n\ttry {\n\t\tvar result = body();\n\t} catch (e) {\n\t\treturn finalizer(true, e);\n\t}\n\tif (result && result.then) {\n\t\treturn result.then(finalizer.bind(null, false), finalizer.bind(null, true));\n\t}\n\treturn finalizer(false, result);\n}\n\n// Asynchronously await a promise and invoke a finally continuation that always overrides the result\nexport function _finally(body, finalizer) {\n\ttry {\n\t\tvar result = body();\n\t} catch (e) {\n\t\treturn finalizer();\n\t}\n\tif (result && result.then) {\n\t\treturn result.then(finalizer, finalizer);\n\t}\n\treturn finalizer();\n}\n\n// Rethrow or return a value from a finally continuation\nexport function _rethrow(thrown, value) {\n\tif (thrown)\n\t\tthrow value;\n\treturn value;\n}\n\n// Empty function to implement break and other control flow that ignores asynchronous results\nexport function _empty() {\n}\n\n// Sentinel value for early returns in generators \nexport const _earlyReturn = /*#__PURE__*/ {};\n\n// Asynchronously call a function and send errors to recovery continuation, skipping early returns\nexport function _catchInGenerator(body, recover) {\n\treturn _catch(body, function(e) {\n\t\tif (e === _earlyReturn) {\n\t\t\tthrow e;\n\t\t}\n\t\treturn recover(e);\n\t});\n}\n\n// Asynchronous generator class; accepts the entrypoint of the generator, to which it passes itself when the generator should start\nexport const _AsyncGenerator = /*#__PURE__*/(function() {\n\tfunction _AsyncGenerator(entry) {\n\t\tthis._entry = entry;\n\t\tthis._pact = null;\n\t\tthis._resolve = null;\n\t\tthis._return = null;\n\t\tthis._promise = null;\n\t}\n\n\tfunction _wrapReturnedValue(value) {\n\t\treturn { value: value, done: true };\n\t}\n\tfunction _wrapYieldedValue(value) {\n\t\treturn { value: value, done: false };\n\t}\n\n\t_AsyncGenerator.prototype._yield = function(value) {\n\t\t// Yield the value to the pending next call\n\t\tthis._resolve(value && value.then ? value.then(_wrapYieldedValue) : _wrapYieldedValue(value));\n\t\t// Return a pact for an upcoming next/return/throw call\n\t\treturn this._pact = new _Pact();\n\t};\n\t_AsyncGenerator.prototype.next = function(value) {\n\t\t// Advance the generator, starting it if it has yet to be started\n\t\tconst _this = this;\n\t\treturn _this._promise = new Promise(function (resolve) {\n\t\t\tconst _pact = _this._pact;\n\t\t\tif (_pact === null) {\n\t\t\t\tconst _entry = _this._entry;\n\t\t\t\tif (_entry === null) {\n\t\t\t\t\t// Generator is started, but not awaiting a yield expression\n\t\t\t\t\t// Abandon the next call!\n\t\t\t\t\treturn resolve(_this._promise);\n\t\t\t\t}\n\t\t\t\t// Start the generator\n\t\t\t\t_this._entry = null;\n\t\t\t\t_this._resolve = resolve;\n\t\t\t\tfunction returnValue(value) {\n\t\t\t\t\t_this._resolve(value && value.then ? value.then(_wrapReturnedValue) : _wrapReturnedValue(value));\n\t\t\t\t\t_this._pact = null;\n\t\t\t\t\t_this._resolve = null;\n\t\t\t\t}\n\t\t\t\tvar result = _entry(_this);\n\t\t\t\tif (result && result.then) {\n\t\t\t\t\tresult.then(returnValue, function(error) {\n\t\t\t\t\t\tif (error === _earlyReturn) {\n\t\t\t\t\t\t\treturnValue(_this._return);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconst pact = new _Pact();\n\t\t\t\t\t\t\t_this._resolve(pact);\n\t\t\t\t\t\t\t_this._pact = null;\n\t\t\t\t\t\t\t_this._resolve = null;\n\t\t\t\t\t\t\t_resolve(pact, 2, error);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\treturnValue(result);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Generator is started and a yield expression is pending, settle it\n\t\t\t\t_this._pact = null;\n\t\t\t\t_this._resolve = resolve;\n\t\t\t\t_settle(_pact, 1, value);\n\t\t\t}\n\t\t});\n\t};\n\t_AsyncGenerator.prototype.return = function(value) {\n\t\t// Early return from the generator if started, otherwise abandons the generator\n\t\tconst _this = this;\n\t\treturn _this._promise = new Promise(function (resolve) {\n\t\t\tconst _pact = _this._pact;\n\t\t\tif (_pact === null) {\n\t\t\t\tif (_this._entry === null) {\n\t\t\t\t\t// Generator is started, but not awaiting a yield expression\n\t\t\t\t\t// Abandon the return call!\n\t\t\t\t\treturn resolve(_this._promise);\n\t\t\t\t}\n\t\t\t\t// Generator is not started, abandon it and return the specified value\n\t\t\t\t_this._entry = null;\n\t\t\t\treturn resolve(value && value.then ? value.then(_wrapReturnedValue) : _wrapReturnedValue(value));\n\t\t\t}\n\t\t\t// Settle the yield expression with a rejected \"early return\" value\n\t\t\t_this._return = value;\n\t\t\t_this._resolve = resolve;\n\t\t\t_this._pact = null;\n\t\t\t_settle(_pact, 2, _earlyReturn);\n\t\t});\n\t};\n\t_AsyncGenerator.prototype.throw = function(error) {\n\t\t// Inject an exception into the pending yield expression\n\t\tconst _this = this;\n\t\treturn _this._promise = new Promise(function (resolve, reject) {\n\t\t\tconst _pact = _this._pact;\n\t\t\tif (_pact === null) {\n\t\t\t\tif (_this._entry === null) {\n\t\t\t\t\t// Generator is started, but not awaiting a yield expression\n\t\t\t\t\t// Abandon the throw call!\n\t\t\t\t\treturn resolve(_this._promise);\n\t\t\t\t}\n\t\t\t\t// Generator is not started, abandon it and return a rejected Promise containing the error\n\t\t\t\t_this._entry = null;\n\t\t\t\treturn reject(error);\n\t\t\t}\n\t\t\t// Settle the yield expression with the value as a rejection\n\t\t\t_this._resolve = resolve;\n\t\t\t_this._pact = null;\n\t\t\t_settle(_pact, 2, error);\n\t\t});\n\t};\n\n\t_AsyncGenerator.prototype[_asyncIteratorSymbol] = function() {\n\t\treturn this;\n\t};\n\t\n\treturn _AsyncGenerator;\n})();\n","import React from \"react\";\r\nimport { BarTask } from \"../../types/bar-task\";\r\n\r\ntype ArrowProps = {\r\n  taskFrom: BarTask;\r\n  taskTo: BarTask;\r\n  rowHeight: number;\r\n  taskHeight: number;\r\n  arrowIndent: number;\r\n};\r\nexport const Arrow: React.FC<ArrowProps> = ({\r\n  taskFrom,\r\n  taskTo,\r\n  rowHeight,\r\n  taskHeight,\r\n  arrowIndent,\r\n}) => {\r\n  const indexCompare = taskFrom.index > taskTo.index ? -1 : 1;\r\n  const taskToEndPosition = taskTo.y + taskHeight / 2;\r\n\r\n  const path = `M ${taskFrom.x2} ${taskFrom.y + taskHeight / 2} \r\n  h ${arrowIndent} \r\n  v ${(indexCompare * rowHeight) / 2} \r\n  H ${taskTo.x1 - arrowIndent} \r\n  V ${taskToEndPosition} \r\n  h ${arrowIndent}`;\r\n  const trianglePoints = `${taskTo.x1},${taskToEndPosition} \r\n  ${taskTo.x1 - 5},${taskToEndPosition - 5} \r\n  ${taskTo.x1 - 5},${taskToEndPosition + 5}`;\r\n  return (\r\n    <g className=\"arrow\">\r\n      <path strokeWidth=\"1.5\" d={path} fill=\"none\" />\r\n      <polygon points={trianglePoints} />\r\n    </g>\r\n  );\r\n};\r\n","import { BarTask } from \"../types/bar-task\";\r\nimport { Task, Assignee } from \"../types/public-types\";\r\n\r\nexport function isKeyboardEvent(\r\n  event: React.MouseEvent | React.KeyboardEvent | React.FocusEvent\r\n): event is React.KeyboardEvent {\r\n  return (event as React.KeyboardEvent).key !== undefined;\r\n}\r\n\r\nexport function isMouseEvent(\r\n  event: React.MouseEvent | React.KeyboardEvent | React.FocusEvent\r\n): event is React.MouseEvent {\r\n  return (event as React.MouseEvent).clientX !== undefined;\r\n}\r\n\r\nexport function isBarTask(task: Task | BarTask): task is BarTask {\r\n  return (task as BarTask).x1 !== undefined;\r\n}\r\n// 判断是平年还是闰年\r\nexport function isLeapYear(year: number) {\r\n  if (year % 4 === 0 && year % 100 !== 0) {\r\n    return true;\r\n  } else if (year % 400 === 0) {\r\n    return true;\r\n  } else {\r\n    return false;\r\n  }\r\n}\r\nexport function getQuarter(currMonth: number) {\r\n  return Math.floor(currMonth % 3 === 0 ? currMonth / 3 : currMonth / 3 + 1);\r\n}\r\nexport const initAssignee = (assignee: Assignee[]): string => {\r\n  let connectName = \"\";\r\n  if (assignee && assignee.length) {\r\n    connectName = assignee.reduce(\r\n      (str: string, cur: Assignee, index: number) => {\r\n        return index === assignee.length - 1\r\n          ? str + cur.username\r\n          : str + cur.username + \"、\";\r\n      },\r\n      \"\"\r\n    );\r\n  }\r\n  return connectName;\r\n};\r\n","import { Task, ViewMode, DateDeltaInit } from \"../types/public-types\";\r\nimport { BarTask, TaskTypeInternal } from \"../types/bar-task\";\r\nimport { BarMoveAction } from \"../types/gantt-task-actions\";\r\nimport { isLeapYear, getQuarter } from \"../helpers/other-helper\";\r\nexport const convertToBarTasks = (\r\n  tasks: Task[],\r\n  dates: Date[],\r\n  columnWidth: number,\r\n  rowHeight: number,\r\n  taskHeight: number,\r\n  barCornerRadius: number,\r\n  handleWidth: number,\r\n  barProgressColor: string,\r\n  barProgressSelectedColor: string,\r\n  barBackgroundColor: string,\r\n  barBackgroundSelectedColor: string,\r\n  projectProgressColor: string,\r\n  projectProgressSelectedColor: string,\r\n  projectBackgroundColor: string,\r\n  projectBackgroundSelectedColor: string,\r\n  milestoneBackgroundColor: string,\r\n  milestoneBackgroundSelectedColor: string,\r\n  viewMode: string\r\n) => {\r\n  const dateDelta =\r\n    dates[1].getTime() -\r\n    dates[0].getTime() -\r\n    dates[1].getTimezoneOffset() * 60 * 1000 +\r\n    dates[0].getTimezoneOffset() * 60 * 1000;\r\n  let barTasks = tasks.map((t, i) => {\r\n    return convertToBarTask(\r\n      t,\r\n      i,\r\n      dates,\r\n      dateDelta,\r\n      columnWidth,\r\n      rowHeight,\r\n      taskHeight,\r\n      barCornerRadius,\r\n      handleWidth,\r\n      barProgressColor,\r\n      barProgressSelectedColor,\r\n      barBackgroundColor,\r\n      barBackgroundSelectedColor,\r\n      projectProgressColor,\r\n      projectProgressSelectedColor,\r\n      projectBackgroundColor,\r\n      projectBackgroundSelectedColor,\r\n      milestoneBackgroundColor,\r\n      milestoneBackgroundSelectedColor,\r\n      viewMode\r\n    );\r\n  });\r\n\r\n  // set dependencies\r\n  barTasks = barTasks.map((task, i) => {\r\n    const dependencies = task.dependencies || [];\r\n    for (let j = 0; j < dependencies.length; j++) {\r\n      const dependence = barTasks.findIndex(\r\n        value => value.id === dependencies[j]\r\n      );\r\n      if (dependence !== -1) barTasks[dependence].barChildren.push(i);\r\n    }\r\n    return task;\r\n  });\r\n  return barTasks;\r\n};\r\n\r\nconst convertToBarTask = (\r\n  task: Task,\r\n  index: number,\r\n  dates: Date[],\r\n  dateDelta: number,\r\n  columnWidth: number,\r\n  rowHeight: number,\r\n  taskHeight: number,\r\n  barCornerRadius: number,\r\n  handleWidth: number,\r\n  barProgressColor: string,\r\n  barProgressSelectedColor: string,\r\n  barBackgroundColor: string,\r\n  barBackgroundSelectedColor: string,\r\n  projectProgressColor: string,\r\n  projectProgressSelectedColor: string,\r\n  projectBackgroundColor: string,\r\n  projectBackgroundSelectedColor: string,\r\n  milestoneBackgroundColor: string,\r\n  milestoneBackgroundSelectedColor: string,\r\n  viewMode: string\r\n): BarTask => {\r\n  let barTask: BarTask;\r\n  switch (task.type) {\r\n    case \"milestone\":\r\n      barTask = convertToMilestone(\r\n        task,\r\n        index,\r\n        dates,\r\n        dateDelta,\r\n        columnWidth,\r\n        rowHeight,\r\n        taskHeight,\r\n        barCornerRadius,\r\n        handleWidth,\r\n        milestoneBackgroundColor,\r\n        milestoneBackgroundSelectedColor\r\n      );\r\n      break;\r\n    case \"project\":\r\n      barTask = convertToBar(\r\n        task,\r\n        index,\r\n        dates,\r\n        dateDelta,\r\n        columnWidth,\r\n        rowHeight,\r\n        taskHeight,\r\n        barCornerRadius,\r\n        handleWidth,\r\n        projectProgressColor,\r\n        projectProgressSelectedColor,\r\n        projectBackgroundColor,\r\n        projectBackgroundSelectedColor,\r\n        viewMode\r\n      );\r\n      break;\r\n    default:\r\n      barTask = convertToBar(\r\n        task,\r\n        index,\r\n        dates,\r\n        dateDelta,\r\n        columnWidth,\r\n        rowHeight,\r\n        taskHeight,\r\n        barCornerRadius,\r\n        handleWidth,\r\n        barProgressColor,\r\n        barProgressSelectedColor,\r\n        barBackgroundColor,\r\n        barBackgroundSelectedColor,\r\n        viewMode\r\n      );\r\n      break;\r\n  }\r\n  return barTask;\r\n};\r\n\r\nconst convertToBar = (\r\n  task: Task,\r\n  index: number,\r\n  dates: Date[],\r\n  dateDelta: number,\r\n  columnWidth: number,\r\n  rowHeight: number,\r\n  taskHeight: number,\r\n  barCornerRadius: number,\r\n  handleWidth: number,\r\n  barProgressColor: string,\r\n  barProgressSelectedColor: string,\r\n  barBackgroundColor: string,\r\n  barBackgroundSelectedColor: string,\r\n  viewMode: string\r\n): BarTask => {\r\n  const x1: any = taskXCoordinate(\r\n    task.start,\r\n    dates,\r\n    dateDelta,\r\n    columnWidth,\r\n    viewMode\r\n  );\r\n  let x2: any = taskXCoordinate(\r\n    task.end,\r\n    dates,\r\n    dateDelta,\r\n    columnWidth,\r\n    viewMode\r\n  );\r\n  const y = taskYCoordinate(index, rowHeight, taskHeight);\r\n\r\n  const styles = {\r\n    backgroundColor: barBackgroundColor,\r\n    backgroundSelectedColor: barBackgroundSelectedColor,\r\n    progressColor: barProgressColor,\r\n    progressSelectedColor: barProgressSelectedColor,\r\n    ...task.styles,\r\n  };\r\n  const typeInternal: TaskTypeInternal = task.type;\r\n  if (\r\n    (typeInternal === \"task\" || typeInternal === \"parent\") &&\r\n    x2 - x1 < handleWidth * 2\r\n  ) {\r\n    x2 = x1 + handleWidth * 2;\r\n  }\r\n  return {\r\n    ...task,\r\n    typeInternal,\r\n    x1,\r\n    x2,\r\n    y,\r\n    index,\r\n    barCornerRadius,\r\n    handleWidth,\r\n    height: taskHeight,\r\n    barChildren: [],\r\n    styles,\r\n  };\r\n};\r\n\r\nconst convertToMilestone = (\r\n  task: Task,\r\n  index: number,\r\n  dates: Date[],\r\n  dateDelta: number,\r\n  columnWidth: number,\r\n  rowHeight: number,\r\n  taskHeight: number,\r\n  barCornerRadius: number,\r\n  handleWidth: number,\r\n  milestoneBackgroundColor: string,\r\n  milestoneBackgroundSelectedColor: string\r\n) => {\r\n  const x: any = taskXCoordinate(task.end, dates, dateDelta, columnWidth);\r\n  const y = taskYCoordinate(index, rowHeight, taskHeight);\r\n  const x1 = x - taskHeight * 0.5;\r\n  const x2 = x + taskHeight * 0.5;\r\n  const styles = {\r\n    backgroundColor: milestoneBackgroundColor,\r\n    backgroundSelectedColor: milestoneBackgroundSelectedColor,\r\n    progressColor: \"\",\r\n    progressSelectedColor: \"\",\r\n    ...task.styles,\r\n  };\r\n  return {\r\n    ...task,\r\n    end: task.start,\r\n    x1,\r\n    x2,\r\n    y,\r\n    index,\r\n    barCornerRadius,\r\n    handleWidth,\r\n    typeInternal: task.type,\r\n    progress: 0,\r\n    height: taskHeight,\r\n    barChildren: [],\r\n    styles,\r\n  };\r\n};\r\n\r\nconst taskXCoordinate = (\r\n  xDate: Date,\r\n  dates: Date[],\r\n  dateDelta: number,\r\n  columnWidth: number,\r\n  viewMode?: string\r\n) => {\r\n  if (!xDate) return;\r\n  let precision;\r\n  let index = 0;\r\n  if (viewMode === ViewMode.Month) {\r\n    index =\r\n      xDate?.getFullYear() * 12 +\r\n      xDate?.getMonth() -\r\n      dates[0]?.getFullYear() * 12 -\r\n      dates[0]?.getMonth();\r\n    if (isLeapYear(xDate?.getFullYear()) && xDate?.getMonth() === 1) {\r\n      precision = DateDeltaInit.LeapMounth;\r\n    } else {\r\n      precision = DateDeltaInit[ViewMode.Month][xDate?.getMonth() + 1];\r\n    }\r\n  } else if (viewMode === ViewMode.Year) {\r\n    index = xDate?.getFullYear() - dates[0]?.getFullYear();\r\n    precision = isLeapYear(xDate?.getFullYear())\r\n      ? DateDeltaInit[ViewMode.Year].leap\r\n      : DateDeltaInit[ViewMode.Year].common;\r\n  } else if (viewMode === ViewMode.Quarter) {\r\n    index =\r\n      xDate?.getFullYear() * 4 +\r\n      getQuarter(xDate?.getMonth() + 1) -\r\n      dates[0]?.getFullYear() * 4 -\r\n      getQuarter(dates[0]?.getMonth() + 1);\r\n    if (\r\n      isLeapYear(xDate?.getFullYear()) &&\r\n      getQuarter(xDate?.getMonth() + 1) === 1\r\n    ) {\r\n      precision = DateDeltaInit.LeapQuarter;\r\n    } else {\r\n      precision =\r\n        DateDeltaInit[ViewMode.Quarter][getQuarter(xDate?.getMonth() + 1)];\r\n    }\r\n  } else {\r\n    index = ~~(\r\n      (xDate.getTime() -\r\n        dates[0].getTime() +\r\n        xDate.getTimezoneOffset() -\r\n        dates[0].getTimezoneOffset()) /\r\n      dateDelta\r\n    );\r\n    precision = dateDelta;\r\n  }\r\n  if (index < 0) {\r\n    index = 0;\r\n  } else if (index > dates.length - 1) {\r\n    index = dates.length - 1;\r\n  }\r\n  const x = Math.round(\r\n    (index +\r\n      (xDate.getTime() -\r\n        dates[index].getTime() -\r\n        xDate.getTimezoneOffset() * 60 * 1000 +\r\n        dates[index].getTimezoneOffset() * 60 * 1000) /\r\n        precision) *\r\n      columnWidth\r\n  );\r\n  return x;\r\n};\r\n\r\nconst taskYCoordinate = (\r\n  index: number,\r\n  rowHeight: number,\r\n  taskHeight: number\r\n) => {\r\n  const y = index * rowHeight + (rowHeight - taskHeight) / 2;\r\n  return y;\r\n};\r\n\r\nexport const progressWithByParams = (\r\n  taskX1: number,\r\n  taskX2: number,\r\n  progress: number\r\n) => {\r\n  return (taskX2 - taskX1) * progress * 0.01;\r\n};\r\n\r\nexport const progressByProgressWidth = (\r\n  progressWidth: number,\r\n  barTask: BarTask\r\n) => {\r\n  const barWidth = barTask.x2 - barTask.x1;\r\n  const progressPercent = Math.round((progressWidth * 100) / barWidth);\r\n  if (progressPercent >= 100) return 100;\r\n  else if (progressPercent <= 0) return 0;\r\n  else {\r\n    return progressPercent;\r\n  }\r\n};\r\n\r\nconst progressByX = (x: number, task: BarTask) => {\r\n  if (x >= task.x2) return 100;\r\n  else if (x <= task.x1) return 0;\r\n  else {\r\n    const barWidth = task.x2 - task.x1;\r\n    const progressPercent = Math.round(((x - task.x1) * 100) / barWidth);\r\n    return progressPercent;\r\n  }\r\n};\r\n\r\nexport const getProgressPoint = (\r\n  progressX: number,\r\n  taskY: number,\r\n  taskHeight: number\r\n) => {\r\n  const point = [\r\n    progressX - 5,\r\n    taskY + taskHeight,\r\n    progressX + 5,\r\n    taskY + taskHeight,\r\n    progressX,\r\n    taskY + taskHeight - 5.66,\r\n  ];\r\n  return point.join(\",\");\r\n};\r\n\r\nconst startByX = (x: number, xStep: number, task: BarTask) => {\r\n  if (x >= task.x2 - task.handleWidth * 2) {\r\n    x = task.x2 - task.handleWidth * 2;\r\n  }\r\n  const steps = Math.round((x - task.x1) / xStep);\r\n  const additionalXValue = steps * xStep;\r\n  const newX = task.x1 + additionalXValue;\r\n  return newX;\r\n};\r\n\r\nconst endByX = (x: number, xStep: number, task: BarTask) => {\r\n  if (x <= task.x1 + task.handleWidth * 2) {\r\n    x = task.x1 + task.handleWidth * 2;\r\n  }\r\n  const steps = Math.round((x - task.x2) / xStep);\r\n  const additionalXValue = steps * xStep;\r\n  const newX = task.x2 + additionalXValue;\r\n  return newX;\r\n};\r\n\r\nconst moveByX = (x: number, xStep: number, task: BarTask) => {\r\n  const steps = Math.round((x - task.x1) / xStep);\r\n  const additionalXValue = steps * xStep;\r\n  const newX1 = task.x1 + additionalXValue;\r\n  const newX2 = newX1 + task.x2 - task.x1;\r\n  return [newX1, newX2];\r\n};\r\n\r\nconst dateByX = (\r\n  x: number,\r\n  taskX: number,\r\n  taskDate: Date,\r\n  xStep: number,\r\n  timeStep: number\r\n) => {\r\n  let newDate = new Date(((x - taskX) / xStep) * timeStep + taskDate.getTime());\r\n  newDate = new Date(\r\n    newDate.getTime() +\r\n      (newDate.getTimezoneOffset() - taskDate.getTimezoneOffset()) * 60000\r\n  );\r\n  return newDate;\r\n};\r\n\r\n/**\r\n * Method handles event in real time(mousemove) and on finish(mouseup)\r\n */\r\nexport const handleTaskBySVGMouseEvent = (\r\n  svgX: number,\r\n  action: BarMoveAction,\r\n  selectedTask: BarTask,\r\n  xStep: number,\r\n  timeStep: number,\r\n  initEventX1Delta: number\r\n): { isChanged: boolean; changedTask: BarTask } => {\r\n  let result: { isChanged: boolean; changedTask: BarTask };\r\n  switch (selectedTask.type) {\r\n    case \"milestone\":\r\n      result = handleTaskBySVGMouseEventForMilestone(\r\n        svgX,\r\n        action,\r\n        selectedTask,\r\n        xStep,\r\n        timeStep,\r\n        initEventX1Delta\r\n      );\r\n      break;\r\n    default:\r\n      result = handleTaskBySVGMouseEventForBar(\r\n        svgX,\r\n        action,\r\n        selectedTask,\r\n        xStep,\r\n        timeStep,\r\n        initEventX1Delta\r\n      );\r\n      break;\r\n  }\r\n  return result;\r\n};\r\n\r\nconst handleTaskBySVGMouseEventForBar = (\r\n  svgX: number,\r\n  action: BarMoveAction,\r\n  selectedTask: BarTask,\r\n  xStep: number,\r\n  timeStep: number,\r\n  initEventX1Delta: number\r\n): { isChanged: boolean; changedTask: BarTask } => {\r\n  const changedTask: BarTask = { ...selectedTask };\r\n  let isChanged = false;\r\n  switch (action) {\r\n    case \"progress\":\r\n      changedTask.progress = progressByX(svgX, selectedTask);\r\n      isChanged = changedTask.progress !== selectedTask.progress;\r\n      break;\r\n    case \"start\": {\r\n      const newX1 = startByX(svgX, xStep, selectedTask);\r\n      changedTask.x1 = newX1;\r\n      isChanged = changedTask.x1 !== selectedTask.x1;\r\n      if (isChanged) {\r\n        changedTask.start = dateByX(\r\n          newX1,\r\n          selectedTask.x1,\r\n          selectedTask.start,\r\n          xStep,\r\n          timeStep\r\n        );\r\n      }\r\n      break;\r\n    }\r\n    case \"end\": {\r\n      const newX2 = endByX(svgX, xStep, selectedTask);\r\n      changedTask.x2 = newX2;\r\n      isChanged = changedTask.x2 !== selectedTask.x2;\r\n      if (isChanged) {\r\n        changedTask.end = dateByX(\r\n          newX2,\r\n          selectedTask.x2,\r\n          selectedTask.end,\r\n          xStep,\r\n          timeStep\r\n        );\r\n      }\r\n      break;\r\n    }\r\n    case \"move\": {\r\n      const [newMoveX1, newMoveX2] = moveByX(\r\n        svgX - initEventX1Delta,\r\n        xStep,\r\n        selectedTask\r\n      );\r\n      isChanged = newMoveX1 !== selectedTask.x1;\r\n      if (isChanged) {\r\n        changedTask.start = dateByX(\r\n          newMoveX1,\r\n          selectedTask.x1,\r\n          selectedTask.start,\r\n          xStep,\r\n          timeStep\r\n        );\r\n        changedTask.end = dateByX(\r\n          newMoveX2,\r\n          selectedTask.x2,\r\n          selectedTask.end,\r\n          xStep,\r\n          timeStep\r\n        );\r\n        changedTask.x1 = newMoveX1;\r\n        changedTask.x2 = newMoveX2;\r\n      }\r\n      break;\r\n    }\r\n  }\r\n  return { isChanged, changedTask };\r\n};\r\n\r\nconst handleTaskBySVGMouseEventForMilestone = (\r\n  svgX: number,\r\n  action: BarMoveAction,\r\n  selectedTask: BarTask,\r\n  xStep: number,\r\n  timeStep: number,\r\n  initEventX1Delta: number\r\n): { isChanged: boolean; changedTask: BarTask } => {\r\n  const changedTask: BarTask = { ...selectedTask };\r\n  let isChanged = false;\r\n  switch (action) {\r\n    case \"move\": {\r\n      const [newMoveX1, newMoveX2] = moveByX(\r\n        svgX - initEventX1Delta,\r\n        xStep,\r\n        selectedTask\r\n      );\r\n      isChanged = newMoveX1 !== selectedTask.x1;\r\n      if (isChanged) {\r\n        changedTask.start = dateByX(\r\n          newMoveX1,\r\n          selectedTask.x1,\r\n          selectedTask.start,\r\n          xStep,\r\n          timeStep\r\n        );\r\n        changedTask.end = changedTask.start;\r\n        changedTask.x1 = newMoveX1;\r\n        changedTask.x2 = newMoveX2;\r\n      }\r\n      break;\r\n    }\r\n  }\r\n  return { isChanged, changedTask };\r\n};\r\n","import React from \"react\";\r\nimport style from \"./bar.module.css\";\r\nimport { BarTask } from \"../../../types/bar-task\";\r\nimport {\r\n  barBackgroundColorPivotalPath,\r\n  barBackgroundColorTimeError,\r\n} from \"../../../helpers/dicts\";\r\n\r\ntype BarDisplayProps = {\r\n  x: number;\r\n  y: number;\r\n  task?: BarTask;\r\n  width: number;\r\n  height: number;\r\n  isSelected: boolean;\r\n  progressWidth: number;\r\n  barCornerRadius: number;\r\n  styles: {\r\n    backgroundColor: string;\r\n    backgroundSelectedColor: string;\r\n    progressColor: string;\r\n    progressSelectedColor: string;\r\n    opacity?: number;\r\n  };\r\n  onMouseDown: (event: React.MouseEvent<SVGPolygonElement, MouseEvent>) => void;\r\n  id: string;\r\n  isLog?: boolean | undefined;\r\n};\r\nexport const BarDisplay: React.FC<BarDisplayProps> = ({\r\n  x,\r\n  y,\r\n  width,\r\n  height,\r\n  isSelected,\r\n  progressWidth,\r\n  barCornerRadius,\r\n  styles,\r\n  onMouseDown,\r\n  id,\r\n  task,\r\n  isLog,\r\n}) => {\r\n  const getBarColor = () => {\r\n    return task?.isTimeErrorItem || task?.isOverdueItem\r\n      ? barBackgroundColorTimeError\r\n      : task?.isPivotalPathItem\r\n      ? barBackgroundColorPivotalPath\r\n      : isSelected\r\n      ? styles.backgroundSelectedColor\r\n      : styles.backgroundColor;\r\n  };\r\n  return (\r\n    <g onMouseDown={onMouseDown}>\r\n      <rect\r\n        id={id}\r\n        x={x}\r\n        width={width}\r\n        y={y}\r\n        height={height}\r\n        ry={barCornerRadius}\r\n        rx={barCornerRadius}\r\n        fill={getBarColor()}\r\n        className={style.barBackground}\r\n      />\r\n      <rect\r\n        x={x + progressWidth}\r\n        width={width - progressWidth}\r\n        y={y}\r\n        height={height}\r\n        style={{ opacity: isLog ? 0.8 : 0.4 }}\r\n        fill=\"#fff\"\r\n      />\r\n    </g>\r\n  );\r\n};\r\n","import React from \"react\";\r\n// import styles from \"./bar.module.css\";\r\n\r\ntype BarDateHandleProps = {\r\n  x: number;\r\n  y: number;\r\n  width: number;\r\n  height: number;\r\n  type: string;\r\n  onMouseDown: (event: React.MouseEvent<SVGRectElement, MouseEvent>) => void;\r\n};\r\nexport const BarDateHandle: React.FC<BarDateHandleProps> = ({\r\n  x,\r\n  y,\r\n  width,\r\n  height,\r\n  type,\r\n  onMouseDown,\r\n}) => {\r\n  return (\r\n    <g onMouseDown={onMouseDown}>\r\n      <rect\r\n        x={type === \"left\" ? x - 18 : x + 6}\r\n        y={y + 3}\r\n        width={12}\r\n        height={20}\r\n        className=\"barHandle barHandleBg\"\r\n      />\r\n      <rect\r\n        x={type === \"left\" ? x - 14 : x + 14}\r\n        y={y + 6}\r\n        width={width}\r\n        height={height}\r\n        className=\"barHandle barHandleDate\"\r\n        ry={1}\r\n        rx={1}\r\n      />\r\n      <rect\r\n        x={type === \"left\" ? x - 10 : x + 10}\r\n        y={y + 6}\r\n        width={width}\r\n        height={height}\r\n        className=\"barHandle barHandleDate\"\r\n        ry={1}\r\n        rx={1}\r\n      />\r\n    </g>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport styles from \"./bar.module.css\";\r\n\r\ntype BarProgressHandleProps = {\r\n  progressPoint: string;\r\n  onMouseDown: (event: React.MouseEvent<SVGPolygonElement, MouseEvent>) => void;\r\n};\r\nexport const BarProgressHandle: React.FC<BarProgressHandleProps> = ({\r\n  progressPoint,\r\n  onMouseDown,\r\n}) => {\r\n  return (\r\n    <polygon\r\n      className={`barHandle ${styles.barHandleProgress}`}\r\n      points={progressPoint}\r\n      onMouseDown={onMouseDown}\r\n    />\r\n  );\r\n};\r\n","// 是否允许改变流程图的布局（包括大小、连线、节点删除等）\r\nexport const canChangeLayout = true;\r\n\r\n// 很多连接线都是相同设置的情况下，可以将配置抽离出来，作为一个单独的变量，作为connect的第二个参数传入。\r\n// 实际上connect的第二个参数会和第一个参数merge，作为一个整体。\r\nexport const commonConfig = {\r\n  /**\r\n   * 如果你将isSource和isTarget设置成true，那么久可以用户在拖动时，自动创建链接。\r\n   */\r\n  // 是否可以拖动（作为连线起点）\r\n  isSource: canChangeLayout,\r\n  // 是否可以放置（连线终点）\r\n  isTarget: canChangeLayout,\r\n  // 设置连接点最多可以连接几条线\r\n  // -1不限制，默认限制一条线\r\n  maxConnections: -1,\r\n  // 设置锚点位置，按照[target, source]的顺序进行设置\r\n  // 可以有 Bottom Top Right Left四种方位\r\n  // 还可以是BottomLeft BottomRight BottomCenter TopLeft TopRight TopCenter LeftMiddle RightMiddle的组合\r\n  // 默认值 ['Bottom', 'Bottom']\r\n  // anchor: ['Bottom', 'Bottom'],\r\n  // 端点类型，形状（区分大小写），Rectangle-正方形 Dot-圆形 Blank-空\r\n  endpoint: [\r\n    canChangeLayout ? \"Dot\" : \"Blank\",\r\n    {\r\n      radius: 4,\r\n      cssClass: \"end-point\",\r\n    },\r\n  ],\r\n  // 设置端点的样式\r\n  endpointStyle: {\r\n    // fill: \"#0A50D1\", // 填充颜色\r\n    // outlineStroke: \"blank\", // 边框颜色\r\n    // outlineWidth: 0, // 边框宽度\r\n  },\r\n  // 设置连接线的样式 Bezier-贝瑟尔曲线 Flowchart-流程图 StateMachine-弧线 Straight-直线\r\n  connector: [\r\n    \"Flowchart\",\r\n    { alwaysRespectStubs: true, cornerRadius: 8, stub: 16 },\r\n  ],\r\n  // 设置连接线的样式\r\n  connectorStyle: {\r\n    stroke: \"#979797\", // 实线颜色\r\n    strokeWidth: 1.5, // 实线宽度\r\n    strokeOpacity: 0.5,\r\n  },\r\n  // 设置连接线悬浮样式\r\n  connectorHoverStyle: {\r\n    strokeWidth: 2,\r\n    stroke: \"#0C62FF\",\r\n    outlineWidth: 5,\r\n    outlineStroke: \"F7F7F7\",\r\n  },\r\n\r\n  // 设置连接线的箭头\r\n  // 可以设置箭头的长宽以及箭头的位置，location 0.5表示箭头位于中间，location 1表示箭头设置在连接线末端。 一根连接线是可以添加多个箭头的。\r\n  connectorOverlays: [\r\n    [\r\n      \"PlainArrow\",\r\n      {\r\n        width: 8,\r\n        length: 8,\r\n        location: 1,\r\n      },\r\n    ],\r\n  ],\r\n};\r\nexport const offsetCalculators = {\r\n  CIRCLE: function (el: any) {\r\n    const cx = parseInt(el.getAttribute(\"cx\"), 10);\r\n    const cy = parseInt(el.getAttribute(\"cy\"), 10);\r\n    const r = parseInt(el.getAttribute(\"r\"), 10);\r\n    return {\r\n      left: cx - r,\r\n      top: cy - r,\r\n    };\r\n  },\r\n  ELLIPSE: function (el: any) {\r\n    const cx = parseInt(el.getAttribute(\"cx\"), 10);\r\n    const cy = parseInt(el.getAttribute(\"cy\"), 10);\r\n    const rx = parseInt(el.getAttribute(\"rx\"), 10);\r\n    const ry = parseInt(el.getAttribute(\"ry\"), 10);\r\n    return {\r\n      left: cx - rx,\r\n      top: cy - ry,\r\n    };\r\n  },\r\n  RECT: function (el: any) {\r\n    const x = parseInt(el.getAttribute(\"x\"), 10);\r\n    const y = parseInt(el.getAttribute(\"y\"), 10);\r\n    return {\r\n      left: x,\r\n      top: y,\r\n    };\r\n  },\r\n};\r\n// custom size calculators for SVG shapes.\r\nexport const sizeCalculators = {\r\n  CIRCLE: function (el: any) {\r\n    const r = parseInt(el.getAttribute(\"r\"), 10);\r\n    return [r * 2, r * 2];\r\n  },\r\n  ELLIPSE: function (el: any) {\r\n    const rx = parseInt(el.getAttribute(\"rx\"), 10);\r\n    const ry = parseInt(el.getAttribute(\"ry\"), 10);\r\n    return [rx * 2, ry * 2];\r\n  },\r\n  RECT: function (el: any) {\r\n    const w = parseInt(el.getAttribute(\"width\"), 10);\r\n    const h = parseInt(el.getAttribute(\"height\"), 10);\r\n    return [w, h];\r\n  },\r\n};\r\nexport const relationInit = {\r\n  FS: [\"Right\", \"Left\"],\r\n  FF: [\"Right\", \"Right\"],\r\n  SS: [\"Left\", \"Left\"],\r\n  SF: [\"Left\", \"Right\"],\r\n};\r\nexport const relationReverse = (start: string, end: string) => {\r\n  if (start === \"Right\" && end === \"Left\") {\r\n    return \"FS\";\r\n  }\r\n  if (start === \"Right\" && end === \"Right\") {\r\n    return \"FF\";\r\n  }\r\n  if (start === \"Left\" && end === \"Left\") {\r\n    return \"SS\";\r\n  }\r\n  if (start === \"Left\" && end === \"Right\") {\r\n    return \"SF\";\r\n  }\r\n  return \"SS\";\r\n};\r\nexport const deleteIcon = `<svg t=\"1633768438353\" class=\"icon\" viewBox=\"0 0 1024 1024\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" p-id=\"4762\" width=\"20\" height=\"20\"><path d=\"M522.24 512m-440.32 0a440.32 440.32 0 1 0 880.64 0 440.32 440.32 0 1 0-880.64 0Z\" fill=\"#666666\" p-id=\"4763\"></path><path d=\"M667.136 687.616c-7.68 0-15.872-3.072-21.504-9.216L355.84 389.12c-11.776-11.776-11.776-31.232 0-43.52 11.776-11.776 31.232-11.776 43.52 0l289.792 289.792c11.776 11.776 11.776 31.232 0 43.52-6.144 5.632-14.336 8.704-22.016 8.704z\" fill=\"#FFFFFF\" p-id=\"4764\"></path><path d=\"M377.344 687.616c-7.68 0-15.872-3.072-21.504-9.216-11.776-11.776-11.776-31.232 0-43.52L645.12 345.6c11.776-11.776 31.232-11.776 43.52 0 11.776 11.776 11.776 31.232 0 43.52L399.36 678.4c-6.144 6.144-13.824 9.216-22.016 9.216z\" fill=\"#FFFFFF\" p-id=\"4765\"></path></svg>`;\r\n","import { useEffect, useState, useMemo } from \"react\";\r\nimport { commonConfig } from \"../../helpers/jsPlumbConfig\";\r\nexport const pointOverEvent = (barRef: any, jsPlumb: any, id: string) => {\r\n  // 鼠标移入连接点时会触发barWrapper失去hover,从而导致barHandle和handleGroup消失，所以采用动态添加class的方式\r\n  barRef.current.classList.add(\"barHover\");\r\n  // 鼠标移入连接点时，使另外一个连接节点也显示出来\r\n  if (jsPlumb) {\r\n    jsPlumb.selectEndpoints({ element: id }).addClass(\"endpoint-hover\");\r\n  }\r\n};\r\nexport const pointOutEvent = (\r\n  barRef: React.RefObject<Element>,\r\n  jsPlumb: any,\r\n  id: string\r\n) => {\r\n  barRef?.current?.classList.remove(\"barHover\");\r\n  if (jsPlumb) {\r\n    jsPlumb.selectEndpoints({ element: id }).removeClass(\"endpoint-hover\");\r\n  }\r\n};\r\nexport const barAnchor = {\r\n  milestone: {\r\n    Left: [0, 0.5, -1, 0, 5, 0, \"Left\"],\r\n    Right: [1, 0.5, 1, 0, -2, 0, \"Right\"],\r\n  },\r\n  normal: {\r\n    Left: [0, 0.5, -1, 0, 0, 0, \"Left\"],\r\n    Right: [1, 0.5, 1, 0, 0, 0, \"Right\"],\r\n  },\r\n};\r\nexport const useHover = (\r\n  barRef: React.RefObject<Element>,\r\n  jsPlumb: any,\r\n  id: string,\r\n  action: string\r\n): any => {\r\n  const passiveAction = useMemo(() => {\r\n    return [\"start\", \"end\", \"progress\", \"move\"].includes(action);\r\n  }, [action]);\r\n  useEffect((): any => {\r\n    if (barRef.current && jsPlumb) {\r\n      const addHoverClass = () => {\r\n        if (!passiveAction) {\r\n          barRef?.current?.classList.add(\"barHover\");\r\n\r\n          jsPlumb.selectEndpoints({ element: id }).addClass(\"endpoint-hover\");\r\n          jsPlumb.selectEndpoints({ element: id }).setVisible(true);\r\n        } else {\r\n          barRef?.current?.classList.remove(\"barHover\");\r\n          jsPlumb\r\n            .selectEndpoints({ element: id })\r\n            .removeClass(\"endpoint-hover\");\r\n          jsPlumb\r\n            .selectEndpoints({ element: id })\r\n            .setVisible(false, true, true);\r\n        }\r\n      };\r\n      const removeHoverClass = () => {\r\n        barRef?.current?.classList.remove(\"barHover\");\r\n\r\n        jsPlumb.selectEndpoints({ element: id }).removeClass(\"endpoint-hover\");\r\n      };\r\n      const nodeDom = barRef.current;\r\n      nodeDom.addEventListener(\"mousemove\", addHoverClass);\r\n      nodeDom.addEventListener(\"mouseout\", removeHoverClass);\r\n      return () => {\r\n        if (nodeDom) {\r\n          nodeDom.removeEventListener(\"mousemove\", addHoverClass);\r\n          nodeDom.removeEventListener(\"mouseout\", removeHoverClass);\r\n        }\r\n      };\r\n    }\r\n  }, [barRef, jsPlumb, id, passiveAction]);\r\n};\r\n\r\nexport const useAddPoint = (\r\n  jsPlumb: any,\r\n  task: any,\r\n  barRef: any,\r\n  type?: string\r\n) => {\r\n  const [addPointFinished, setAddPointFinished] = useState(false);\r\n  useEffect(() => {\r\n    if (jsPlumb) {\r\n      // 生成新节点删除旧节点时需设置setIdChanged\r\n      jsPlumb.setIdChanged(task.id, task.id);\r\n      const rightPoint = jsPlumb.addEndpoint(\r\n        task.id,\r\n        {\r\n          anchor:\r\n            type === \"milestone\"\r\n              ? barAnchor.milestone.Right\r\n              : barAnchor.normal.Right,\r\n          uuid: task.id + \"-Right\",\r\n        },\r\n        commonConfig\r\n      );\r\n      rightPoint.bind(\"mouseover\", () =>\r\n        pointOverEvent(barRef, jsPlumb, task.id)\r\n      );\r\n      rightPoint.bind(\"mouseout\", () =>\r\n        pointOutEvent(barRef, jsPlumb, task.id)\r\n      );\r\n      const leftPoint = jsPlumb.addEndpoint(\r\n        task.id,\r\n        {\r\n          anchor:\r\n            type === \"milestone\"\r\n              ? barAnchor.milestone.Left\r\n              : barAnchor.normal.Left,\r\n          uuid: task.id + \"-Left\",\r\n        },\r\n        commonConfig\r\n      );\r\n      leftPoint.bind(\"mouseover\", () =>\r\n        pointOverEvent(barRef, jsPlumb, task.id)\r\n      );\r\n      leftPoint.bind(\"mouseout\", () => pointOutEvent(barRef, jsPlumb, task.id));\r\n      setAddPointFinished(true);\r\n    }\r\n    return () => {\r\n      if (jsPlumb) {\r\n        jsPlumb.deleteEndpoint(task.id + \"-Left\");\r\n        jsPlumb.deleteEndpoint(task.id + \"-Right\");\r\n      }\r\n    };\r\n  }, [jsPlumb, task.y, barRef, task.id, type]);\r\n  return addPointFinished;\r\n};\r\n","import React, { useEffect, useRef } from \"react\";\r\nimport {\r\n  progressWithByParams,\r\n  getProgressPoint,\r\n} from \"../../../helpers/bar-helper\";\r\nimport { BarDisplay } from \"./bar-display\";\r\nimport { BarDateHandle } from \"./bar-date-handle\";\r\nimport { BarProgressHandle } from \"./bar-progress-handle\";\r\nimport { TaskItemProps } from \"../task-item\";\r\nimport styles from \"./bar.module.css\";\r\nimport { useHover, useAddPoint } from \"../hook\";\r\nexport const Bar: React.FC<TaskItemProps> = ({\r\n  task,\r\n  isProgressChangeable,\r\n  isDateChangeable,\r\n  onEventStart,\r\n  isSelected,\r\n  jsPlumb,\r\n  isLog,\r\n  setPointInited,\r\n  ganttEvent = {\r\n    action: \"\",\r\n  },\r\n}) => {\r\n  const { action } = ganttEvent;\r\n  const barRef = useRef<any>(null);\r\n  const progressWidth = progressWithByParams(task.x1, task.x2, task.progress);\r\n  const progressPoint = getProgressPoint(\r\n    progressWidth + task.x1,\r\n    task.y,\r\n    task.height\r\n  );\r\n  const handleHeight = task.height - 12;\r\n  // 设置端点\r\n  const addPointFinished = useAddPoint(jsPlumb, task, barRef);\r\n  useEffect(() => {\r\n    if (addPointFinished) {\r\n      setPointInited?.(addPointFinished);\r\n    }\r\n  }, [addPointFinished, setPointInited]);\r\n  useEffect(() => {\r\n    if (jsPlumb) {\r\n      // 重绘元素，解决拖动时间块连接点跟随\r\n      jsPlumb.revalidate(task.id);\r\n    }\r\n  }, [jsPlumb, task]);\r\n  useEffect(() => {\r\n    return () => {\r\n      if (jsPlumb) {\r\n        jsPlumb.deleteEndpoint(task.id + \"-Left\");\r\n        jsPlumb.deleteEndpoint(task.id + \"-Right\");\r\n      }\r\n    };\r\n  }, [jsPlumb, task.id]);\r\n  useHover(barRef, jsPlumb, task.id, action);\r\n  return (\r\n    <svg>\r\n      <g ref={barRef} className={styles.barWrapper} tabIndex={0}>\r\n        {!isLog && isDateChangeable && (\r\n          <g className=\"barHandle\">\r\n            <rect\r\n              x={task.x1 - 20}\r\n              y={task.y - 3}\r\n              width={task.x2 - task.x1 + 40}\r\n              height={task.height + 6}\r\n              className={`barHandle ${styles.barHandleBackground}`}\r\n              ry={task.barCornerRadius}\r\n              rx={task.barCornerRadius}\r\n            />\r\n          </g>\r\n        )}\r\n\r\n        <BarDisplay\r\n          x={task.x1}\r\n          y={task.y}\r\n          task={task}\r\n          width={task.x2 - task.x1}\r\n          height={task.height}\r\n          progressWidth={progressWidth}\r\n          barCornerRadius={task.barCornerRadius}\r\n          styles={!isLog ? task.styles : { ...task.styles, opacity: 0.5 }}\r\n          isSelected={isSelected}\r\n          id={isLog ? `${task.id}-log` : task.id}\r\n          isLog={isLog}\r\n          onMouseDown={e => {\r\n            isDateChangeable && !isLog && onEventStart(\"move\", task, e);\r\n          }}\r\n        />\r\n        <g className=\"handleGroup\">\r\n          {isDateChangeable && !isLog && (\r\n            <g>\r\n              {/* left */}\r\n              <BarDateHandle\r\n                x={task.x1}\r\n                y={task.y}\r\n                width={task.handleWidth}\r\n                height={handleHeight}\r\n                type=\"left\"\r\n                onMouseDown={e => {\r\n                  onEventStart(\"start\", task, e);\r\n                }}\r\n              />\r\n              {/* right */}\r\n              <BarDateHandle\r\n                x={task.x2}\r\n                y={task.y}\r\n                width={task.handleWidth}\r\n                height={handleHeight}\r\n                type=\"right\"\r\n                onMouseDown={e => {\r\n                  onEventStart(\"end\", task, e);\r\n                }}\r\n              />\r\n            </g>\r\n          )}\r\n          {isProgressChangeable && !isLog && (\r\n            <BarProgressHandle\r\n              progressPoint={progressPoint}\r\n              onMouseDown={e => {\r\n                onEventStart(\"progress\", task, e);\r\n              }}\r\n            />\r\n          )}\r\n        </g>\r\n      </g>\r\n    </svg>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport {\r\n  progressWithByParams,\r\n  getProgressPoint,\r\n} from \"../../../helpers/bar-helper\";\r\nimport { BarDisplay } from \"./bar-display\";\r\nimport { BarProgressHandle } from \"./bar-progress-handle\";\r\nimport { TaskItemProps } from \"../task-item\";\r\nimport styles from \"./bar.module.css\";\r\n\r\nexport const BarSmall: React.FC<TaskItemProps> = ({\r\n  task,\r\n  isProgressChangeable,\r\n  isDateChangeable,\r\n  onEventStart,\r\n  isSelected,\r\n}) => {\r\n  const progressWidth = progressWithByParams(task.x1, task.x2, task.progress);\r\n  const progressPoint = getProgressPoint(\r\n    progressWidth + task.x1,\r\n    task.y,\r\n    task.height\r\n  );\r\n  return (\r\n    <g className={styles.barWrapper} tabIndex={0}>\r\n      <BarDisplay\r\n        x={task.x1}\r\n        y={task.y}\r\n        task={task}\r\n        width={task.x2 - task.x1}\r\n        height={task.height}\r\n        progressWidth={progressWidth}\r\n        barCornerRadius={task.barCornerRadius}\r\n        styles={task.styles}\r\n        isSelected={isSelected}\r\n        onMouseDown={e => {\r\n          isDateChangeable && onEventStart(\"move\", task, e);\r\n        }}\r\n        id={task.id}\r\n      />\r\n      <g className=\"handleGroup\">\r\n        {isProgressChangeable && (\r\n          <BarProgressHandle\r\n            progressPoint={progressPoint}\r\n            onMouseDown={e => {\r\n              onEventStart(\"progress\", task, e);\r\n            }}\r\n          />\r\n        )}\r\n      </g>\r\n    </g>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport style from \"./bar.module.css\";\r\nimport { BarTask } from \"../../../types/bar-task\";\r\nimport {\r\n  barBackgroundColorPivotalPath,\r\n  barBackgroundColorTimeError,\r\n} from \"../../../helpers/dicts\";\r\n\r\ntype BarDisplayProps = {\r\n  x: number;\r\n  y: number;\r\n  task: BarTask;\r\n  width: number;\r\n  height: number;\r\n  isSelected: boolean;\r\n  progressWidth: number;\r\n  barCornerRadius: number;\r\n  styles: {\r\n    backgroundColor: string;\r\n    backgroundSelectedColor: string;\r\n    progressColor: string;\r\n    progressSelectedColor: string;\r\n    opacity?: number;\r\n  };\r\n  onMouseDown: (event: React.MouseEvent<SVGPolygonElement, MouseEvent>) => void;\r\n  id: string;\r\n  isLog?: boolean | undefined;\r\n};\r\nexport const BarDisplay: React.FC<BarDisplayProps> = ({\r\n  x,\r\n  y,\r\n  task,\r\n  width,\r\n  height,\r\n  isSelected,\r\n  progressWidth,\r\n  barCornerRadius,\r\n  styles,\r\n  onMouseDown,\r\n  id,\r\n  isLog,\r\n}) => {\r\n  const getBarColor = () => {\r\n    return task?.isTimeErrorItem || task?.isOverdueItem\r\n      ? barBackgroundColorTimeError\r\n      : task?.isPivotalPathItem\r\n      ? barBackgroundColorPivotalPath\r\n      : isSelected\r\n      ? styles.backgroundSelectedColor\r\n      : styles.backgroundColor;\r\n  };\r\n  const triangleX = task.x2 - task.x1 > 15 ? 15 : 2;\r\n  const triangleY = 2;\r\n\r\n  const projectLeftTriangle = [\r\n    task.x1,\r\n    task.y + task.height - triangleY,\r\n    task.x1,\r\n    task.y + task.height + triangleY + 3,\r\n    task.x1 + triangleX,\r\n    task.y + task.height - triangleY,\r\n  ].join(\",\");\r\n  const projectRightTriangle = [\r\n    task.x2,\r\n    task.y + task.height - triangleY,\r\n    task.x2,\r\n    task.y + task.height + triangleY + 3,\r\n    task.x2 - triangleX,\r\n    task.y + task.height - triangleY,\r\n  ].join(\",\");\r\n\r\n  return (\r\n    <g onMouseDown={onMouseDown}>\r\n      <rect\r\n        id={id}\r\n        x={x}\r\n        width={width}\r\n        y={y}\r\n        height={height}\r\n        ry={barCornerRadius}\r\n        rx={barCornerRadius}\r\n        fill={getBarColor()}\r\n        className={style.barBackground}\r\n      />\r\n      <polygon points={projectLeftTriangle} fill={getBarColor()} />\r\n      <polygon points={projectRightTriangle} fill={getBarColor()} />\r\n      <rect\r\n        x={x + progressWidth}\r\n        width={width - progressWidth}\r\n        y={y}\r\n        height={height + 5}\r\n        style={{ opacity: isLog ? 0.8 : 0.4 }}\r\n        fill=\"#fff\"\r\n      />\r\n    </g>\r\n  );\r\n};\r\n","import React, { useEffect, useRef } from \"react\";\r\nimport {\r\n  progressWithByParams,\r\n  getProgressPoint,\r\n} from \"../../../helpers/bar-helper\";\r\nimport { BarDisplay } from \"./parent-bar-display\";\r\nimport { BarDateHandle } from \"./bar-date-handle\";\r\nimport { BarProgressHandle } from \"./bar-progress-handle\";\r\nimport { TaskItemProps } from \"../task-item\";\r\nimport styles from \"./bar.module.css\";\r\nimport { useHover, useAddPoint } from \"../hook\";\r\nexport const BarParent: React.FC<TaskItemProps> = ({\r\n  task,\r\n  isProgressChangeable,\r\n  isDateChangeable,\r\n  onEventStart,\r\n  isSelected,\r\n  jsPlumb,\r\n  isLog,\r\n  setPointInited,\r\n  ganttEvent = {\r\n    action: \"\",\r\n  },\r\n}) => {\r\n  const barRef = useRef<any>(null);\r\n  const { action } = ganttEvent;\r\n  const progressWidth = progressWithByParams(task.x1, task.x2, task.progress);\r\n  const progressPoint = getProgressPoint(\r\n    progressWidth + task.x1 + 1,\r\n    task.y + 5,\r\n    task.height\r\n  );\r\n  // 设置端点\r\n  const addPointFinished = useAddPoint(jsPlumb, task, barRef);\r\n  useEffect(() => {\r\n    if (addPointFinished) {\r\n      setPointInited?.(addPointFinished);\r\n    }\r\n  }, [addPointFinished, setPointInited]);\r\n  useEffect(() => {\r\n    if (jsPlumb) {\r\n      // 重绘元素，解决拖动时间块连接点跟随\r\n      jsPlumb.revalidate(task.id);\r\n    }\r\n  }, [jsPlumb, task]);\r\n  useEffect(() => {\r\n    return () => {\r\n      if (jsPlumb) {\r\n        jsPlumb.deleteEndpoint(task?.id + \"-Left\");\r\n        jsPlumb.deleteEndpoint(task?.id + \"-Right\");\r\n      }\r\n    };\r\n  }, [jsPlumb, task?.id]);\r\n  useHover(barRef, jsPlumb, task.id, action);\r\n  const handleHeight = task.height - 10;\r\n  return (\r\n    <g ref={barRef} className={styles.barWrapper} tabIndex={0}>\r\n      {!isLog && isDateChangeable && (\r\n        <g className=\"barHandle\">\r\n          <rect\r\n            x={task.x1 - 20}\r\n            y={task.y - 6}\r\n            width={task.x2 - task.x1 + 40}\r\n            height={task.height + 12}\r\n            className={`barHandle ${styles.barHandleBackground}`}\r\n            ry={task.barCornerRadius}\r\n            rx={task.barCornerRadius}\r\n          />\r\n        </g>\r\n      )}\r\n\r\n      <BarDisplay\r\n        id={isLog ? `${task.id}-log` : task.id}\r\n        isLog={isLog}\r\n        x={task.x1}\r\n        y={task.y}\r\n        task={task}\r\n        width={task.x2 - task.x1}\r\n        height={task.height}\r\n        progressWidth={progressWidth}\r\n        barCornerRadius={task.barCornerRadius}\r\n        styles={!isLog ? task.styles : { ...task.styles, opacity: 0.5 }}\r\n        isSelected={isSelected}\r\n        onMouseDown={e => {\r\n          isDateChangeable && !isLog && onEventStart(\"move\", task, e);\r\n        }}\r\n      />\r\n      <g className=\"handleGroup\">\r\n        {isDateChangeable && !isLog && (\r\n          <g>\r\n            {/* left */}\r\n            <BarDateHandle\r\n              x={task.x1}\r\n              y={task.y}\r\n              width={task.handleWidth}\r\n              height={handleHeight}\r\n              type=\"left\"\r\n              onMouseDown={e => {\r\n                onEventStart(\"start\", task, e);\r\n              }}\r\n            />\r\n            {/* right */}\r\n            <BarDateHandle\r\n              x={task.x2 - task.handleWidth}\r\n              y={task.y}\r\n              width={task.handleWidth}\r\n              height={handleHeight}\r\n              type=\"right\"\r\n              onMouseDown={e => {\r\n                onEventStart(\"end\", task, e);\r\n              }}\r\n            />\r\n          </g>\r\n        )}\r\n        {isProgressChangeable && !isLog && (\r\n          <BarProgressHandle\r\n            progressPoint={progressPoint}\r\n            onMouseDown={e => {\r\n              onEventStart(\"progress\", task, e);\r\n            }}\r\n          />\r\n        )}\r\n      </g>\r\n    </g>\r\n  );\r\n};\r\n","export const base64Milestone =\r\n  \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAATpJREFUeNqslUEOATEUQL9exDiARCJhRYRbIDE2HIONA4iVFYux5gISYmfnBizsrViO32qbwZj+tn7yTTqdeW865v9CHMdgk51mHNhcn+M/lOi2YIyHEDOPucccR1vYme4jCRC+xEMvZaqPkmXWvcwG3h4ATCOASk1PL3A+dBZ8wqv11/nOkC5htnAVVAlzgdtImCucKmE+cIqE+cJNElEHsohGrvBkrOYAx4MeFtQKwn/A1UqKZT0MGT59IMvfG64iISgxLPWz7C1ieb5xvQCsIz3cqFfE/wPx7nwkHD6bADzuYnjifUoIZFfs+0g+4ZiNt89UdkUnSRocebevQnORZMFTW4WNxAT/2ewoEgo8s11nSahw0pYpe8pCFRBP/p1T4DZ7spYkwggnC6QkkD2rxCvUtNmreAowAEKnBro8dl0wAAAAAElFTkSuQmCC\";\r\n","import React, { useEffect, useRef } from \"react\";\r\nimport { TaskItemProps } from \"../task-item\";\r\nimport styles from \"./milestone.module.css\";\r\nimport { useHover, useAddPoint } from \"../../task-item/hook\";\r\nimport { base64Milestone } from \"./utils\";\r\nexport const Milestone: React.FC<TaskItemProps> = ({\r\n  task,\r\n  isDateChangeable,\r\n  onEventStart,\r\n  // isSelected,\r\n  jsPlumb,\r\n  setPointInited,\r\n  ganttEvent = {\r\n    action: \"\",\r\n  },\r\n}) => {\r\n  const barRef = useRef<any>(null);\r\n  const { action } = ganttEvent;\r\n  // 设置端点\r\n  const addPointFinished = useAddPoint(jsPlumb, task, barRef, \"milestone\");\r\n  useEffect(() => {\r\n    if (addPointFinished) {\r\n      setPointInited?.(addPointFinished);\r\n    }\r\n  }, [addPointFinished, setPointInited]);\r\n  useHover(barRef, jsPlumb, task.id, action);\r\n  useEffect(() => {\r\n    if (jsPlumb) {\r\n      // 重绘元素，解决拖动时间块连接点跟随\r\n      jsPlumb.revalidate(task.id);\r\n    }\r\n  }, [jsPlumb, task]);\r\n  useEffect(() => {\r\n    return () => {\r\n      if (jsPlumb) {\r\n        jsPlumb.deleteEndpoint(task.id + \"-Left\");\r\n        jsPlumb.deleteEndpoint(task.id + \"-Right\");\r\n      }\r\n    };\r\n  }, [jsPlumb, task.id]);\r\n  // const points = useMemo(() => {\r\n  //   return `${task.x1},${task.y + 12.5} ${task.x1 + 12.5},${task.y - 12.5} ${\r\n  //     task.x1 + 25\r\n  //   },${task.y - 12.5} ${task.x1 + 25},${task.y + 12.5}`;\r\n  // }, [task]);\r\n  return (\r\n    <g ref={barRef} tabIndex={0} className={styles.milestoneWrapper}>\r\n      {/* TODO:里程碑的竖线由于层级显示有问题，暂时去掉 */}\r\n      {/* <line\r\n        x1={task.x1 + task.height / 2}\r\n        y1=\"0\"\r\n        x2={task.x1 + task.height / 2}\r\n        y2={task.y < Number(taskListHeight) ? taskListHeight : task.y}\r\n        style={{ stroke: \"#5B42FF\", strokeWidth: \".5\" }}\r\n      /> */}\r\n      <rect\r\n        id={task.id}\r\n        fill=\"transparent\"\r\n        x={task.x1}\r\n        width={task.height}\r\n        y={task.y}\r\n        height={task.height}\r\n        className={styles.milestoneBackground}\r\n        onMouseDown={e => {\r\n          isDateChangeable && onEventStart(\"move\", task, e);\r\n        }}\r\n      />\r\n      <image\r\n        href={base64Milestone}\r\n        x={task.x1 + task.height / 6}\r\n        y={task.y + task.height / 6}\r\n        width={(task.height * 2) / 3}\r\n        height={(task.height * 2) / 3}\r\n        onMouseDown={e => {\r\n          isDateChangeable && onEventStart(\"move\", task, e);\r\n        }}\r\n      />\r\n    </g>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport { progressWithByParams } from \"../../../helpers/bar-helper\";\r\nimport { TaskItemProps } from \"../task-item\";\r\nimport styles from \"./project.module.css\";\r\n\r\nexport const Project: React.FC<TaskItemProps> = ({ task, isSelected }) => {\r\n  const barColor = isSelected\r\n    ? task.styles.backgroundSelectedColor\r\n    : task.styles.backgroundColor;\r\n  const processColor = isSelected\r\n    ? task.styles.progressSelectedColor\r\n    : task.styles.progressColor;\r\n  const progressWidth = progressWithByParams(task.x1, task.x2, task.progress);\r\n  const projectWith = task.x2 - task.x1;\r\n\r\n  const projectLeftTriangle = [\r\n    task.x1,\r\n    task.y + task.height / 2 - 1,\r\n    task.x1,\r\n    task.y + task.height,\r\n    task.x1 + 15,\r\n    task.y + task.height / 2 - 1,\r\n  ].join(\",\");\r\n  const projectRightTriangle = [\r\n    task.x2,\r\n    task.y + task.height / 2 - 1,\r\n    task.x2,\r\n    task.y + task.height,\r\n    task.x2 - 15,\r\n    task.y + task.height / 2 - 1,\r\n  ].join(\",\");\r\n\r\n  return (\r\n    <g tabIndex={0} className={styles.projectWrapper}>\r\n      <rect\r\n        fill={barColor}\r\n        x={task.x1}\r\n        width={projectWith}\r\n        y={task.y}\r\n        height={task.height}\r\n        rx={task.barCornerRadius}\r\n        ry={task.barCornerRadius}\r\n        className={styles.projectBackground}\r\n      />\r\n      <rect\r\n        x={task.x1}\r\n        width={progressWidth}\r\n        y={task.y}\r\n        height={task.height}\r\n        ry={task.barCornerRadius}\r\n        rx={task.barCornerRadius}\r\n        fill={processColor}\r\n      />\r\n      <rect\r\n        fill={barColor}\r\n        x={task.x1}\r\n        width={projectWith}\r\n        y={task.y}\r\n        height={task.height / 2}\r\n        rx={task.barCornerRadius}\r\n        ry={task.barCornerRadius}\r\n        className={styles.projectTop}\r\n      />\r\n      <polygon\r\n        className={styles.projectTop}\r\n        points={projectLeftTriangle}\r\n        fill={barColor}\r\n      />\r\n      <polygon\r\n        className={styles.projectTop}\r\n        points={projectRightTriangle}\r\n        fill={barColor}\r\n      />\r\n    </g>\r\n  );\r\n};\r\n","import React, { useEffect, useState } from \"react\";\r\nimport { BarTask } from \"../../types/bar-task\";\r\nimport {\r\n  GanttContentMoveAction,\r\n  GanttEvent,\r\n} from \"../../types/gantt-task-actions\";\r\nimport { Bar } from \"./bar/bar\";\r\nimport { BarSmall } from \"./bar/bar-small\";\r\nimport { BarParent } from \"./bar/bar-parent\";\r\nimport { Milestone } from \"./milestone/milestone\";\r\nimport { Project } from \"./project/project\";\r\n\r\nexport type TaskItemProps = {\r\n  task: BarTask;\r\n  arrowIndent: number;\r\n  taskHeight: number;\r\n  isProgressChangeable: boolean;\r\n  isDateChangeable: boolean;\r\n  isDelete: boolean;\r\n  isSelected: boolean;\r\n  onEventStart: (\r\n    action: GanttContentMoveAction,\r\n    selectedTask: BarTask,\r\n    event?: React.MouseEvent | React.KeyboardEvent\r\n  ) => any;\r\n  jsPlumb?: any;\r\n  isLog?: boolean | undefined;\r\n  taskListHeight?: number;\r\n  setPointInited?: (value: boolean) => void;\r\n  isMoving?: boolean;\r\n  ganttEvent?: GanttEvent;\r\n};\r\n\r\nexport const TaskItem: React.FC<TaskItemProps> = props => {\r\n  const { task, isDelete, isSelected, onEventStart, jsPlumb } = props;\r\n  const [taskItem, setTaskItem] = useState<JSX.Element>(<div />);\r\n\r\n  useEffect(() => {\r\n    switch (task.typeInternal) {\r\n      case \"milestone\":\r\n        setTaskItem(<Milestone {...props} />);\r\n        break;\r\n      case \"project\":\r\n        setTaskItem(<Project {...props} />);\r\n        break;\r\n      case \"smalltask\":\r\n        setTaskItem(<BarSmall {...props} />);\r\n        break;\r\n      case \"parent\":\r\n        setTaskItem(<BarParent {...props} />);\r\n        break;\r\n      default:\r\n        setTaskItem(<Bar {...props} />);\r\n        break;\r\n    }\r\n  }, [task, isSelected, jsPlumb, props]);\r\n\r\n  return (\r\n    <g\r\n      onKeyDown={e => {\r\n        switch (e.key) {\r\n          case \"Delete\": {\r\n            if (isDelete) onEventStart(\"delete\", task, e);\r\n            break;\r\n          }\r\n        }\r\n        e.stopPropagation();\r\n      }}\r\n      onMouseEnter={e => {\r\n        onEventStart(\"mouseenter\", task, e);\r\n      }}\r\n      onMouseLeave={e => {\r\n        onEventStart(\"mouseleave\", task, e);\r\n      }}\r\n      onDoubleClick={e => {\r\n        onEventStart(\"dblclick\", task, e);\r\n      }}\r\n      onClick={e => {\r\n        onEventStart(\"click\", task, e);\r\n      }}\r\n      onFocus={() => {\r\n        onEventStart(\"select\", task);\r\n      }}\r\n    >\r\n      {taskItem}\r\n    </g>\r\n  );\r\n};\r\n","import React, { useEffect, useState } from \"react\";\r\nimport { BarTask } from \"../../types/bar-task\";\r\nimport { GanttContentMoveAction } from \"../../types/gantt-task-actions\";\r\nimport { Bar } from \"./bar/bar\";\r\nimport { BarSmall } from \"./bar/bar-small\";\r\nimport { BarParent } from \"./bar/bar-parent\";\r\nimport { Milestone } from \"./milestone/milestone\";\r\nimport { Project } from \"./project/project\";\r\n\r\nexport type TaskItemProps = {\r\n  task: BarTask;\r\n  arrowIndent: number;\r\n  taskHeight: number;\r\n  isProgressChangeable: boolean;\r\n  isDateChangeable: boolean;\r\n  isDelete: boolean;\r\n  isSelected: boolean;\r\n  onEventStart: (\r\n    action: GanttContentMoveAction,\r\n    selectedTask: BarTask,\r\n    event?: React.MouseEvent | React.KeyboardEvent\r\n  ) => any;\r\n  jsPlumb?: any;\r\n  isLog?: boolean | undefined;\r\n};\r\n\r\nexport const TaskItemLog: React.FC<TaskItemProps> = props => {\r\n  const { task, onEventStart, isSelected, jsPlumb } = {\r\n    ...props,\r\n  };\r\n\r\n  const [taskItem, setTaskItem] = useState<JSX.Element>(<div />);\r\n\r\n  useEffect(() => {\r\n    switch (task.typeInternal) {\r\n      case \"milestone\":\r\n        setTaskItem(<Milestone {...props} />);\r\n        break;\r\n      case \"project\":\r\n        setTaskItem(<Project {...props} />);\r\n        break;\r\n      case \"smalltask\":\r\n        setTaskItem(<BarSmall {...props} />);\r\n        break;\r\n      case \"parent\":\r\n        setTaskItem(<BarParent {...props} />);\r\n        break;\r\n      default:\r\n        setTaskItem(<Bar {...props} />);\r\n        break;\r\n    }\r\n  }, [task, isSelected, jsPlumb]);\r\n\r\n  return (\r\n    <g\r\n      onClick={e => {\r\n        onEventStart(\"click\", task, e);\r\n      }}\r\n    >\r\n      {taskItem}\r\n    </g>\r\n  );\r\n};\r\n","import React, {\r\n  useEffect,\r\n  useState,\r\n  useContext,\r\n  useCallback,\r\n  memo,\r\n} from \"react\";\r\nimport { EventOption, ConnectionProps } from \"../../types/public-types\";\r\nimport { BarTask } from \"../../types/bar-task\";\r\nimport { Arrow } from \"../other/arrow\";\r\nimport { handleTaskBySVGMouseEvent } from \"../../helpers/bar-helper\";\r\nimport { isKeyboardEvent } from \"../../helpers/other-helper\";\r\nimport {\r\n  errorLinkBorderColor,\r\n  pivotalPathLinkBorderColor,\r\n} from \"../../helpers/dicts\";\r\nimport { TaskItem } from \"../task-item/task-item\";\r\nimport { TaskItemLog } from \"../task-item/task-item-log\";\r\nimport { GanttConfigContext } from \"../../contsxt\";\r\nimport { filter, isEqual } from \"lodash\";\r\nimport {\r\n  offsetCalculators,\r\n  sizeCalculators,\r\n  relationReverse,\r\n  relationInit,\r\n} from \"../../helpers/jsPlumbConfig\";\r\nimport {\r\n  BarMoveAction,\r\n  GanttContentMoveAction,\r\n  GanttEvent,\r\n} from \"../../types/gantt-task-actions\";\r\nimport { message } from \"antd\";\r\n\r\nexport type TaskGanttContentProps = {\r\n  tasks: BarTask[];\r\n  logTasks: BarTask[];\r\n  dates: Date[];\r\n  ganttEvent: GanttEvent;\r\n  selectedTask: BarTask | undefined;\r\n  rowHeight: number;\r\n  columnWidth: number;\r\n  timeStep: number;\r\n  svg?: React.RefObject<SVGSVGElement>;\r\n  svgWidth: number;\r\n  taskHeight: number;\r\n  arrowColor: string;\r\n  arrowIndent: number;\r\n  fontSize: string;\r\n  fontFamily: string;\r\n  setGanttEvent: (value: GanttEvent) => void;\r\n  setFailedTask: (value: BarTask | null) => void;\r\n  setSelectedTask: (taskId: string) => void;\r\n  taskListHeight?: number;\r\n  clickBaselineItem?: (offsetX: number, currentLogItem: BarTask) => void;\r\n  isConnect?: boolean;\r\n  containerRef?: React.MutableRefObject<any>;\r\n} & EventOption &\r\n  ConnectionProps;\r\n\r\nexport const TaskGanttContent: React.FC<TaskGanttContentProps> = memo(\r\n  ({\r\n    tasks,\r\n    logTasks,\r\n    dates,\r\n    ganttEvent,\r\n    selectedTask,\r\n    rowHeight,\r\n    columnWidth,\r\n    timeStep,\r\n    svg,\r\n    taskHeight,\r\n    arrowColor,\r\n    arrowIndent,\r\n    fontFamily,\r\n    fontSize,\r\n    setGanttEvent,\r\n    setFailedTask,\r\n    setSelectedTask,\r\n    onDateChange,\r\n    onProgressChange,\r\n    onDoubleClick,\r\n    onDelete,\r\n    addConnection,\r\n    itemLinks,\r\n    taskListHeight,\r\n    clickBaselineItem,\r\n    isConnect,\r\n    setCurrentConnection,\r\n    currentConnection,\r\n    containerRef,\r\n  }) => {\r\n    const [connectUuids, setConnectUuids] = useState([]);\r\n    const point = svg?.current?.createSVGPoint();\r\n    const [xStep, setXStep] = useState(0);\r\n    const [initEventX1Delta, setInitEventX1Delta] = useState(0);\r\n    // 是否正在拖动时间bar\r\n    const [isMoving, setIsMoving] = useState(false);\r\n    // 是否正在连线\r\n    const [jsPlumbInstance, setJsPlumbInstance] = useState<any>(null);\r\n    const { ganttConfig } = useContext(GanttConfigContext);\r\n    const [pointInited, setPointInited] = useState(false);\r\n\r\n    useEffect(() => {\r\n      const connectClickHandle = () => {\r\n        if (currentConnection) {\r\n          currentConnection?.connection?.removeClass(\"select-connection\");\r\n          setCurrentConnection?.(null);\r\n        }\r\n      };\r\n      const container = containerRef?.current;\r\n      container?.addEventListener(\"click\", connectClickHandle, true);\r\n      return () => {\r\n        container?.removeEventListener(\"click\", connectClickHandle, true);\r\n      };\r\n    }, [containerRef, setCurrentConnection, currentConnection]);\r\n    useEffect(() => {\r\n      if (!currentConnection && jsPlumbInstance) {\r\n        const connections = jsPlumbInstance.getConnections();\r\n        connections.forEach((ele: any) => {\r\n          ele.removeClass(\"select-connection\");\r\n        });\r\n      }\r\n    }, [currentConnection, jsPlumbInstance]);\r\n    useEffect(() => {\r\n      const dateDelta =\r\n        dates[1].getTime() -\r\n        dates[0].getTime() -\r\n        dates[1].getTimezoneOffset() * 60 * 1000 +\r\n        dates[0].getTimezoneOffset() * 60 * 1000;\r\n      const newXStep = (timeStep * columnWidth) / dateDelta;\r\n      setXStep(newXStep);\r\n    }, [columnWidth, dates, timeStep]);\r\n\r\n    useEffect(() => {\r\n      const handleMouseMove = async (event: MouseEvent) => {\r\n        if (!ganttEvent.changedTask || !point || !svg?.current) return;\r\n        event.preventDefault();\r\n\r\n        point.x = event.clientX;\r\n        const cursor = point.matrixTransform(\r\n          svg?.current.getScreenCTM()?.inverse()\r\n        );\r\n\r\n        const { isChanged, changedTask } = handleTaskBySVGMouseEvent(\r\n          cursor.x,\r\n          ganttEvent.action as BarMoveAction,\r\n          ganttEvent.changedTask,\r\n          xStep,\r\n          timeStep,\r\n          initEventX1Delta\r\n        );\r\n        if (isChanged) {\r\n          setGanttEvent({ action: ganttEvent.action, changedTask });\r\n        }\r\n      };\r\n\r\n      const handleMouseUp = async (event: MouseEvent) => {\r\n        const { action, originalSelectedTask, changedTask } = ganttEvent;\r\n        if (!changedTask || !point || !svg?.current || !originalSelectedTask)\r\n          return;\r\n        event.preventDefault();\r\n\r\n        point.x = event.clientX;\r\n        const cursor = point.matrixTransform(\r\n          svg?.current.getScreenCTM()?.inverse()\r\n        );\r\n        const { changedTask: newChangedTask } = handleTaskBySVGMouseEvent(\r\n          cursor.x,\r\n          action as BarMoveAction,\r\n          changedTask,\r\n          xStep,\r\n          timeStep,\r\n          initEventX1Delta\r\n        );\r\n\r\n        const isNotLikeOriginal =\r\n          originalSelectedTask.start !== newChangedTask.start ||\r\n          originalSelectedTask.end !== newChangedTask.end ||\r\n          originalSelectedTask.progress !== newChangedTask.progress;\r\n\r\n        // remove listeners\r\n        svg.current.removeEventListener(\"mousemove\", handleMouseMove);\r\n        svg.current.removeEventListener(\"mouseup\", handleMouseUp);\r\n        setGanttEvent({ action: \"\" });\r\n        setIsMoving(false);\r\n\r\n        // custom operation start\r\n        let operationSuccess = true;\r\n        if (\r\n          (action === \"move\" || action === \"end\" || action === \"start\") &&\r\n          onDateChange &&\r\n          isNotLikeOriginal\r\n        ) {\r\n          try {\r\n            const result = await onDateChange(newChangedTask);\r\n            if (result !== undefined) {\r\n              operationSuccess = result;\r\n            }\r\n          } catch (error) {\r\n            operationSuccess = false;\r\n          }\r\n        } else if (onProgressChange && isNotLikeOriginal) {\r\n          try {\r\n            const result = await onProgressChange(newChangedTask);\r\n            if (result !== undefined) {\r\n              operationSuccess = result;\r\n            }\r\n          } catch (error) {\r\n            operationSuccess = false;\r\n          }\r\n        }\r\n\r\n        // If operation is failed - return old state\r\n        if (!operationSuccess) {\r\n          setFailedTask(originalSelectedTask);\r\n        }\r\n      };\r\n\r\n      if (\r\n        !isMoving &&\r\n        [\"move\", \"end\", \"start\", \"progress\"].includes(ganttEvent.action) &&\r\n        svg?.current\r\n      ) {\r\n        svg.current.addEventListener(\"mousemove\", handleMouseMove);\r\n        svg.current.addEventListener(\"mouseup\", handleMouseUp);\r\n        setIsMoving(true);\r\n      }\r\n    }, [\r\n      ganttEvent,\r\n      xStep,\r\n      initEventX1Delta,\r\n      onProgressChange,\r\n      timeStep,\r\n      onDateChange,\r\n      svg,\r\n      isMoving,\r\n      point,\r\n      setFailedTask,\r\n      setGanttEvent,\r\n    ]);\r\n\r\n    /**\r\n     * Method is Start point of task change\r\n     */\r\n    const handleBarEventStart = useCallback(\r\n      async (\r\n        action: GanttContentMoveAction,\r\n        task: BarTask,\r\n        event?: React.MouseEvent | React.KeyboardEvent\r\n      ) => {\r\n        if (!event) {\r\n          if (action === \"select\") {\r\n            setSelectedTask(task.id);\r\n          }\r\n        }\r\n        // Keyboard events\r\n        else if (isKeyboardEvent(event)) {\r\n          if (action === \"delete\") {\r\n            if (onDelete) {\r\n              try {\r\n                const result = await onDelete(task);\r\n                if (result !== undefined && result) {\r\n                  setGanttEvent({ action, changedTask: task });\r\n                }\r\n              } catch (error) {\r\n                console.error(\"Error on Delete. \" + error);\r\n              }\r\n            }\r\n          }\r\n        }\r\n        // Mouse Events\r\n        else if (action === \"mouseenter\") {\r\n          if (!ganttEvent.action) {\r\n            setGanttEvent({\r\n              action,\r\n              changedTask: task,\r\n              originalSelectedTask: task,\r\n            });\r\n          }\r\n        } else if (action === \"mouseleave\") {\r\n          setGanttEvent({ action: \"\" });\r\n        } else if (action === \"dblclick\") {\r\n          !!onDoubleClick && onDoubleClick(task);\r\n        } else if (action === \"click\") {\r\n          const offsetX = event?.nativeEvent?.offsetX;\r\n          // 当前基线时间块对应的item\r\n          const currentLogItem = tasks.filter(\r\n            (ele: BarTask) => ele.id === task.id\r\n          );\r\n          // item的开始时间和结束时间为空时，点击基线时间块可以添加时间\r\n          if (!(currentLogItem?.[0]?.end && currentLogItem?.[0]?.start)) {\r\n            clickBaselineItem?.(offsetX, currentLogItem[0]);\r\n          }\r\n          setGanttEvent({ action, changedTask: task });\r\n        }\r\n        // Change task event start\r\n        else if (action === \"move\") {\r\n          if (!svg?.current || !point) return;\r\n          point.x = event.clientX;\r\n          const cursor = point.matrixTransform(\r\n            svg.current.getScreenCTM()?.inverse()\r\n          );\r\n          setInitEventX1Delta(cursor.x - task.x1);\r\n          setGanttEvent({\r\n            action,\r\n            changedTask: task,\r\n            originalSelectedTask: task,\r\n          });\r\n        } else {\r\n          setGanttEvent({\r\n            action,\r\n            changedTask: task,\r\n            originalSelectedTask: task,\r\n          });\r\n        }\r\n      },\r\n      [\r\n        ganttEvent.action,\r\n        onDelete,\r\n        onDoubleClick,\r\n        point,\r\n        setGanttEvent,\r\n        setSelectedTask,\r\n        svg,\r\n        clickBaselineItem,\r\n        tasks,\r\n      ]\r\n    );\r\n    const getLinkTypeId = useCallback(\r\n      (start: string, end: string) => {\r\n        const linkType = relationReverse(start, end);\r\n        return ganttConfig.relation[linkType];\r\n      },\r\n      [ganttConfig.relation]\r\n    );\r\n\r\n    const getHasLinkItems = useCallback(task => {\r\n      // 获取与当前事项有关联关系的事项列表\r\n      const hasLinkItems = task?.link || {};\r\n      let needUpdateItems: string[] = [];\r\n      Object.keys(hasLinkItems).map(type => {\r\n        if (hasLinkItems[type]) {\r\n          Object.keys(hasLinkItems[type]).map(linkType => {\r\n            if (hasLinkItems[type][linkType]) {\r\n              needUpdateItems = needUpdateItems.concat(\r\n                hasLinkItems[type][linkType]\r\n              );\r\n            }\r\n          });\r\n        }\r\n      });\r\n      return needUpdateItems;\r\n    }, []);\r\n\r\n    const checkIsPivotalPathLink = useCallback(\r\n      (task, target, tasks, relationType) => {\r\n        const targetPivotalPathItem = tasks.filter(\r\n          (ele: BarTask) => ele.id === target && ele?.isPivotalPathItem\r\n        );\r\n        if (\r\n          task?.isPivotalPathItem &&\r\n          targetPivotalPathItem?.length &&\r\n          relationType === \"FS\"\r\n        ) {\r\n          return true;\r\n        }\r\n        return false;\r\n      },\r\n      []\r\n    );\r\n\r\n    const checkIsErrorLink = useCallback(\r\n      (task, target) => {\r\n        // 获取与当前事项有关联关系的事项列表\r\n        const needUpdateItems = getHasLinkItems(task);\r\n        // 获取当前事项的子代事项\r\n        const subItems: string[] = task?.item?.subItem || [];\r\n\r\n        let flag = false;\r\n        // 关联关系为目标节点的事项\r\n        const targetItems = needUpdateItems.filter(id => id === target);\r\n        if (targetItems?.length > 1) {\r\n          flag = true;\r\n          return flag;\r\n        }\r\n        // 父子存在关联关系\r\n        if ((task?.item?.ancestors || []).includes(target)) {\r\n          flag = true;\r\n          return flag;\r\n        }\r\n        subItems.forEach(item => {\r\n          if (needUpdateItems.includes(item)) {\r\n            flag = true;\r\n          }\r\n        });\r\n        return flag;\r\n      },\r\n      [getHasLinkItems]\r\n    );\r\n    useEffect(() => {\r\n      if (isConnect) {\r\n        import(\"jsplumb\").then(({ jsPlumb }: any) => {\r\n          jsPlumb.ready(() => {\r\n            const instance = jsPlumb.getInstance();\r\n            instance.fire(\"jsPlumbDemoLoaded\", instance);\r\n            setJsPlumbInstance(instance);\r\n          });\r\n        });\r\n      }\r\n    }, [isConnect]);\r\n    useEffect(() => {\r\n      if (jsPlumbInstance) {\r\n        const originalOffset = jsPlumbInstance.getOffset;\r\n        const originalSize = jsPlumbInstance.getSize;\r\n        jsPlumbInstance.getOffset = function (el: any) {\r\n          const tn = el.tagName.toUpperCase();\r\n          if (offsetCalculators[tn]) {\r\n            return offsetCalculators[tn](el);\r\n          } else return originalOffset.apply(this, [el]);\r\n        };\r\n        jsPlumbInstance.getSize = function (el: any) {\r\n          const tn = el.tagName.toUpperCase();\r\n          if (sizeCalculators[tn]) {\r\n            return sizeCalculators[tn](el);\r\n          } else return originalSize.apply(this, [el]);\r\n        };\r\n        jsPlumbInstance.setContainer(\"horizontalContainer\");\r\n        // 连线前校验\r\n        jsPlumbInstance.bind(\"beforeDrop\", (conn: any) => {\r\n          const taskSource = filter(tasks, { id: conn.sourceId })[0];\r\n          const taskTarget = filter(tasks, { id: conn.targetId })[0];\r\n          if (!ganttConfig.relation) {\r\n            message.warning(\"未配置关联关系\");\r\n            return;\r\n          }\r\n          if (conn.targetId === conn.sourceId) {\r\n            message.warning(\"连线有误\");\r\n            return;\r\n          }\r\n          // 父卡片和子卡片不能相互连接，其他类型待定\r\n          if (\r\n            (taskSource?.item?.subItem || []).includes(taskTarget?.id) ||\r\n            (taskTarget?.item?.subItem || []).includes(taskSource?.id)\r\n          ) {\r\n            message.warning(\"父子卡片之间不能存在关联关系\");\r\n            return;\r\n          }\r\n          // 两个卡片只能存在一种关联关系\r\n          const linkTypeId = getLinkTypeId(\r\n            conn.connection.endpoints[0].anchor.cssClass,\r\n            conn.dropEndpoint.anchor.cssClass\r\n          );\r\n          const currentLink = itemLinks?.filter((ele: any) => {\r\n            return (\r\n              ele.source?.objectId === conn?.sourceId &&\r\n              ele.destination?.objectId === conn?.targetId &&\r\n              ele.linkType?.objectId === linkTypeId\r\n            );\r\n          });\r\n          if (currentLink?.length) {\r\n            message.warning(\"连线有误\");\r\n            return false;\r\n          }\r\n          let sourceTask: BarTask | undefined;\r\n          let desinationTask: BarTask | undefined;\r\n          tasks.map(task => {\r\n            if (task.id === conn.sourceId) {\r\n              sourceTask = task;\r\n            }\r\n            if (task.id === conn.sourceId) {\r\n              desinationTask = task;\r\n            }\r\n          });\r\n          const hasLinkItems = getHasLinkItems(sourceTask);\r\n          // 两个事项有多条关联关系\r\n          if (hasLinkItems.includes(conn.targetId)) {\r\n            message.warning(\"连线有误\");\r\n            return false;\r\n          }\r\n          if (\r\n            desinationTask?.item?.subItem.includes(conn.sourceId) ||\r\n            sourceTask?.item?.subItem.includes(conn.targetId)\r\n          ) {\r\n            message.warning(\"连线有误\");\r\n            return false;\r\n          }\r\n          return true;\r\n        });\r\n        jsPlumbInstance.bind(\"connection\", (infor: any, originalEvent: any) => {\r\n          const linkTypeId = getLinkTypeId(\r\n            infor.connection.endpoints[0].anchor.cssClass,\r\n            infor.connection.endpoints[1].anchor.cssClass\r\n          );\r\n          const params = {\r\n            source: infor?.sourceId,\r\n            destination: infor?.targetId,\r\n            linkType: linkTypeId,\r\n          };\r\n          // init(infor.connection);\r\n          if (originalEvent) {\r\n            infor.connection.setData(linkTypeId);\r\n            addConnection?.(params);\r\n          }\r\n        });\r\n        jsPlumbInstance.bind(\"click\", (connection: any, originalEvent: any) => {\r\n          jsPlumbInstance.select().removeClass(\"select-connection\");\r\n          connection.addClass(\"select-connection\");\r\n          setCurrentConnection?.({\r\n            originalEvent: originalEvent,\r\n            connection: connection,\r\n          });\r\n        });\r\n      }\r\n      return () => {\r\n        if (jsPlumbInstance) {\r\n          jsPlumbInstance.unbind(\"beforeDrop\");\r\n          jsPlumbInstance.unbind(\"connection\");\r\n          jsPlumbInstance.unbind(\"click\");\r\n        }\r\n      };\r\n    }, [\r\n      jsPlumbInstance,\r\n      itemLinks,\r\n      tasks,\r\n      getHasLinkItems,\r\n      addConnection,\r\n      ganttConfig.relation,\r\n      getLinkTypeId,\r\n      setCurrentConnection,\r\n    ]);\r\n    useEffect(() => {\r\n      if (!itemLinks?.length) {\r\n        if (!isEqual(connectUuids, [])) {\r\n          setConnectUuids([]);\r\n        }\r\n      }\r\n\r\n      if (itemLinks?.length && tasks.length && jsPlumbInstance) {\r\n        const newConnectUuids: any = [];\r\n        tasks.forEach((task: any) => {\r\n          // 找到需要连线的卡片\r\n          const itemFilter = itemLinks?.filter((ele: any) => {\r\n            return ele.source?.objectId === task?.id;\r\n          });\r\n          itemFilter.forEach((ele: any) => {\r\n            let relationType = \"\";\r\n            for (const key in ganttConfig.relation) {\r\n              if (ganttConfig.relation[key] === ele.linkType?.objectId) {\r\n                relationType = key;\r\n                continue;\r\n              }\r\n            }\r\n            const isErrorLink = checkIsErrorLink(\r\n              task,\r\n              ele.destination?.objectId\r\n            );\r\n            const isPivotalPathLink = checkIsPivotalPathLink(\r\n              task,\r\n              ele.destination?.objectId,\r\n              tasks,\r\n              relationType\r\n            );\r\n            newConnectUuids.push({\r\n              source: ele.source?.objectId,\r\n              destination: ele.destination?.objectId,\r\n              relationType: relationType,\r\n              isErrorLink: isErrorLink,\r\n              isPivotalPathLink: isPivotalPathLink,\r\n            });\r\n          });\r\n        });\r\n        if (!isEqual(connectUuids, newConnectUuids)) {\r\n          setConnectUuids(newConnectUuids);\r\n        }\r\n      }\r\n    }, [\r\n      jsPlumbInstance,\r\n      itemLinks,\r\n      tasks,\r\n      connectUuids,\r\n      checkIsErrorLink,\r\n      checkIsPivotalPathLink,\r\n      ganttConfig.relation,\r\n      ganttConfig,\r\n    ]);\r\n    useEffect(() => {\r\n      // pointInited是连接点初始化完成的标志，解决jsPlumbInstance.connect连线时，由于连接点未初始化完成导致连线加载不出来\r\n      if (jsPlumbInstance && connectUuids.length && pointInited) {\r\n        jsPlumbInstance.setSuspendDrawing(true);\r\n        for (let i = 0; i < connectUuids.length; i++) {\r\n          const uuidObj = connectUuids[i];\r\n          const {\r\n            source,\r\n            destination,\r\n            relationType,\r\n            isErrorLink,\r\n            isPivotalPathLink,\r\n          } = uuidObj;\r\n          if (source && destination && relationType) {\r\n            const uuid = [\r\n              `${source}-${relationInit[relationType]?.[0]}`,\r\n              `${destination}-${relationInit[relationType]?.[1]}`,\r\n            ];\r\n            const connect = jsPlumbInstance.connect({\r\n              uuids: uuid,\r\n            });\r\n            // 给连线设置linkType\r\n            if (connect) {\r\n              if (isErrorLink) {\r\n                // 设置连线错误的颜色\r\n                connect.setPaintStyle({\r\n                  stroke: errorLinkBorderColor,\r\n                });\r\n              }\r\n              if (isPivotalPathLink) {\r\n                // 设置关键路径连线的颜色\r\n                connect.setPaintStyle({\r\n                  stroke: pivotalPathLinkBorderColor,\r\n                });\r\n              }\r\n              connect.setData(ganttConfig?.relation?.[relationType]);\r\n            }\r\n          }\r\n        }\r\n        jsPlumbInstance.setSuspendDrawing(false, true);\r\n      }\r\n\r\n      return () => {\r\n        if (jsPlumbInstance) {\r\n          jsPlumbInstance.deleteEveryConnection();\r\n        }\r\n      };\r\n    }, [jsPlumbInstance, ganttConfig?.relation, connectUuids, pointInited]);\r\n    return (\r\n      <g className=\"content\">\r\n        <g className=\"arrows\" fill={arrowColor} stroke={arrowColor}>\r\n          {tasks.map(task => {\r\n            return task.barChildren.map(child => {\r\n              return (\r\n                <Arrow\r\n                  key={`Arrow from ${task.id} to ${tasks[child].id}`}\r\n                  taskFrom={task}\r\n                  taskTo={tasks[child]}\r\n                  rowHeight={rowHeight}\r\n                  taskHeight={taskHeight}\r\n                  arrowIndent={arrowIndent}\r\n                />\r\n              );\r\n            });\r\n          })}\r\n        </g>\r\n        <g className=\"bar\" fontFamily={fontFamily} fontSize={fontSize}>\r\n          {tasks.map(task => {\r\n            const cuttentLog = logTasks.find(ele => ele.id === task.id);\r\n            if (cuttentLog) {\r\n              cuttentLog.y = task.y;\r\n            }\r\n            return (\r\n              <g key={`g-${task.id}`}>\r\n                {!cuttentLog?.start || !cuttentLog?.end ? null : (\r\n                  <TaskItemLog\r\n                    task={cuttentLog}\r\n                    arrowIndent={arrowIndent}\r\n                    taskHeight={taskHeight}\r\n                    isProgressChangeable={\r\n                      !!onProgressChange && !task.isDisabled\r\n                    }\r\n                    isDateChangeable={!!onDateChange && !task.isDisabled}\r\n                    isDelete={!task.isDisabled}\r\n                    onEventStart={handleBarEventStart}\r\n                    key={`${task.id}-log`}\r\n                    isSelected={!!selectedTask && task.id === selectedTask.id}\r\n                    isLog\r\n                  />\r\n                )}\r\n                {!task.start || !task.end ? null : (\r\n                  <TaskItem\r\n                    jsPlumb={jsPlumbInstance}\r\n                    task={task}\r\n                    arrowIndent={arrowIndent}\r\n                    taskHeight={taskHeight}\r\n                    isProgressChangeable={\r\n                      !!onProgressChange && !task.isDisabled\r\n                    }\r\n                    isDateChangeable={!!onDateChange && !task.isDisabled}\r\n                    isDelete={!task.isDisabled}\r\n                    onEventStart={handleBarEventStart}\r\n                    key={task.id}\r\n                    isSelected={!!selectedTask && task.id === selectedTask.id}\r\n                    taskListHeight={taskListHeight}\r\n                    setPointInited={setPointInited}\r\n                    isMoving={isMoving}\r\n                    ganttEvent={ganttEvent}\r\n                  />\r\n                )}\r\n              </g>\r\n            );\r\n          })}\r\n        </g>\r\n      </g>\r\n    );\r\n  }\r\n);\r\n","import React, {\r\n  useRef,\r\n  forwardRef,\r\n  useImperativeHandle,\r\n  SyntheticEvent,\r\n  useContext,\r\n  memo,\r\n} from \"react\";\r\nimport { GridProps, Grid } from \"../grid/grid\";\r\nimport { CalendarProps, Calendar } from \"../calendar/calendar\";\r\nimport { TaskGanttContentProps, TaskGanttContent } from \"./task-gantt-content\";\r\nimport { TaskGanttArrows } from \"./task-gantt-arrows\";\r\nimport { scrollBarHeight, daySeconds } from \"../../helpers/dicts\";\r\nimport { ViewMode } from \"../../types/public-types\";\r\nimport { GanttConfigContext } from \"../../contsxt\";\r\nimport { BarTask } from \"../../types/bar-task\";\r\nimport dayjs from \"dayjs\";\r\n\r\nimport styles from \"./gantt.module.css\";\r\n\r\nexport type TaskGanttProps = {\r\n  gridProps: GridProps;\r\n  calendarProps: CalendarProps;\r\n  barProps: TaskGanttContentProps;\r\n  ganttHeight: number;\r\n  scrollX: number;\r\n  onScroll: (event: SyntheticEvent<HTMLDivElement>) => void;\r\n  taskListHieght?: number;\r\n  listBottomHeight?: number;\r\n  taskListHeight?: number;\r\n  headerHeight: number;\r\n  // onMouseMove: (event: React.MouseEvent<HTMLDivElement>) => void;\r\n};\r\nconst TaskGanttComponent: React.ForwardRefRenderFunction<\r\n  any,\r\n  TaskGanttProps\r\n> = (\r\n  {\r\n    gridProps,\r\n    calendarProps,\r\n    barProps,\r\n    scrollX,\r\n    onScroll,\r\n    taskListHeight,\r\n    listBottomHeight,\r\n    headerHeight,\r\n  },\r\n\r\n  ref\r\n) => {\r\n  const { dates, onDateChange, columnWidth } = gridProps;\r\n  const { viewMode } = calendarProps;\r\n  const { ganttConfig } = useContext(GanttConfigContext);\r\n  const ganttSVGRef = useRef<SVGSVGElement>(null);\r\n  const horizontalContainerRef = useRef<HTMLDivElement>(null);\r\n  const verticalGanttContainerRef = useRef<HTMLDivElement>(null);\r\n  const newBarProps = { ...barProps, svg: ganttSVGRef };\r\n  useImperativeHandle(ref, () => ({\r\n    horizontalContainerRef: horizontalContainerRef.current,\r\n    verticalGanttContainerRef: verticalGanttContainerRef.current,\r\n  }));\r\n  const clickBaselineItem = (offsetX: number, currentLogItem: BarTask) => {\r\n    let startDate, endDate;\r\n    if (viewMode === ViewMode.Day) {\r\n      startDate = dayjs(\r\n        dates[0].valueOf() + (offsetX / columnWidth) * daySeconds\r\n      );\r\n      endDate = dayjs(\r\n        dates[0].valueOf() + (offsetX / columnWidth) * daySeconds + daySeconds\r\n      );\r\n      onDateChange?.(\r\n        Object.assign(currentLogItem, {\r\n          start: ganttConfig?.time?.length\r\n            ? startDate?.startOf(\"day\").toDate()\r\n            : null,\r\n          end: ganttConfig?.time?.length\r\n            ? endDate?.startOf(\"day\").toDate()\r\n            : null,\r\n        })\r\n      );\r\n    }\r\n  };\r\n  return (\r\n    <div\r\n      className={styles.ganttVerticalContainer}\r\n      ref={verticalGanttContainerRef}\r\n      onScroll={onScroll}\r\n      style={{\r\n        marginBottom: `${listBottomHeight}px`,\r\n      }}\r\n    >\r\n      <div style={{ height: `${headerHeight}px` }}>\r\n        <svg\r\n          xmlns=\"http://www.w3.org/2000/svg\"\r\n          width={gridProps.svgWidth}\r\n          height={calendarProps.headerHeight}\r\n          fontFamily={barProps.fontFamily}\r\n        >\r\n          <Calendar {...calendarProps} />\r\n        </svg>\r\n      </div>\r\n      <div\r\n        id=\"horizontalContainer\"\r\n        ref={horizontalContainerRef}\r\n        className={styles.horizontalContainer}\r\n        style={{ width: gridProps.svgWidth }}\r\n      >\r\n        <svg\r\n          xmlns=\"http://www.w3.org/2000/svg\"\r\n          width={gridProps.svgWidth}\r\n          height={\r\n            barProps.rowHeight * barProps.tasks.length < Number(taskListHeight)\r\n              ? taskListHeight\r\n              : barProps.rowHeight * barProps.tasks.length + scrollBarHeight\r\n          }\r\n          fontFamily={barProps.fontFamily}\r\n          ref={ganttSVGRef}\r\n          style={{ position: \"relative\" }}\r\n        >\r\n          <Grid\r\n            {...gridProps}\r\n            viewMode={calendarProps.viewMode}\r\n            scrollX={scrollX}\r\n            taskListHeight={taskListHeight}\r\n          />\r\n          <TaskGanttContent\r\n            {...newBarProps}\r\n            taskListHeight={taskListHeight}\r\n            clickBaselineItem={clickBaselineItem}\r\n            containerRef={horizontalContainerRef}\r\n          />\r\n        </svg>\r\n\r\n        {false && (\r\n          <div className={styles.contextContainer}>\r\n            {newBarProps.tasks.map(task => {\r\n              if (!task.start || !task.end) {\r\n                return null;\r\n              }\r\n              return (\r\n                <TaskGanttArrows key={task.id} {...newBarProps} task={task} />\r\n              );\r\n            })}\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport const TaskGantt = memo(forwardRef(TaskGanttComponent));\r\n","import React, { SyntheticEvent, forwardRef, memo } from \"react\";\r\nimport styles from \"./horizontal-scroll.module.css\";\r\n\r\nexport const HorizontalScrollComponent: React.ForwardRefRenderFunction<\r\n  any,\r\n  {\r\n    svgWidth: number;\r\n    taskListWidth: number;\r\n    listBottomHeight: number;\r\n    onScroll: (event: SyntheticEvent<HTMLDivElement>) => void;\r\n  }\r\n> = ({ svgWidth, taskListWidth, onScroll, listBottomHeight }, ref) => {\r\n  const dividerWidth = 15;\r\n\r\n  return (\r\n    <div\r\n      style={{\r\n        marginLeft: taskListWidth + dividerWidth,\r\n        width: `calc(100% - ${taskListWidth}px)`,\r\n        bottom: `${listBottomHeight}px`,\r\n      }}\r\n      className={styles.scroll}\r\n      onScroll={onScroll}\r\n      ref={ref}\r\n    >\r\n      <div style={{ width: svgWidth, height: 1 }} />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport const HorizontalScroll = memo(forwardRef(HorizontalScrollComponent));\r\n","import React, { useEffect, useContext, useState } from \"react\";\r\nimport { Modal, Form, Select } from \"antd\";\r\nimport { ConfigHandleContext } from \"../../contsxt\";\r\nimport { TimeItemProps, FieldAndItemProps } from \"../../types/public-types\";\r\nimport styles from \"./index.module.css\";\r\nimport { find, omit } from \"lodash\";\r\nimport { OptionData, OptionGroupData } from \"rc-select/lib/interface\";\r\nconst { Option } = Select;\r\n\r\nconst filterOption = (\r\n  input: string,\r\n  option: OptionData | OptionGroupData | undefined\r\n): boolean => {\r\n  return option?.name?.toLowerCase().indexOf(input?.toLowerCase()) > -1;\r\n};\r\n// 筛选某一类型的字段\r\nexport const filterFields = (\r\n  type: string,\r\n  customField: FieldAndItemProps[]\r\n) => {\r\n  return customField.filter((ele: FieldAndItemProps) => {\r\n    return ele?.fieldType?.key === type;\r\n  });\r\n};\r\n// 过滤不存在的字段\r\nexport const filterDeleteFields = (\r\n  id: string | undefined,\r\n  customField: FieldAndItemProps[]\r\n) => {\r\n  const filterData = find(customField, { objectId: id });\r\n  return filterData ? filterData.objectId : null;\r\n};\r\ninterface ItemModalProps {\r\n  visible: boolean;\r\n  handleCancel: () => void;\r\n  handleOk: (values: TimeItemProps) => void;\r\n  currentItem: TimeItemProps;\r\n  timeList?: TimeItemProps[];\r\n}\r\nconst ItemModal: React.FC<ItemModalProps> = ({\r\n  visible,\r\n  handleCancel,\r\n  handleOk,\r\n  currentItem,\r\n  timeList,\r\n}) => {\r\n  const [form] = Form.useForm();\r\n  const { itemTypeData, getCustomFields } = useContext(ConfigHandleContext);\r\n  // 设置isSelected变量，避免切换事项类型变化时引起form.setFieldsValue触发\r\n  const [isSelected, setIsSelected] = useState(false);\r\n  const [customField, setCustomField] = useState([]);\r\n  const [confirmLoading, setConfirmLoading] = useState(false);\r\n  // 筛选字段类型为日期和数值的字段\r\n  useEffect(() => {\r\n    if (visible) {\r\n      if (isSelected) {\r\n        return;\r\n      }\r\n      form.resetFields();\r\n      form.setFieldsValue({\r\n        endDate: filterDeleteFields(currentItem.endDate, customField),\r\n        itemType: filterDeleteFields(`${currentItem.itemType}`, itemTypeData),\r\n        percentage: filterDeleteFields(currentItem.percentage, customField),\r\n        startDate: filterDeleteFields(currentItem.startDate, customField),\r\n        isDefault: currentItem.isDefault,\r\n      });\r\n    }\r\n  }, [visible, currentItem, form, customField, itemTypeData, isSelected]);\r\n  useEffect(() => {\r\n    const fetch = async (currentItem: TimeItemProps) => {\r\n      const fields = await getCustomFields(currentItem);\r\n      setCustomField(fields);\r\n    };\r\n    if (visible) {\r\n      fetch(currentItem);\r\n    }\r\n  }, [visible, getCustomFields, currentItem]);\r\n  useEffect(() => {\r\n    if (!visible) {\r\n      setIsSelected(false);\r\n    }\r\n  }, [visible]);\r\n  const handleConfirm = () => {\r\n    form\r\n      .validateFields()\r\n      .then(async values => {\r\n        // 保存时对已经删除的字段清空处理\r\n        const fields = await getCustomFields(currentItem);\r\n        Object.keys(omit(values, [\"itemType\"])).forEach(ele => {\r\n          const fileldFilter = fields.filter(\r\n            (f: FieldAndItemProps) => f.objectId === values[ele]\r\n          );\r\n          if (!fileldFilter.length) {\r\n            const obj = {};\r\n            obj[ele] = null;\r\n            form.setFieldsValue(obj);\r\n          }\r\n        });\r\n        form.validateFields().then(async () => {\r\n          setConfirmLoading(true);\r\n          await handleOk(values);\r\n          setConfirmLoading(false);\r\n        });\r\n      })\r\n      .catch(info => {\r\n        console.log(\"Validate Failed:\", info);\r\n      });\r\n  };\r\n  const itemCheck = (_: any, value: string) => {\r\n    if (value) {\r\n      const itemFilter = timeList?.filter(item => item.itemType === value);\r\n      if (itemFilter?.length && currentItem.itemType !== value) {\r\n        return Promise.reject(new Error(\"该事项类型已选择， 请重新选择\"));\r\n      }\r\n      return Promise.resolve();\r\n    } else {\r\n      return Promise.resolve();\r\n    }\r\n  };\r\n  const handelChange = async (val: string) => {\r\n    setIsSelected(true);\r\n    const fields = await getCustomFields({ itemType: val });\r\n    setCustomField(fields);\r\n    form.setFieldsValue({\r\n      startDate: undefined,\r\n      endDate: undefined,\r\n      percentage: undefined,\r\n    });\r\n  };\r\n  return (\r\n    <Modal\r\n      title=\"时间字段配置\"\r\n      visible={visible}\r\n      onOk={handleConfirm}\r\n      onCancel={handleCancel}\r\n      cancelText=\"取消\"\r\n      okText=\"确定\"\r\n      confirmLoading={confirmLoading}\r\n    >\r\n      <Form\r\n        form={form}\r\n        name=\"basic\"\r\n        labelCol={{ span: 24 }}\r\n        wrapperCol={{ span: 24 }}\r\n        layout=\"vertical\"\r\n      >\r\n        {!currentItem?.isDefault && (\r\n          <Form.Item\r\n            label=\"事项类型\"\r\n            name=\"itemType\"\r\n            rules={[\r\n              { required: true, message: \"请选择事项类型\" },\r\n              {\r\n                validator: itemCheck,\r\n              },\r\n            ]}\r\n          >\r\n            <Select placeholder=\"请选择\" onChange={handelChange}>\r\n              {itemTypeData.map((ele: FieldAndItemProps) => {\r\n                return (\r\n                  <Option value={ele.value} key={ele.value}>\r\n                    {ele.icon ? (\r\n                      <img src={ele.icon} className={styles.icon} />\r\n                    ) : null}\r\n                    {ele.label}\r\n                  </Option>\r\n                );\r\n              })}\r\n            </Select>\r\n          </Form.Item>\r\n        )}\r\n\r\n        <Form.Item\r\n          label=\"开始日期\"\r\n          name=\"startDate\"\r\n          rules={[{ required: true, message: \"请选择开始日期字段\" }]}\r\n        >\r\n          {/* 代码没有抽离，原因是会影响from的校验触发 */}\r\n          <Select\r\n            placeholder=\"请选择\"\r\n            showSearch\r\n            filterOption={filterOption}\r\n            allowClear\r\n          >\r\n            {filterFields(\"Date\", customField).map((ele: FieldAndItemProps) => {\r\n              return (\r\n                <Option value={ele.value} key={ele.value} name={ele.label}>\r\n                  {ele.label}\r\n                </Option>\r\n              );\r\n            })}\r\n          </Select>\r\n        </Form.Item>\r\n        <Form.Item\r\n          label=\"结束日期\"\r\n          name=\"endDate\"\r\n          rules={[{ required: true, message: \"请选择结束日期字段\" }]}\r\n        >\r\n          <Select\r\n            placeholder=\"请选择\"\r\n            allowClear\r\n            showSearch\r\n            filterOption={filterOption}\r\n          >\r\n            {filterFields(\"Date\", customField).map((ele: FieldAndItemProps) => {\r\n              return (\r\n                <Option value={ele.value} key={ele.value} name={ele.label}>\r\n                  {ele.label}\r\n                </Option>\r\n              );\r\n            })}\r\n          </Select>\r\n        </Form.Item>\r\n        <Form.Item label=\"完成占比\" name=\"percentage\">\r\n          <Select\r\n            placeholder=\"请选择\"\r\n            allowClear\r\n            showSearch\r\n            filterOption={filterOption}\r\n          >\r\n            {filterFields(\"Number\", customField).map(\r\n              (ele: FieldAndItemProps) => {\r\n                return (\r\n                  <Option value={ele.value} key={ele.value} name={ele.label}>\r\n                    {ele.label}\r\n                  </Option>\r\n                );\r\n              }\r\n            )}\r\n          </Select>\r\n        </Form.Item>\r\n      </Form>\r\n    </Modal>\r\n  );\r\n};\r\nexport default ItemModal;\r\n","import React from \"react\";\r\nimport Icon from \"@ant-design/icons\";\r\n\r\nconst Svg = () => (\r\n  <svg width=\"16px\" height=\"16px\" viewBox=\"0 0 16 16\" version=\"1.1\">\r\n    <title>切片</title>\r\n    <g id=\"方案\" stroke=\"none\" strokeWidth=\"1\" fill=\"none\" fillRule=\"evenodd\">\r\n      <g\r\n        id=\"#18-甘特图-初次提醒时间字段配置\"\r\n        transform=\"translate(-880.000000, -403.000000)\"\r\n      >\r\n        <g\r\n          id=\"5.反馈/1.警告提示/2.带链接/提示\"\r\n          transform=\"translate(864.000000, 395.000000)\"\r\n        >\r\n          <g id=\"图标\" transform=\"translate(16.000000, 8.000000)\">\r\n            <rect\r\n              id=\"矩形\"\r\n              fill=\"#FFFFFF\"\r\n              opacity=\"0\"\r\n              x=\"0\"\r\n              y=\"0\"\r\n              width=\"16\"\r\n              height=\"16\"\r\n            ></rect>\r\n            <path\r\n              d=\"M8,1 C11.8663333,1 15,4.13366667 15,8 C15,11.8663333 11.8663333,15 8,15 C4.13366667,15 1,11.8663333 1,8 C1,4.13366667 4.13366667,1 8,1 Z M8,6.44444444 L7.89383105,6.45156544 C7.5123098,6.50321808 7.22222222,6.82958857 7.22222222,7.22450059 L7.22222222,7.22450059 L7.22222222,11.1088327 C7.22222222,11.5316637 7.57044519,11.8888889 8,11.8888889 L8,11.8888889 L8.10616895,11.8817679 C8.4876902,11.8301153 8.77777778,11.5037448 8.77777778,11.1088327 L8.77777778,11.1088327 L8.77777778,7.22450059 C8.77777778,6.80166965 8.42955481,6.44444444 8,6.44444444 L8,6.44444444 Z M8,4.11111111 C7.57044519,4.11111111 7.22222222,4.45933408 7.22222222,4.88888889 C7.22222222,5.31844369 7.57044519,5.66666667 8,5.66666667 C8.42955481,5.66666667 8.77777778,5.31844369 8.77777778,4.88888889 C8.77777778,4.45933408 8.42955481,4.11111111 8,4.11111111 Z\"\r\n              id=\"Combined-Shape\"\r\n              fill=\"#3683FF\"\r\n            ></path>\r\n          </g>\r\n        </g>\r\n      </g>\r\n    </g>\r\n  </svg>\r\n);\r\nconst IconComponent = props => <Icon component={Svg} {...props} />;\r\nexport default IconComponent;\r\n","import React, { useState, useContext, useMemo, useCallback } from \"react\";\r\nimport { Button, Table, Space, Modal, Tooltip } from \"antd\";\r\nimport { PlusOutlined, QuestionCircleOutlined } from \"@ant-design/icons\";\r\nimport styles from \"./index.module.css\";\r\nimport TimeModal from \"./time-modal\";\r\nimport { ConfigHandleContext, GanttConfigContext } from \"../../contsxt\";\r\nimport { TimeItemProps } from \"../../types/public-types\";\r\nimport WarningIcon from \"../icons/warning\";\r\ninterface TimeProps {}\r\nconst Time: React.FC<TimeProps> = () => {\r\n  const [visible, setVisible] = useState(false);\r\n  const columns = [\r\n    {\r\n      title: \"关联事项\",\r\n      dataIndex: \"itemType\",\r\n      key: \"name\",\r\n      render: (text: string) => {\r\n        const res =\r\n          itemTypeData &&\r\n          itemTypeData.filter((ele: { label: string; value: string }) => {\r\n            return ele.value === text;\r\n          });\r\n        return (\r\n          res[0]?.label || (\r\n            <Tooltip title=\"没有配置的卡片类型将使用默认配置\">\r\n              默认 &nbsp;\r\n              <QuestionCircleOutlined />\r\n            </Tooltip>\r\n          )\r\n        );\r\n      },\r\n    },\r\n    {\r\n      title: \"操作\",\r\n      key: \"action\",\r\n      width: 120,\r\n      render: (_text: string, record: TimeItemProps, index: number) => (\r\n        <Space>\r\n          <a type=\"link\" onClick={() => editTime(index)}>\r\n            配置\r\n          </a>\r\n          {!record?.isDefault && (\r\n            <a type=\"link\" onClick={() => del(index)}>\r\n              删除\r\n            </a>\r\n          )}\r\n        </Space>\r\n      ),\r\n    },\r\n  ];\r\n  const { configHandle, itemTypeData } = useContext(ConfigHandleContext);\r\n  const { ganttConfig } = useContext(GanttConfigContext);\r\n  const [currentItem, setCurrentItem] = useState<any>({});\r\n  const [index, setIndex] = useState(0);\r\n  const timeList = useMemo(\r\n    () =>\r\n      ganttConfig?.time?.length ? ganttConfig?.time : [{ isDefault: true }],\r\n    [ganttConfig?.time]\r\n  );\r\n  const handleCancel = useCallback(() => {\r\n    setVisible(false);\r\n  }, []);\r\n  const handleOk = async (values: TimeItemProps) => {\r\n    let newTimeList;\r\n    if (Object.keys(currentItem).length) {\r\n      newTimeList = [...timeList];\r\n      if (currentItem?.isDefault) {\r\n        values.isDefault = currentItem?.isDefault;\r\n      }\r\n      newTimeList[index] = values;\r\n      // 编辑\r\n    } else {\r\n      // 新增\r\n      newTimeList = [...timeList, values];\r\n    }\r\n    setVisible(false);\r\n    configHandle({\r\n      ...ganttConfig,\r\n      time: newTimeList,\r\n    });\r\n  };\r\n  const addTime = useCallback(() => {\r\n    setVisible(true);\r\n    setCurrentItem({});\r\n  }, []);\r\n  const editTime = useCallback(\r\n    (index: number) => {\r\n      setIndex(index);\r\n      setCurrentItem(timeList[index]);\r\n      setVisible(true);\r\n    },\r\n    [timeList]\r\n  );\r\n  const del = (index: number) => {\r\n    Modal.confirm({\r\n      title: \"删除该配置\",\r\n      content: \"删除后无法恢复。您确定删除吗？\",\r\n      okText: \"确认\",\r\n      cancelText: \"取消\",\r\n      onOk: () => delConfig(index),\r\n    });\r\n  };\r\n  const delConfig = (index: number) => {\r\n    const newTimeList = [...timeList];\r\n    newTimeList.splice(index, 1);\r\n    configHandle({\r\n      ...ganttConfig,\r\n      time: newTimeList,\r\n    });\r\n  };\r\n  return (\r\n    <div>\r\n      <TimeModal\r\n        visible={visible}\r\n        handleCancel={handleCancel}\r\n        handleOk={handleOk}\r\n        currentItem={currentItem}\r\n        timeList={timeList} // 做卡片唯一性校验\r\n      />\r\n      <div className={`${styles.timeTips}`}>\r\n        <em>\r\n          <WarningIcon style={{ color: \"red\" }} />\r\n        </em>\r\n        为了让甘特图正确显示，您需要设置甘特图中时间区块的起止时间对应事项的哪个时间字段\r\n      </div>\r\n      <Table\r\n        columns={columns}\r\n        dataSource={timeList}\r\n        pagination={false}\r\n        className={styles.timeConfigTable}\r\n        rowKey={columns => {\r\n          return columns.itemType || \"default\";\r\n        }}\r\n      />\r\n      <div className={styles.timeConfigAddBtn}>\r\n        <Button icon={<PlusOutlined />} type=\"link\" onClick={addTime}>\r\n          新增配置\r\n        </Button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\nexport default Time;\r\n","import React, { useState, useContext, useMemo, useEffect } from \"react\";\r\nimport { Switch, Modal, Tooltip } from \"antd\";\r\nimport { QuestionCircleOutlined } from \"@ant-design/icons\";\r\nimport { GanttConfigContext, ConfigHandleContext } from \"../../contsxt\";\r\n\r\nimport styles from \"./index.module.css\";\r\n\r\nconst { confirm } = Modal;\r\n\r\nconst OtherConfig: React.FC = () => {\r\n  const [checked, setChecked] = useState(false);\r\n  const { ganttConfig } = useContext(GanttConfigContext);\r\n  const { configHandle } = useContext(ConfigHandleContext);\r\n  const otherConfig = useMemo(() => ganttConfig?.otherConfig, [\r\n    ganttConfig?.otherConfig,\r\n  ]);\r\n  useEffect(() => {\r\n    setChecked(otherConfig?.autoPatch);\r\n  }, [otherConfig?.autoPatch]);\r\n  const onChange = (value: boolean) => {\r\n    if (!value) {\r\n      setChecked(value);\r\n      configHandle({\r\n        ...ganttConfig,\r\n        otherConfig: {\r\n          ...ganttConfig.otherConfig,\r\n          ...{ autoPatch: value },\r\n        },\r\n      });\r\n      return;\r\n    }\r\n    confirm({\r\n      title: \"自动编排\",\r\n      okText: \"确定\",\r\n      cancelText: \"取消\",\r\n      content:\r\n        \"开启自动编排时，将按当前的事项关系自动调整所有事项的时间。确认开启？\",\r\n      onOk() {\r\n        setChecked(value);\r\n        configHandle({\r\n          ...ganttConfig,\r\n          otherConfig: {\r\n            ...ganttConfig.otherConfig,\r\n            ...{ autoPatch: value },\r\n          },\r\n        });\r\n      },\r\n      onCancel() {\r\n        setChecked(false);\r\n      },\r\n    });\r\n  };\r\n  return (\r\n    <div className={styles.otherConfig}>\r\n      <div>\r\n        自动编排\r\n        <span className={styles.question}>\r\n          <Tooltip title=\"根据卡片之间的关系，自动调整卡片时间，避免出现逻辑错误\">\r\n            <QuestionCircleOutlined />\r\n          </Tooltip>\r\n        </span>\r\n      </div>\r\n      <div>\r\n        <Switch onChange={onChange} checked={checked} />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default OtherConfig;\r\n","import React, { useState, useEffect, useContext, useMemo } from \"react\";\r\nimport { Modal, Form, Input } from \"antd\";\r\nimport { BaselineProps } from \"../../../types/public-types\";\r\nimport { BaseLineContext } from \"../../../contsxt\";\r\nimport dayjs from \"dayjs\";\r\n\r\nconst { TextArea } = Input;\r\ninterface ModalProps {\r\n  visible: boolean;\r\n  handleOk: (value: BaselineProps) => void;\r\n  handleCancel: () => void;\r\n  currentBaseline: BaselineProps;\r\n}\r\n\r\nexport const AddEdit: React.FC<ModalProps> = ({\r\n  visible,\r\n  handleOk,\r\n  handleCancel,\r\n  currentBaseline,\r\n}) => {\r\n  const [form] = Form.useForm();\r\n  const [modalVisible, setModalVisible] = useState(false);\r\n  const [confirmLoading, setConfirmLoading] = useState(false);\r\n  const { baselineList } = useContext(BaseLineContext);\r\n  console.log(currentBaseline, \"currentBaseline\");\r\n  const isEdit = useMemo(() => {\r\n    return !!currentBaseline?.objectId;\r\n  }, [currentBaseline]);\r\n  useEffect(() => {\r\n    setModalVisible(visible);\r\n  }, [visible]);\r\n  useEffect(() => {\r\n    form.setFieldsValue({\r\n      name: currentBaseline?.name\r\n        ? currentBaseline?.name\r\n        : dayjs(new Date()).format(\"YYYY-MM-DD HH:mm:ss\"),\r\n      description: currentBaseline?.description,\r\n    });\r\n  }, [currentBaseline, form]);\r\n  const onFinish = () => {};\r\n  const confirmOk = () => {\r\n    form\r\n      .validateFields()\r\n      .then(async (values: BaselineProps) => {\r\n        setConfirmLoading(true);\r\n        await handleOk(Object.assign(currentBaseline, values));\r\n        setConfirmLoading(false);\r\n      })\r\n      .catch(info => {\r\n        console.log(\"Validate Failed:\", info);\r\n      });\r\n  };\r\n  const nameValidator = (\r\n    {},\r\n    value: string,\r\n    callback: (error?: string) => void\r\n  ) => {\r\n    if (!value) {\r\n      callback();\r\n    } else {\r\n      const findRepeat = baselineList?.filter(\r\n        (ele: BaselineProps) => ele.name === value\r\n      );\r\n      if (\r\n        findRepeat.length &&\r\n        currentBaseline &&\r\n        currentBaseline.name !== value\r\n      ) {\r\n        callback(\"该名称已存在\");\r\n      } else {\r\n        callback();\r\n      }\r\n    }\r\n  };\r\n  return (\r\n    <Modal\r\n      title={`${isEdit ? \"编辑\" : \"新建\"}基线`}\r\n      visible={modalVisible}\r\n      onCancel={handleCancel}\r\n      onOk={confirmOk}\r\n      okText=\"确认\"\r\n      cancelText=\"取消\"\r\n      confirmLoading={confirmLoading}\r\n    >\r\n      <Form\r\n        form={form}\r\n        name=\"basic\"\r\n        labelCol={{ span: 24 }}\r\n        wrapperCol={{ span: 24 }}\r\n        layout=\"vertical\"\r\n        onFinish={onFinish}\r\n      >\r\n        <Form.Item\r\n          label=\"基线名称\"\r\n          name=\"name\"\r\n          rules={[\r\n            { required: true, message: \"请输入基线名称\" },\r\n            { validator: nameValidator },\r\n          ]}\r\n        >\r\n          <Input\r\n            placeholder=\"请输入基线名称，最大长度32个字符\"\r\n            maxLength={32}\r\n          />\r\n        </Form.Item>\r\n        <Form.Item label=\"描述\" name=\"description\">\r\n          <TextArea placeholder=\"请输入基线描述\" />\r\n        </Form.Item>\r\n      </Form>\r\n    </Modal>\r\n  );\r\n};\r\nexport default AddEdit;\r\n","import React from \"react\";\r\nimport Icon from \"@ant-design/icons\";\r\n\r\nconst Svg = () => (\r\n  <svg\r\n    width=\"28px\"\r\n    height=\"28px\"\r\n    viewBox=\"0 0 28 28\"\r\n    version=\"1.1\"\r\n    xmlns=\"http://www.w3.org/2000/svg\"\r\n  >\r\n    <title>编组 13</title>\r\n    <g id=\"方案\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\">\r\n      <g id=\"#17-甘特图配置\" transform=\"translate(-864.000000, -336.000000)\">\r\n        <g id=\"编组-12\" transform=\"translate(840.000000, 201.000000)\">\r\n          <g id=\"基线备份-2\" transform=\"translate(24.000000, 135.000000)\">\r\n            <g id=\"编组-13\" transform=\"translate(-0.000844, -0.000844)\">\r\n              <polygon\r\n                id=\"路径\"\r\n                fill=\"#0C62FF\"\r\n                points=\"27.943 0 0 27.943 0.000844122713 0.000844122712\"\r\n              ></polygon>\r\n              <g\r\n                id=\"勾选\"\r\n                transform=\"translate(1.000844, 0.000844)\"\r\n                fill=\"#FFFFFF\"\r\n              >\r\n                <path\r\n                  d=\"M11.8295143,4.29289322 C12.2200386,3.90236893 12.8532036,3.90236893 13.2437279,4.29289322 C13.6042118,4.65337718 13.6319414,5.22060824 13.3269165,5.61289944 L13.2437279,5.70710678 L7.30919533,11.6416393 C6.76002054,12.1908141 5.89095813,12.2251375 5.30179739,11.7446096 L5.18787498,11.6416393 L2.29289322,8.74665756 C1.90236893,8.35613327 1.90236893,7.72296829 2.29289322,7.332444 C2.65337718,6.97196004 3.22060824,6.9442305 3.61289944,7.24925539 L3.70710678,7.332444 L6.248,9.873 L11.8295143,4.29289322 Z\"\r\n                  id=\"路径-4\"\r\n                ></path>\r\n              </g>\r\n            </g>\r\n          </g>\r\n        </g>\r\n      </g>\r\n    </g>\r\n  </svg>\r\n);\r\nconst IconComponent = props => <Icon component={Svg} {...props} />;\r\nexport default IconComponent;\r\n","import React, { useState, useContext, useCallback } from \"react\";\r\nimport { PlusOutlined, EditOutlined, DeleteOutlined } from \"@ant-design/icons\";\r\nimport { Button, Modal } from \"antd\";\r\nimport AddEdit from \"./add-edit\";\r\nimport { BaseLineContext } from \"../../../contsxt\";\r\nimport { BaselineProps } from \"../../../types/public-types\";\r\nimport Checked from \"../../icons/checked\";\r\nimport { omit } from \"lodash\";\r\nimport { dayTimeFormat } from \"../../../helpers/dicts\";\r\n\r\nimport dayjs from \"dayjs\";\r\n\r\nimport styles from \"./index.css\";\r\nexport const BaseLine: React.FC = () => {\r\n  const {\r\n    baseLineHandle,\r\n    baselineList,\r\n    setCurrentLog,\r\n    currentLog,\r\n    OverflowTooltip,\r\n    setLogTasks,\r\n  } = useContext(BaseLineContext);\r\n  const deleteBaseline = (currentBaseline: BaselineProps) => {\r\n    Modal.confirm({\r\n      title: \"删除基线\",\r\n      content: \"删除的基线无法恢复，确认删除？\",\r\n      okText: \"确认\",\r\n      cancelText: \"取消\",\r\n      onOk: () => baseLineHandle(currentBaseline),\r\n    });\r\n  };\r\n  const handleMenuClick = (\r\n    type: string,\r\n    e: React.SyntheticEvent,\r\n    currentBaseLine: BaselineProps\r\n  ) => {\r\n    const currentBaselineOmit = omit(currentBaseLine, [\r\n      \"createdAt\",\r\n      \"updatedAt\",\r\n    ]);\r\n    setCurrentBaseline(currentBaselineOmit);\r\n    e.stopPropagation();\r\n    switch (type) {\r\n      case \"edit\":\r\n        setVisible(true);\r\n        break;\r\n      case \"del\":\r\n        deleteBaseline(currentBaselineOmit);\r\n        break;\r\n    }\r\n  };\r\n  const [visible, setVisible] = useState(false);\r\n  const [currentBaseline, setCurrentBaseline] = useState<any>({});\r\n  const addBaseline = () => {\r\n    setVisible(true);\r\n    setCurrentBaseline({});\r\n  };\r\n  const handleOk = useCallback(\r\n    async (value: BaselineProps) => {\r\n      await baseLineHandle(value, value.objectId ? \"edit\" : \"add\");\r\n      setVisible(false);\r\n    },\r\n    [baseLineHandle]\r\n  );\r\n  const handleCancel = () => {\r\n    setVisible(false);\r\n  };\r\n  const chooseLog = (infor: BaselineProps) => {\r\n    // 取消选中基线\r\n    if (currentLog?.objectId === infor?.objectId) {\r\n      setCurrentLog([]);\r\n      setLogTasks([]);\r\n    } else {\r\n      setCurrentLog(infor);\r\n    }\r\n  };\r\n  return (\r\n    <div className={styles.panel}>\r\n      <div className={styles.createBaseline}>\r\n        <Button\r\n          type=\"dashed\"\r\n          icon={<PlusOutlined />}\r\n          onClick={addBaseline}\r\n          disabled={baselineList?.length >= 10}\r\n        >\r\n          {`创建基线（${baselineList?.length}/10）`}\r\n        </Button>\r\n      </div>\r\n      {visible && (\r\n        <AddEdit\r\n          visible={visible}\r\n          handleOk={handleOk}\r\n          handleCancel={handleCancel}\r\n          currentBaseline={currentBaseline}\r\n        />\r\n      )}\r\n      <ul className={styles.list}>\r\n        {baselineList.map((ele: BaselineProps) => {\r\n          return (\r\n            <li\r\n              key={ele.objectId}\r\n              className={\r\n                currentLog && ele.objectId === currentLog.objectId\r\n                  ? styles.activeBaseline\r\n                  : undefined\r\n              }\r\n            >\r\n              {ele.objectId === currentLog?.objectId && (\r\n                <div className={styles.checkedIcon}>\r\n                  <Checked />\r\n                </div>\r\n              )}\r\n              <div\r\n                className={`${styles.content} ${styles.cursor}`}\r\n                onClick={() => chooseLog(ele)}\r\n              >\r\n                <div className={styles.name}>{OverflowTooltip(ele.name)}</div>\r\n                <div className={styles.time}>\r\n                  <div className={styles.createTime}>\r\n                    创建于：\r\n                    {dayjs(new Date(ele.createdAt)).format(dayTimeFormat)}\r\n                  </div>\r\n                  <div className={styles.handleIcon}>\r\n                    <EditOutlined\r\n                      onClick={e => handleMenuClick(\"edit\", e, ele)}\r\n                    />\r\n                    <DeleteOutlined\r\n                      onClick={e => handleMenuClick(\"del\", e, ele)}\r\n                    />\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </li>\r\n          );\r\n        })}\r\n      </ul>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default BaseLine;\r\n","import React, { useEffect, useState } from \"react\";\r\nimport { Switch, Row, Col } from \"antd\";\r\nimport { GanttConfigProps } from \"../../types/public-types\";\r\nimport styles from \"./index.module.css\";\r\ninterface DisplayProps {\r\n  ganttConfig?: GanttConfigProps;\r\n  configHandle?: (value: GanttConfigProps) => void;\r\n  visibleChange?: (value: GanttConfigProps) => void;\r\n}\r\nexport const Display: React.FC<DisplayProps> = ({\r\n  ganttConfig,\r\n  configHandle,\r\n}) => {\r\n  const [currentValue, setCurrentValue] = useState<GanttConfigProps>({});\r\n  useEffect(() => {\r\n    setCurrentValue({ ...ganttConfig, isChanged: false });\r\n  }, [ganttConfig]);\r\n  const handleChange = (value: boolean, type: string) => {\r\n    const newConfig = {\r\n      ...currentValue,\r\n      otherConfig: { ...currentValue.otherConfig, [type]: value },\r\n      isChanged: true,\r\n    };\r\n    setCurrentValue(newConfig);\r\n    configHandle?.(newConfig);\r\n  };\r\n\r\n  return (\r\n    <div className={styles.displayPopover}>\r\n      <Row className={styles.displayRow}>\r\n        <Col span={14}>关键路径</Col>\r\n        <Col span={10} className={styles.textAlignR}>\r\n          <Switch\r\n            onChange={checked => handleChange(checked, \"pivotalPath\")}\r\n            checked={currentValue?.otherConfig?.pivotalPath}\r\n          />\r\n        </Col>\r\n      </Row>\r\n      <Row>\r\n        <Col span={14}>逾期的事项</Col>\r\n        <Col span={10} className={styles.textAlignR}>\r\n          <Switch\r\n            onChange={checked => handleChange(checked, \"overdue\")}\r\n            checked={currentValue?.otherConfig?.overdue}\r\n          />\r\n        </Col>\r\n      </Row>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Display;\r\n","import React from \"react\";\r\nimport Icon from \"@ant-design/icons\";\r\n\r\nconst Svg = () => (\r\n  <svg\r\n    width=\"16px\"\r\n    height=\"16px\"\r\n    viewBox=\"0 0 16 16\"\r\n    version=\"1.1\"\r\n    xmlns=\"http://www.w3.org/2000/svg\"\r\n  >\r\n    <title>切片</title>\r\n    <g id=\"方案\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\">\r\n      <g\r\n        id=\"#6.详情页间距标注\"\r\n        transform=\"translate(-744.000000, -1064.000000)\"\r\n      >\r\n        <g\r\n          id=\"4.数据展示/5.Collapse折叠面板/标题备份-3\"\r\n          transform=\"translate(744.000000, 1060.000000)\"\r\n        >\r\n          <g\r\n            id=\"1.通用/2.图标/2.填充/collapse-down\"\r\n            transform=\"translate(0.000000, 4.000000)\"\r\n          >\r\n            <rect\r\n              id=\"矩形\"\r\n              fill=\"#FFFFFF\"\r\n              opacity=\"0\"\r\n              x=\"0\"\r\n              y=\"0\"\r\n              width=\"16\"\r\n              height=\"16\"\r\n            ></rect>\r\n            <rect\r\n              id=\"矩形\"\r\n              fill=\"#F1F2F4\"\r\n              x=\"0\"\r\n              y=\"0\"\r\n              width=\"16\"\r\n              height=\"16\"\r\n              rx=\"8\"\r\n            ></rect>\r\n            <path\r\n              d=\"M4.24726739,5.72183194 C3.9842442,5.96094393 3.9842442,6.35723789 4.24726739,6.59634988 L8.29726739,10.2781681 C8.54928757,10.5072773 8.95071243,10.5072773 9.20273261,10.2781681 L13.2527326,6.59634988 C13.5157558,6.35723789 13.5157558,5.96094393 13.2527326,5.72183194 L13.1636023,5.65394772 C12.9133514,5.4955512 12.5712853,5.51817927 12.3472674,5.72183194 L8.75,8.992 L5.15273261,5.72183194 C4.90071243,5.49272269 4.49928757,5.49272269 4.24726739,5.72183194 Z\"\r\n              id=\"路径\"\r\n              fill=\"#213053\"\r\n              transform=\"translate(8.750000, 8.000000) rotate(-90.000000) translate(-8.750000, -8.000000) \"\r\n            ></path>\r\n          </g>\r\n        </g>\r\n      </g>\r\n    </g>\r\n  </svg>\r\n);\r\nconst IconComponent = props => <Icon component={Svg} {...props} />;\r\nexport default IconComponent;\r\n","import React, { memo, useEffect, useState } from \"react\";\r\nimport { Drawer, Collapse } from \"antd\";\r\nimport Time from \"./time\";\r\nimport OtherConfig from \"./other-config\";\r\nimport Baseline from \"./baseline\";\r\nimport Display from \"./display\";\r\nimport { GanttConfigProps } from \"../../types/public-types\";\r\nimport CollapseIcon from \"../icons/collapseIcon\";\r\nimport { drawerWidth } from \"../../helpers/dicts\";\r\nimport { isArray } from \"lodash\";\r\n\r\nimport styles from \"./index.module.css\";\r\n\r\nconst { Panel } = Collapse;\r\n\r\nconst GanttConfig: React.FC<GanttConfigProps> = ({\r\n  toGantt,\r\n  visible,\r\n  currentPanel,\r\n  configHandle,\r\n  ganttConfig,\r\n}) => {\r\n  const [activeKey, setActiveKey] = useState<string[]>([]);\r\n  useEffect(() => {\r\n    if (currentPanel) {\r\n      setActiveKey([currentPanel]);\r\n    } else {\r\n      setActiveKey([]);\r\n    }\r\n  }, [currentPanel]);\r\n  const onChange = (val: string | string[]) => {\r\n    if (isArray(val)) {\r\n      setActiveKey([...val]);\r\n    }\r\n  };\r\n  const genHeader = () => (\r\n    <span className={styles.extraHeader}>\r\n      <span className={styles.title}>基线</span>\r\n      <span className={styles.des}>（点击基线卡片可选择显示基线）</span>\r\n    </span>\r\n  );\r\n  return (\r\n    <Drawer\r\n      title=\"甘特图设置\"\r\n      visible={visible}\r\n      onClose={() => toGantt()}\r\n      width={drawerWidth}\r\n      getContainer={false}\r\n      className={styles.settingsModalContainer}\r\n      contentWrapperStyle={{ maxWidth: \"721px\" }}\r\n      style={{ position: \"absolute\" }}\r\n      maskClosable={false}\r\n      mask={false}\r\n    >\r\n      <Collapse\r\n        activeKey={activeKey}\r\n        onChange={onChange}\r\n        expandIcon={({ isActive }) => (\r\n          <CollapseIcon className={isActive ? styles.activeRotate : \"\"} />\r\n        )}\r\n        className={styles.collapse}\r\n      >\r\n        <Panel header={genHeader()} key=\"baseLine\">\r\n          <Baseline />\r\n        </Panel>\r\n\r\n        <Panel header=\"显示项\" key=\"display\">\r\n          <Display ganttConfig={ganttConfig} configHandle={configHandle} />\r\n        </Panel>\r\n        <Panel header=\"时间字段配置\" key=\"time\">\r\n          <Time />\r\n        </Panel>\r\n        <Panel header=\"其他配置\" key=\"other\">\r\n          <OtherConfig />\r\n        </Panel>\r\n      </Collapse>\r\n    </Drawer>\r\n  );\r\n};\r\nexport default memo(GanttConfig);\r\n","import React, { useState, useEffect, useCallback, memo } from \"react\";\r\nimport { Modal } from \"antd\";\r\nimport styles from \"./gantt.module.css\";\r\ninterface ModaProps {\r\n  visible: boolean;\r\n  toPanel: () => void;\r\n  toCancel: () => void;\r\n}\r\nexport const GuideModal: React.FC<ModaProps> = ({\r\n  visible,\r\n  toPanel,\r\n  toCancel,\r\n}) => {\r\n  const [modalVisible, setModalVisible] = useState(false);\r\n  useEffect(() => {\r\n    setModalVisible(visible);\r\n  }, [visible]);\r\n  const toConfig = useCallback(() => {\r\n    toPanel();\r\n  }, [toPanel]);\r\n  const handleCancel = useCallback(() => {\r\n    toCancel();\r\n  }, [toCancel]);\r\n  return (\r\n    <Modal\r\n      closable={false}\r\n      visible={modalVisible}\r\n      footer={null}\r\n      width={300}\r\n      className=\"guide-modal\"\r\n      onCancel={handleCancel}\r\n    >\r\n      <span className={styles.guideInfor}>\r\n        还没有配置甘特图中卡片的时间字段，\r\n        <span onClick={toConfig} className={styles.clickThis}>\r\n          点此\r\n        </span>\r\n        进行配置\r\n      </span>\r\n    </Modal>\r\n  );\r\n};\r\n\r\nexport default memo(GuideModal);\r\n","import React from \"react\";\r\nimport Icon from \"@ant-design/icons\";\r\n\r\nconst Svg = () => (\r\n  <svg width=\"16px\" height=\"16px\" viewBox=\"0 0 16 16\" version=\"1.1\">\r\n    <title>1.通用/2.Icon图标/Line/Down</title>\r\n    <defs>\r\n      <rect id=\"path-1\" x=\"260\" y=\"226\" width=\"396\" height=\"611\"></rect>\r\n      <filter\r\n        x=\"-0.9%\"\r\n        y=\"-0.9%\"\r\n        width=\"102.8%\"\r\n        height=\"101.8%\"\r\n        filterUnits=\"objectBoundingBox\"\r\n        id=\"filter-2\"\r\n      >\r\n        <feOffset\r\n          dx=\"2\"\r\n          dy=\"0\"\r\n          in=\"SourceAlpha\"\r\n          result=\"shadowOffsetOuter1\"\r\n        ></feOffset>\r\n        <feGaussianBlur\r\n          stdDeviation=\"1.5\"\r\n          in=\"shadowOffsetOuter1\"\r\n          result=\"shadowBlurOuter1\"\r\n        ></feGaussianBlur>\r\n        <feColorMatrix\r\n          values=\"0 0 0 0 0.0352941176   0 0 0 0 0.117647059   0 0 0 0 0.258823529  0 0 0 0.162778628 0\"\r\n          type=\"matrix\"\r\n          in=\"shadowBlurOuter1\"\r\n          result=\"shadowMatrixOuter1\"\r\n        ></feColorMatrix>\r\n        <feOffset\r\n          dx=\"0\"\r\n          dy=\"0\"\r\n          in=\"SourceAlpha\"\r\n          result=\"shadowOffsetOuter2\"\r\n        ></feOffset>\r\n        <feGaussianBlur\r\n          stdDeviation=\"0.5\"\r\n          in=\"shadowOffsetOuter2\"\r\n          result=\"shadowBlurOuter2\"\r\n        ></feGaussianBlur>\r\n        <feColorMatrix\r\n          values=\"0 0 0 0 0.0352941176   0 0 0 0 0.117647059   0 0 0 0 0.258823529  0 0 0 0.34099104 0\"\r\n          type=\"matrix\"\r\n          in=\"shadowBlurOuter2\"\r\n          result=\"shadowMatrixOuter2\"\r\n        ></feColorMatrix>\r\n        <feMerge>\r\n          <feMergeNode in=\"shadowMatrixOuter1\"></feMergeNode>\r\n          <feMergeNode in=\"shadowMatrixOuter2\"></feMergeNode>\r\n        </feMerge>\r\n      </filter>\r\n      <filter color-interpolation-filters=\"auto\" id=\"filter-3\">\r\n        <feColorMatrix\r\n          in=\"SourceGraphic\"\r\n          type=\"matrix\"\r\n          values=\"0 0 0 0 0.180392 0 0 0 0 0.250980 0 0 0 0 0.368627 0 0 0 1.000000 0\"\r\n        ></feColorMatrix>\r\n      </filter>\r\n      <filter color-interpolation-filters=\"auto\" id=\"filter-4\">\r\n        <feColorMatrix\r\n          in=\"SourceGraphic\"\r\n          type=\"matrix\"\r\n          values=\"0 0 0 0 0.180392 0 0 0 0 0.250980 0 0 0 0 0.368627 0 0 0 1.000000 0\"\r\n        ></feColorMatrix>\r\n      </filter>\r\n    </defs>\r\n    <g\r\n      id=\"页面-1\"\r\n      stroke=\"none\"\r\n      stroke-width=\"1\"\r\n      fill=\"none\"\r\n      fill-rule=\"evenodd\"\r\n    >\r\n      <g id=\"甘特图-未设置\" transform=\"translate(-648.000000, -515.000000)\">\r\n        <rect fill=\"#FFFFFF\" x=\"0\" y=\"0\" width=\"1440\" height=\"900\"></rect>\r\n        <g id=\"矩形\">\r\n          <use\r\n            fill=\"black\"\r\n            fill-opacity=\"1\"\r\n            filter=\"url(#filter-2)\"\r\n            id=\"#path-1\"\r\n          ></use>\r\n          <use fill=\"#FFFFFF\" fill-rule=\"evenodd\" id=\"#path-2\"></use>\r\n        </g>\r\n        <g id=\"数据配置\" transform=\"translate(260.000000, 486.000000)\"></g>\r\n        <g id=\"数据配置\" transform=\"translate(260.000000, 530.000000)\"></g>\r\n        <rect\r\n          id=\"矩形\"\r\n          stroke=\"#ECEDF0\"\r\n          x=\"260.5\"\r\n          y=\"225.5\"\r\n          width=\"1159\"\r\n          height=\"612\"\r\n        ></rect>\r\n        <g id=\"编组-13\" transform=\"translate(640.000000, 507.000000)\">\r\n          <circle\r\n            id=\"椭圆形\"\r\n            stroke=\"#ECEDF0\"\r\n            fill=\"#FFFFFF\"\r\n            cx=\"16\"\r\n            cy=\"16\"\r\n            r=\"15.5\"\r\n          ></circle>\r\n          <g\r\n            id=\"展开\"\r\n            transform=\"translate(8.000000, 8.000000)\"\r\n            filter=\"url(#filter-3)\"\r\n          >\r\n            <g transform=\"translate(8.000000, 8.000000) rotate(90.000000) translate(-8.000000, -8.000000) \">\r\n              <rect\r\n                id=\"矩形\"\r\n                fill=\"#D8D8D8\"\r\n                opacity=\"0\"\r\n                x=\"0\"\r\n                y=\"0\"\r\n                width=\"16\"\r\n                height=\"16\"\r\n              ></rect>\r\n              <path\r\n                d=\"M12.9757359,6.15975994 C13.2100505,5.94674669 13.5899495,5.94674669 13.8242641,6.15975994 C14.0585786,6.37277319 14.0585786,6.7181359 13.8242641,6.93114915 L8.42426407,11.8402401 C8.18994949,12.0532533 7.81005051,12.0532533 7.57573593,11.8402401 L2.17573593,6.93114915 C1.94142136,6.7181359 1.94142136,6.37277319 2.17573593,6.15975994 C2.41005051,5.94674669 2.78994949,5.94674669 3.02426407,6.15975994 L8,10.6831562 L12.9757359,6.15975994 Z\"\r\n                id=\"Rectangle-2备份\"\r\n                fill=\"#1E2A3D\"\r\n              ></path>\r\n            </g>\r\n          </g>\r\n          <g filter=\"url(#filter-4)\" id=\"展开\">\r\n            <g transform=\"translate(16.000000, 16.000000) rotate(90.000000) translate(-16.000000, -16.000000) translate(8.000000, 8.000000)\">\r\n              <rect\r\n                id=\"矩形\"\r\n                fill=\"#D8D8D8\"\r\n                opacity=\"0\"\r\n                x=\"0\"\r\n                y=\"0\"\r\n                width=\"16\"\r\n                height=\"16\"\r\n              ></rect>\r\n              <path\r\n                d=\"M12.9757359,6.15975994 C13.2100505,5.94674669 13.5899495,5.94674669 13.8242641,6.15975994 C14.0585786,6.37277319 14.0585786,6.7181359 13.8242641,6.93114915 L8.42426407,11.8402401 C8.18994949,12.0532533 7.81005051,12.0532533 7.57573593,11.8402401 L2.17573593,6.93114915 C1.94142136,6.7181359 1.94142136,6.37277319 2.17573593,6.15975994 C2.41005051,5.94674669 2.78994949,5.94674669 3.02426407,6.15975994 L8,10.6831562 L12.9757359,6.15975994 Z\"\r\n                id=\"Rectangle-2备份\"\r\n                fill=\"#1E2A3D\"\r\n              ></path>\r\n            </g>\r\n          </g>\r\n        </g>\r\n      </g>\r\n    </g>\r\n  </svg>\r\n);\r\nconst IconComponent = props => <Icon component={Svg} {...props} />;\r\nexport default IconComponent;\r\n","export const getLocalStorageItem = (key: string, defalut: any = \"\"): any => {\r\n  try {\r\n    if (typeof window !== \"undefined\") {\r\n      const item = localStorage.getItem(key);\r\n      return (item && JSON.parse(item)) || defalut;\r\n    }\r\n  } catch (e) {\r\n    return localStorage.getItem(key) || defalut;\r\n  }\r\n};\r\n\r\nexport const setLocalStorageItem = (key: string, value: unknown): boolean => {\r\n  try {\r\n    if (typeof window !== \"undefined\") {\r\n      localStorage.setItem(key, JSON.stringify(value));\r\n      return true;\r\n    }\r\n    return false;\r\n  } catch (e) {\r\n    console.error(e);\r\n    return false;\r\n  }\r\n};\r\n\r\nexport default {\r\n  getLocalStorageItem,\r\n  setLocalStorageItem,\r\n};\r\n","import React, { useMemo } from \"react\";\r\nimport { Tabs } from \"antd\";\r\nimport { viewModeOptions, ViewMode } from \"../../types/public-types\";\r\n\r\nimport styles from \"./gantt.module.css\";\r\nconst { TabPane } = Tabs;\r\n\r\ninterface DateModeProps {\r\n  toToday: () => void;\r\n  modeChange: (val: ViewMode) => void;\r\n  todayX: number;\r\n  svgContainerWidth: number;\r\n  refScrollX: number;\r\n}\r\nconst DataMode: React.FC<DateModeProps> = ({\r\n  toToday,\r\n  modeChange,\r\n  todayX,\r\n  svgContainerWidth,\r\n  refScrollX,\r\n}) => {\r\n  const handleChange = (value: string) => {\r\n    modeChange(value as ViewMode);\r\n  };\r\n  const isShowToday = useMemo(() => {\r\n    return (\r\n      refScrollX + svgContainerWidth - 20 < todayX || refScrollX > todayX - 20\r\n    );\r\n  }, [refScrollX, svgContainerWidth, todayX]);\r\n  return (\r\n    <div className={styles.viewMode}>\r\n      {isShowToday && (\r\n        <span className={styles.todayBtn} onClick={toToday}>\r\n          今天\r\n        </span>\r\n      )}\r\n\r\n      <div className={styles.dataMode}>\r\n        <Tabs\r\n          defaultActiveKey={ViewMode.Day}\r\n          tabPosition=\"top\"\r\n          onChange={handleChange}\r\n        >\r\n          {viewModeOptions.map(ele => (\r\n            <TabPane tab={ele.label} key={ele.value} />\r\n          ))}\r\n        </Tabs>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default DataMode;\r\n","import React, {\r\n  useState,\r\n  SyntheticEvent,\r\n  useRef,\r\n  useEffect,\r\n  useMemo,\r\n  useCallback,\r\n} from \"react\";\r\nimport { ViewMode, GanttProps } from \"../../types/public-types\";\r\nimport { GridProps } from \"../grid/grid\";\r\nimport {\r\n  ganttDateRange,\r\n  seedDates,\r\n  addToDate,\r\n} from \"../../helpers/date-helper\";\r\nimport { CalendarProps } from \"../calendar/calendar\";\r\nimport { TaskGanttContentProps } from \"./task-gantt-content\";\r\nimport { StandardTooltipContent, Tooltip } from \"../other/tooltip\";\r\nimport { DeleteTooltip } from \"../other/deleteTooltip\";\r\n\r\nimport { VerticalScroll } from \"../other/vertical-scroll\";\r\nimport { TaskGantt } from \"./task-gantt\";\r\nimport { BarTask } from \"../../types/bar-task\";\r\nimport { convertToBarTasks } from \"../../helpers/bar-helper\";\r\nimport { GanttEvent } from \"../../types/gantt-task-actions\";\r\nimport { DateSetup } from \"../../types/date-setup\";\r\nimport styles from \"./gantt.module.css\";\r\nimport { HorizontalScroll } from \"../other/horizontal-scroll\";\r\nimport GanttConfig from \"../gantt-config/index\";\r\nimport GuideModal from \"./guide-modal\";\r\nimport { Button } from \"antd\";\r\nimport ArrowIcon from \"../icons/arrow\";\r\nimport utils from \"../../helpers/utils\";\r\nimport { scrollBarHeight } from \"../../helpers/dicts\";\r\nimport DataMode from \"./data-mode\";\r\n\r\nimport \"./gantt.css\";\r\n\r\nimport {\r\n  GanttConfigContext,\r\n  ConfigHandleContext,\r\n  BaseLineContext,\r\n} from \"../../contsxt\";\r\nconst widthData = {\r\n  [ViewMode.Month]: 300,\r\n  [ViewMode.Week]: 210,\r\n  [ViewMode.Year]: 240,\r\n  [ViewMode.Quarter]: 180,\r\n};\r\nexport const Gantt: React.FunctionComponent<GanttProps> = ({\r\n  tasks,\r\n  baseLineLog,\r\n  isUpdate,\r\n  headerHeight = 41,\r\n  // columnWidth = 60,\r\n  listCellWidth = \"155px\",\r\n  listWidth = 496,\r\n  listBottomHeight = 48,\r\n  rowHeight = 41,\r\n  // viewMode = ViewMode.Day,\r\n  // locale = \"en-GB\",\r\n  locale = \"zh-cn\",\r\n  barFill = 60, // bar占的百分比\r\n  barCornerRadius = 4,\r\n  barProgressColor = \"#4B8BFF\",\r\n  barProgressSelectedColor = \"#4B8BFF\",\r\n  barBackgroundColor = \"#4B8BFF\",\r\n  barBackgroundSelectedColor = \"#4B8BFF\",\r\n  projectProgressColor = \"#7db59a\",\r\n  projectProgressSelectedColor = \"#59a985\",\r\n  projectBackgroundColor = \"#fac465\",\r\n  projectBackgroundSelectedColor = \"#f7bb53\",\r\n  milestoneBackgroundColor = \"#f1c453\",\r\n  milestoneBackgroundSelectedColor = \"#f29e4c\",\r\n  handleWidth = 2,\r\n  timeStep = 300000,\r\n  arrowColor = \"grey\",\r\n  fontFamily = \"Arial, Roboto, Oxygen, Ubuntu, Cantarell, Fira Sans, Droid Sans, Helvetica Neue\",\r\n  fontSize = \"14px\",\r\n  arrowIndent = 20,\r\n  todayColor = \"#FFAB00\",\r\n  TooltipContent = StandardTooltipContent,\r\n  onDateChange,\r\n  onProgressChange,\r\n  onDoubleClick,\r\n  onDelete,\r\n  onSelect,\r\n  renderTaskListComponent,\r\n  renderOverflowTooltip,\r\n  renderUserAvatar,\r\n  itemTypeData = [], // 卡片类型\r\n  configHandle, // 配置事件\r\n  baseLineHandle, // 基线事件\r\n  setCurrentLog, // 选择基线log\r\n  ganttConfig = {}, // 配置详情\r\n  itemLinks = [], // 卡片关联\r\n  addConnection,\r\n  delConnection,\r\n  baselineList = [],\r\n  currentLog,\r\n  actionRef,\r\n  workspaceId,\r\n  getCustomFields, // 获取字段\r\n  isConnect = true,\r\n  isViewModeChange = true,\r\n  onMouseEvent,\r\n  onClickEvent,\r\n  configVisibleChange, // 甘特图配置页面显示和隐藏\r\n  tableQuerySelector = \".BaseTable__table-main .BaseTable__body\",\r\n}) => {\r\n  const wrapperRef = useRef<HTMLDivElement>(null);\r\n  const taskListRef = useRef<HTMLDivElement>(null);\r\n  const onMouseEventRef = useRef<any>(null);\r\n  const taskGanttContainerRef = useRef<any>({});\r\n  const verticalScrollContainerRef = useRef<HTMLDivElement>(null);\r\n  const horizontalScrollContainerRef = useRef<HTMLDivElement>(null);\r\n  const [viewMode, setViewMode] = useState(ViewMode.Day);\r\n  const [columnWidth, setColumnWidth] = useState(60);\r\n  const [dateSetup, setDateSetup] = useState<DateSetup>(() => {\r\n    const [startDate, endDate] = ganttDateRange(viewMode);\r\n    return { viewMode, dates: seedDates(startDate, endDate, viewMode) };\r\n  });\r\n  const CACHE_LIST_WIDTH_KEY = \"gantt-cache-list-width\";\r\n  const cacheListWidth = utils.getLocalStorageItem(CACHE_LIST_WIDTH_KEY);\r\n  const initListWidth = useMemo(() => {\r\n    return cacheListWidth || listWidth;\r\n  }, [listWidth, cacheListWidth]);\r\n\r\n  const [taskHeight, setTaskHeight] = useState((rowHeight * barFill) / 100);\r\n  const [taskListWidth, setTaskListWidth] = useState(initListWidth);\r\n  const [svgContainerWidth, setSvgContainerWidth] = useState(0);\r\n  const [ganttHeight, setGanttHeight] = useState(0);\r\n  const [svgContainerHeight, setSvgContainerHeight] = useState(ganttHeight);\r\n  const [barTasks, setBarTasks] = useState<BarTask[]>([]);\r\n  const [logTasks, setLogTasks] = useState<BarTask[]>([]);\r\n  // 定义列表是否有横向滚动条，以适配甘特图的横向滚动条\r\n  const [isTableScrollX, setIsTableScrollX] = useState(true);\r\n  const [ganttEvent, setGanttEvent] = useState<GanttEvent>({\r\n    action: \"\",\r\n  });\r\n  const [currentConnection, setCurrentConnection] = useState(null);\r\n  const [selectedTask, setSelectedTask] = useState<BarTask>();\r\n  const [failedTask, setFailedTask] = useState<BarTask | null>(null);\r\n\r\n  const eleListTableBodyRef = useRef<any>(null);\r\n  const [scrollY, setScrollY] = useState(0);\r\n  const [scrollX, setScrollX] = useState(0);\r\n  const refScrollY: any = useRef(0);\r\n  const refScrollX: any = useRef(0);\r\n  const [visible, setVisible] = useState(false);\r\n  const [ignoreScrollEvent, setIgnoreScrollEvent] = useState(false);\r\n  const [guideModalVisible, setGuideModalVisible] = useState(false);\r\n  const [currentPanel, setCurrentPanel] = useState(\"\");\r\n\r\n  const dividerPositionRef = useRef({ left: 0 });\r\n  // 到今天移动的距离\r\n  // const [todayDistance, setTodayDistance] = useState(0);\r\n  const svgWidth = dateSetup.dates.length * columnWidth;\r\n  const ganttFullHeight = barTasks.length * rowHeight;\r\n  const minWidth = 2; // 面板折叠后，taskListWidth 设置成2（设置成0后，dom节点会移除）\r\n  const paddingLeft = 38; // wrapper的padding值， 用于dividerWrapper定位\r\n  // task change events\r\n  useEffect(() => {\r\n    const [startDate, endDate] = ganttDateRange(viewMode);\r\n    const newDates = seedDates(startDate, endDate, viewMode);\r\n    setDateSetup({ dates: newDates, viewMode });\r\n    setBarTasks(\r\n      convertToBarTasks(\r\n        tasks,\r\n        newDates,\r\n        columnWidth,\r\n        rowHeight,\r\n        taskHeight,\r\n        barCornerRadius,\r\n        handleWidth,\r\n        barProgressColor,\r\n        barProgressSelectedColor,\r\n        barBackgroundColor,\r\n        barBackgroundSelectedColor,\r\n        projectProgressColor,\r\n        projectProgressSelectedColor,\r\n        projectBackgroundColor,\r\n        projectBackgroundSelectedColor,\r\n        milestoneBackgroundColor,\r\n        milestoneBackgroundSelectedColor,\r\n        viewMode\r\n      )\r\n    );\r\n  }, [\r\n    tasks,\r\n    isUpdate,\r\n    viewMode,\r\n    rowHeight,\r\n    barCornerRadius,\r\n    columnWidth,\r\n    taskHeight,\r\n    handleWidth,\r\n    barProgressColor,\r\n    barProgressSelectedColor,\r\n    barBackgroundColor,\r\n    barBackgroundSelectedColor,\r\n    projectProgressColor,\r\n    projectProgressSelectedColor,\r\n    projectBackgroundColor,\r\n    projectBackgroundSelectedColor,\r\n    milestoneBackgroundColor,\r\n    milestoneBackgroundSelectedColor,\r\n  ]);\r\n  useEffect(() => {\r\n    const [startDate, endDate] = ganttDateRange(viewMode);\r\n    const newDates = seedDates(startDate, endDate, viewMode);\r\n    if (baseLineLog?.length) {\r\n      setLogTasks(\r\n        convertToBarTasks(\r\n          // @ts-ignore\r\n          (tasks = baseLineLog),\r\n          newDates,\r\n          columnWidth,\r\n          rowHeight,\r\n          taskHeight,\r\n          barCornerRadius,\r\n          handleWidth,\r\n          barProgressColor,\r\n          barProgressSelectedColor,\r\n          barBackgroundColor,\r\n          barBackgroundSelectedColor,\r\n          projectProgressColor,\r\n          projectProgressSelectedColor,\r\n          projectBackgroundColor,\r\n          projectBackgroundSelectedColor,\r\n          milestoneBackgroundColor,\r\n          milestoneBackgroundSelectedColor,\r\n          viewMode\r\n        )\r\n      );\r\n    }\r\n  }, [\r\n    baseLineLog,\r\n    isUpdate,\r\n    viewMode,\r\n    rowHeight,\r\n    barCornerRadius,\r\n    columnWidth,\r\n    taskHeight,\r\n    handleWidth,\r\n    barProgressColor,\r\n    barProgressSelectedColor,\r\n    barBackgroundColor,\r\n    barBackgroundSelectedColor,\r\n    projectProgressColor,\r\n    projectProgressSelectedColor,\r\n    projectBackgroundColor,\r\n    projectBackgroundSelectedColor,\r\n    milestoneBackgroundColor,\r\n    milestoneBackgroundSelectedColor,\r\n  ]);\r\n  useEffect(() => {\r\n    const { changedTask, action } = ganttEvent;\r\n    if (changedTask) {\r\n      // 用于判断mouseLeave事件\r\n      onMouseEventRef.current = changedTask;\r\n      if (action === \"delete\") {\r\n        setGanttEvent({ action: \"\" });\r\n        setBarTasks(barTasks.filter(t => t.id !== changedTask.id));\r\n      } else if (\r\n        action === \"move\" ||\r\n        action === \"end\" ||\r\n        action === \"start\" ||\r\n        action === \"progress\"\r\n      ) {\r\n        const prevStateTask = barTasks.find(t => t.id === changedTask.id);\r\n        if (\r\n          prevStateTask &&\r\n          (prevStateTask.start.getTime() !== changedTask.start.getTime() ||\r\n            prevStateTask.end.getTime() !== changedTask.end.getTime() ||\r\n            prevStateTask.progress !== changedTask.progress)\r\n        ) {\r\n          // actions for change\r\n          const newTaskList = barTasks.map(t =>\r\n            t.id === changedTask.id ? changedTask : t\r\n          );\r\n          setBarTasks(newTaskList);\r\n        }\r\n      } else if (action === \"click\") {\r\n        onClickEvent?.(action, changedTask);\r\n      } else if (action === \"mouseenter\") {\r\n        onMouseEvent?.(action, changedTask);\r\n      }\r\n    } else if (onMouseEventRef.current) {\r\n      onMouseEvent?.(action, changedTask);\r\n    }\r\n  }, [ganttEvent, barTasks, onMouseEvent, onClickEvent]);\r\n\r\n  useEffect(() => {\r\n    if (failedTask) {\r\n      setBarTasks(barTasks.map(t => (t.id !== failedTask.id ? t : failedTask)));\r\n      setFailedTask(null);\r\n    }\r\n  }, [failedTask, barTasks]);\r\n\r\n  useEffect(() => {\r\n    const newTaskHeight = (rowHeight * barFill) / 100;\r\n    if (newTaskHeight !== taskHeight) {\r\n      setTaskHeight(newTaskHeight);\r\n    }\r\n  }, [rowHeight, barFill, taskHeight]);\r\n\r\n  useEffect(() => {\r\n    if (!listCellWidth) {\r\n      setTaskListWidth(0);\r\n    }\r\n    if (taskListRef.current) {\r\n      setTaskListWidth(taskListRef.current.offsetWidth);\r\n    }\r\n  }, [taskListRef, listCellWidth]);\r\n  // 在数据为空时宽度设为100%，和structure保持一致\r\n  useEffect(() => {\r\n    if (wrapperRef.current) {\r\n      if (tasks.length) {\r\n        setTaskListWidth(initListWidth);\r\n      } else {\r\n        setTaskListWidth(wrapperRef?.current?.offsetWidth);\r\n      }\r\n    }\r\n  }, [tasks.length, initListWidth]);\r\n  useEffect(() => {\r\n    if (wrapperRef.current) {\r\n      setSvgContainerWidth(wrapperRef.current.offsetWidth - taskListWidth);\r\n    }\r\n  }, [wrapperRef, taskListWidth]);\r\n\r\n  useEffect(() => {\r\n    if (ganttHeight) {\r\n      setSvgContainerHeight(ganttHeight + headerHeight);\r\n    } else {\r\n      setSvgContainerHeight(tasks.length * rowHeight + headerHeight);\r\n    }\r\n  }, [ganttHeight, tasks, headerHeight, rowHeight]);\r\n  useEffect(() => {\r\n    const ele = taskGanttContainerRef?.current?.horizontalContainerRef;\r\n    if (ele) {\r\n      setGanttHeight(ele.offsetHeight);\r\n    }\r\n  }, [taskGanttContainerRef?.current?.horizontalContainerRef]);\r\n\r\n  const setElementsScrollY = useCallback(() => {\r\n    eleListTableBodyRef.current &&\r\n      (eleListTableBodyRef.current.scrollTop = refScrollY.current);\r\n    taskGanttContainerRef?.current?.horizontalContainerRef &&\r\n      (taskGanttContainerRef.current.horizontalContainerRef.scrollTop =\r\n        refScrollY.current);\r\n    verticalScrollContainerRef?.current &&\r\n      (verticalScrollContainerRef.current.scrollTop = refScrollY.current);\r\n  }, []);\r\n\r\n  const setElementsScrollX = useCallback(() => {\r\n    taskGanttContainerRef?.current?.verticalGanttContainerRef &&\r\n      (taskGanttContainerRef.current.verticalGanttContainerRef.scrollLeft =\r\n        refScrollX.current);\r\n    horizontalScrollContainerRef?.current &&\r\n      (horizontalScrollContainerRef.current.scrollLeft = refScrollX.current);\r\n  }, []);\r\n\r\n  const handleWheel = useCallback(\r\n    (event: WheelEvent) => {\r\n      if (Math.abs(event.deltaX) >= Math.abs(event.deltaY)) {\r\n        if (event.deltaX !== 0) {\r\n          // @ts-ignore\r\n          const path = event.path || [];\r\n          const filterData = path.filter(\r\n            (ele: HTMLDivElement) => ele.id === \"ganttTaskListWrapper\"\r\n          );\r\n          if (filterData?.length) {\r\n            return;\r\n          }\r\n          event.preventDefault();\r\n          event.stopPropagation();\r\n          const scrollX = refScrollX.current;\r\n          const scrollMove = event.deltaX;\r\n          let newScrollX = scrollX + scrollMove;\r\n          if (newScrollX < 0) {\r\n            newScrollX = 0;\r\n          } else if (newScrollX > svgWidth) {\r\n            newScrollX = svgWidth;\r\n          }\r\n          refScrollX.current = newScrollX;\r\n          setElementsScrollX();\r\n          setScrollX(refScrollX.current);\r\n        }\r\n      } else {\r\n        event.preventDefault();\r\n        event.stopPropagation();\r\n        if (event.deltaY !== 0) {\r\n          // Y轴滚动处理\r\n          // 判断列表是否有横向滚动条\r\n          const isScroll =\r\n            eleListTableBodyRef?.current?.clientWidth !==\r\n            eleListTableBodyRef?.current?.scrollWidth;\r\n          setIsTableScrollX(isScroll);\r\n          const max = ganttFullHeight - ganttHeight;\r\n          const scrollY = refScrollY.current;\r\n          let newScrollY = scrollY + event.deltaY;\r\n          if (newScrollY < 0) {\r\n            newScrollY = 0;\r\n          } else if (newScrollY > max) {\r\n            if (isTableScrollX) {\r\n              // 16为横向滚动条的高度\r\n              newScrollY = max + scrollBarHeight;\r\n            } else {\r\n              newScrollY = max;\r\n            }\r\n          }\r\n          refScrollY.current = newScrollY;\r\n          setElementsScrollY();\r\n          setScrollY(refScrollY.current);\r\n        }\r\n      }\r\n      setIgnoreScrollEvent(true);\r\n    },\r\n    [\r\n      ganttFullHeight,\r\n      ganttHeight,\r\n      setElementsScrollX,\r\n      setElementsScrollY,\r\n      svgWidth,\r\n      isTableScrollX,\r\n    ]\r\n  );\r\n\r\n  useEffect(() => {\r\n    // subscribe if scroll is necessary\r\n    if (wrapperRef.current) {\r\n      wrapperRef.current.addEventListener(\"wheel\", handleWheel, {\r\n        passive: false,\r\n      });\r\n    }\r\n    return () => {\r\n      if (wrapperRef.current) {\r\n        wrapperRef?.current?.removeEventListener(\"wheel\", handleWheel);\r\n      }\r\n    };\r\n  }, [handleWheel]);\r\n\r\n  const handleScrollY = useCallback(\r\n    (event: SyntheticEvent<HTMLDivElement>) => {\r\n      const scrollY = refScrollY.current;\r\n      if (scrollY !== event.currentTarget.scrollTop && !ignoreScrollEvent) {\r\n        refScrollY.current = event.currentTarget.scrollTop;\r\n        setElementsScrollY();\r\n        setScrollY(refScrollY.current);\r\n      }\r\n      setIgnoreScrollEvent(false);\r\n      setCurrentConnection(null);\r\n    },\r\n    [ignoreScrollEvent, setElementsScrollY]\r\n  );\r\n\r\n  const handleScrollX = useCallback(\r\n    (event: SyntheticEvent<HTMLDivElement>) => {\r\n      const scrollX = refScrollX.current;\r\n      if (scrollX !== event.currentTarget.scrollLeft && !ignoreScrollEvent) {\r\n        refScrollX.current = event.currentTarget.scrollLeft;\r\n        setElementsScrollX();\r\n        setScrollX(refScrollX.current);\r\n      }\r\n      setIgnoreScrollEvent(false);\r\n      setCurrentConnection(null);\r\n    },\r\n    [ignoreScrollEvent, setElementsScrollX]\r\n  );\r\n\r\n  /**\r\n   * Handles arrow keys events and transform it to new scroll\r\n   */\r\n  const handleKeyDown = useCallback(\r\n    (event: React.KeyboardEvent<HTMLDivElement>) => {\r\n      if (\r\n        [\r\n          \"Down\",\r\n          \"ArrowDown\",\r\n          \"Up\",\r\n          \"ArrowUp\",\r\n          \"Left\",\r\n          \"ArrowLeft\",\r\n          \"Right\",\r\n          \"ArrowRight\",\r\n        ].includes(event.key)\r\n      ) {\r\n        event.preventDefault();\r\n        event.stopPropagation();\r\n        const scrollY = refScrollY.current;\r\n        const scrollX = refScrollX.current;\r\n        let newScrollY = scrollY;\r\n        let newScrollX = scrollX;\r\n        let isX = true;\r\n        switch (event.key) {\r\n          case \"Down\": // IE/Edge specific value\r\n          case \"ArrowDown\":\r\n            newScrollY += rowHeight;\r\n            isX = false;\r\n            break;\r\n          case \"Up\": // IE/Edge specific value\r\n          case \"ArrowUp\":\r\n            newScrollY -= rowHeight;\r\n            isX = false;\r\n            break;\r\n          case \"Left\":\r\n          case \"ArrowLeft\":\r\n            newScrollX -= columnWidth;\r\n            break;\r\n          case \"Right\": // IE/Edge specific value\r\n          case \"ArrowRight\":\r\n            newScrollX += columnWidth;\r\n            break;\r\n        }\r\n        if (isX) {\r\n          if (newScrollX < 0) {\r\n            newScrollX = 0;\r\n          } else if (newScrollX > svgWidth) {\r\n            newScrollX = svgWidth;\r\n          }\r\n          refScrollX.current = newScrollX;\r\n          setElementsScrollX();\r\n          setScrollX(refScrollX.current);\r\n        } else {\r\n          if (newScrollY < 0) {\r\n            newScrollY = 0;\r\n          } else if (newScrollY > ganttFullHeight - ganttHeight) {\r\n            newScrollY = ganttFullHeight - ganttHeight;\r\n          }\r\n          refScrollY.current = newScrollY;\r\n          setElementsScrollY();\r\n          setScrollY(refScrollY.current);\r\n        }\r\n        setIgnoreScrollEvent(true);\r\n      }\r\n    },\r\n    [\r\n      columnWidth,\r\n      ganttFullHeight,\r\n      ganttHeight,\r\n      rowHeight,\r\n      setElementsScrollX,\r\n      setElementsScrollY,\r\n      svgWidth,\r\n    ]\r\n  );\r\n\r\n  /**\r\n   * Task select event\r\n   */\r\n  const handleSelectedTask = useCallback(\r\n    (taskId: string) => {\r\n      const newSelectedTask = barTasks.find(t => t.id === taskId);\r\n      const oldSelectedTask = barTasks.find(\r\n        t => !!selectedTask && t.id === selectedTask.id\r\n      );\r\n      if (onSelect) {\r\n        if (oldSelectedTask) {\r\n          onSelect(oldSelectedTask, false);\r\n        }\r\n        if (newSelectedTask) {\r\n          onSelect(newSelectedTask, true);\r\n        }\r\n      }\r\n      setSelectedTask(newSelectedTask);\r\n    },\r\n    [barTasks, onSelect, selectedTask]\r\n  );\r\n  const boundLeft = wrapperRef.current?.getBoundingClientRect().left || 0;\r\n  const boundTop = wrapperRef.current?.getBoundingClientRect().top || 0;\r\n  const offsetLeft = taskListRef.current?.clientWidth || 0;\r\n  const gridProps: GridProps = useMemo(() => {\r\n    return {\r\n      columnWidth,\r\n      svgWidth,\r\n      tasks: tasks,\r\n      rowHeight,\r\n      dates: dateSetup.dates,\r\n      todayColor,\r\n      scrollX,\r\n      // offsetLeft: 750,\r\n      offsetLeft: boundLeft + offsetLeft,\r\n      onDateChange,\r\n    };\r\n  }, [\r\n    boundLeft,\r\n    columnWidth,\r\n    dateSetup.dates,\r\n    offsetLeft,\r\n    onDateChange,\r\n    rowHeight,\r\n    scrollX,\r\n    svgWidth,\r\n    tasks,\r\n    todayColor,\r\n  ]);\r\n  const calendarProps: CalendarProps = useMemo(() => {\r\n    return {\r\n      dateSetup,\r\n      locale,\r\n      viewMode,\r\n      headerHeight,\r\n      columnWidth,\r\n      fontFamily,\r\n      fontSize,\r\n    };\r\n  }, [\r\n    columnWidth,\r\n    dateSetup,\r\n    fontFamily,\r\n    fontSize,\r\n    headerHeight,\r\n    locale,\r\n    viewMode,\r\n  ]);\r\n  const barProps: TaskGanttContentProps = useMemo(() => {\r\n    return {\r\n      tasks: barTasks,\r\n      logTasks: logTasks,\r\n      dates: dateSetup.dates,\r\n      ganttEvent,\r\n      selectedTask,\r\n      rowHeight,\r\n      taskHeight,\r\n      columnWidth,\r\n      arrowColor,\r\n      timeStep,\r\n      fontFamily,\r\n      fontSize,\r\n      arrowIndent,\r\n      svgWidth,\r\n      setGanttEvent,\r\n      setFailedTask,\r\n      setSelectedTask: handleSelectedTask,\r\n      onDateChange,\r\n      onProgressChange,\r\n      onDoubleClick,\r\n      onDelete,\r\n      delConnection,\r\n      addConnection,\r\n      itemLinks,\r\n      isConnect,\r\n      setCurrentConnection,\r\n      currentConnection,\r\n    };\r\n  }, [\r\n    barTasks,\r\n    logTasks,\r\n    dateSetup.dates,\r\n    ganttEvent,\r\n    selectedTask,\r\n    rowHeight,\r\n    taskHeight,\r\n    columnWidth,\r\n    arrowColor,\r\n    timeStep,\r\n    fontFamily,\r\n    fontSize,\r\n    arrowIndent,\r\n    svgWidth,\r\n    setGanttEvent,\r\n    setFailedTask,\r\n    onDateChange,\r\n    onProgressChange,\r\n    onDoubleClick,\r\n    onDelete,\r\n    delConnection,\r\n    addConnection,\r\n    itemLinks,\r\n    handleSelectedTask,\r\n    isConnect,\r\n    currentConnection,\r\n  ]);\r\n  const TaskListComponent = useMemo(() => {\r\n    if (typeof renderTaskListComponent === \"function\") {\r\n      return renderTaskListComponent();\r\n    }\r\n    return null;\r\n  }, [renderTaskListComponent]);\r\n  const isHiddenShowTooltip = useMemo(() => {\r\n    return [\"move\", \"start\", \"end\", \"progress\"].includes(ganttEvent.action);\r\n  }, [ganttEvent]);\r\n  useEffect(() => {\r\n    if (TaskListComponent) {\r\n      // 解决获取不到dom元素\r\n      setTimeout(() => {\r\n        eleListTableBodyRef.current = document.querySelector(\r\n          tableQuerySelector\r\n        );\r\n      });\r\n    }\r\n  }, [TaskListComponent, tableQuerySelector]);\r\n  const todayX = useMemo(() => {\r\n    // 之前考虑通过context， 在grid-body中setState 传递移动的距离，但是页面会抖动\r\n    const now = new Date();\r\n    let tickX = 0;\r\n    let newTickX = 0;\r\n    for (let i = 0; i < dateSetup.dates.length; i++) {\r\n      const date = dateSetup.dates[i];\r\n      if (\r\n        (i + 1 !== dateSetup.dates.length &&\r\n          date.getTime() < now.getTime() &&\r\n          dateSetup.dates[i + 1].getTime() >= now.getTime()) ||\r\n        // if current date is last\r\n        (i !== 0 &&\r\n          i + 1 === dateSetup.dates.length &&\r\n          date.getTime() < now.getTime() &&\r\n          addToDate(\r\n            date,\r\n            date.getTime() - dateSetup.dates[i - 1].getTime(),\r\n            \"millisecond\"\r\n          ).getTime() >= now.getTime())\r\n      ) {\r\n        // 当天的零点的时间戳（毫秒）\r\n        const currentStamp = new Date(\r\n          new Date().toLocaleDateString()\r\n        ).getTime();\r\n        // 当天和上一个时间的差\r\n        const currentMinus =\r\n          (currentStamp + 86400000 - dateSetup.dates[i].getTime()) / 86400000;\r\n        // 前后时间差\r\n        const totalMinus =\r\n          (dateSetup.dates[i + 1].getTime() - dateSetup.dates[i].getTime()) /\r\n          86400000;\r\n        newTickX =\r\n          tickX +\r\n          columnWidth * (currentMinus / totalMinus) -\r\n          columnWidth / totalMinus / 2;\r\n      }\r\n      tickX += columnWidth;\r\n    }\r\n    return newTickX;\r\n  }, [columnWidth, dateSetup.dates]);\r\n  const toToday = useCallback(() => {\r\n    refScrollX.current = todayX - svgContainerWidth / 2;\r\n    setElementsScrollX();\r\n    setScrollX(refScrollX.current);\r\n  }, [setElementsScrollX, svgContainerWidth, todayX]);\r\n\r\n  useEffect(() => {\r\n    toToday();\r\n  }, [toToday]);\r\n\r\n  const toConfig = useCallback(() => {\r\n    setVisible(true);\r\n    configVisibleChange?.(true);\r\n  }, [configVisibleChange]);\r\n  const toGantt = useCallback(() => {\r\n    setVisible(false);\r\n    configVisibleChange?.(false);\r\n  }, [configVisibleChange]);\r\n  const modeChange = useCallback((val: ViewMode) => {\r\n    setViewMode(val);\r\n    setColumnWidth(widthData[val] || 60);\r\n  }, []);\r\n  const handleDividerMouseDown = useCallback(\r\n    (event: React.MouseEvent<HTMLDivElement, MouseEvent>) => {\r\n      const handleMouseMove = (event: MouseEvent) => {\r\n        const distance = event.clientX - dividerPositionRef.current.left;\r\n        const minWidth = 220; // 拖动时，列表最小宽度为220\r\n        const width =\r\n          taskListWidth + distance > minWidth\r\n            ? taskListWidth + distance\r\n            : minWidth;\r\n        setTaskListWidth(width);\r\n        utils.setLocalStorageItem(CACHE_LIST_WIDTH_KEY, width);\r\n      };\r\n      const handleMouseUp = () => {\r\n        window.removeEventListener(\"mousemove\", handleMouseMove);\r\n        window.removeEventListener(\"mouseup\", handleMouseUp);\r\n        const isScroll =\r\n          eleListTableBodyRef?.current?.clientWidth !==\r\n          eleListTableBodyRef?.current?.scrollWidth;\r\n        setIsTableScrollX(isScroll);\r\n      };\r\n      dividerPositionRef.current.left = event.clientX;\r\n      window.addEventListener(\"mousemove\", handleMouseMove);\r\n      window.addEventListener(\"mouseup\", handleMouseUp);\r\n    },\r\n    [taskListWidth]\r\n  );\r\n\r\n  const handleDividerClick = useCallback(\r\n    (event: React.MouseEvent<HTMLDivElement, MouseEvent>) => {\r\n      let width;\r\n      if (taskListWidth > minWidth) {\r\n        dividerPositionRef.current.left = taskListWidth;\r\n        width = minWidth;\r\n      } else {\r\n        width = dividerPositionRef.current.left || listWidth;\r\n      }\r\n      setTaskListWidth(width);\r\n      utils.setLocalStorageItem(CACHE_LIST_WIDTH_KEY, width);\r\n      event.stopPropagation();\r\n    },\r\n    [listWidth, taskListWidth]\r\n  );\r\n  // 退出基线\r\n  const baselineExit = () => {\r\n    setCurrentLog?.({});\r\n    setLogTasks([]);\r\n  };\r\n  const toPanel = useCallback(() => {\r\n    setGuideModalVisible(false);\r\n    toConfig();\r\n  }, [toConfig]);\r\n  React.useImperativeHandle(actionRef, () => ({\r\n    openGuide(type: string) {\r\n      setCurrentPanel(type);\r\n      setGuideModalVisible(true);\r\n    },\r\n    toPanel: toPanel,\r\n  }));\r\n\r\n  const panelCanel = useCallback(() => {\r\n    setGuideModalVisible(false);\r\n  }, []);\r\n  const OverflowTooltip = useCallback(\r\n    (value: string) => {\r\n      if (typeof renderOverflowTooltip === \"function\") {\r\n        return renderOverflowTooltip(value);\r\n      }\r\n      return <React.Fragment />;\r\n    },\r\n    [renderOverflowTooltip]\r\n  );\r\n  return (\r\n    <div className={styles.box}>\r\n      <GuideModal\r\n        visible={guideModalVisible}\r\n        toPanel={toPanel}\r\n        toCancel={panelCanel}\r\n      />\r\n      <GanttConfigContext.Provider\r\n        value={{\r\n          ganttConfig,\r\n        }}\r\n      >\r\n        <ConfigHandleContext.Provider\r\n          value={{\r\n            configHandle,\r\n            itemTypeData,\r\n            workspaceId,\r\n            getCustomFields,\r\n          }}\r\n        >\r\n          <BaseLineContext.Provider\r\n            value={{\r\n              baseLineHandle,\r\n              baselineList,\r\n              setCurrentLog,\r\n              setLogTasks,\r\n              currentLog,\r\n              OverflowTooltip,\r\n            }}\r\n          >\r\n            <GanttConfig\r\n              toGantt={toGantt}\r\n              visible={visible}\r\n              currentPanel={currentPanel}\r\n              configHandle={configHandle}\r\n              ganttConfig={ganttConfig}\r\n            />\r\n          </BaseLineContext.Provider>\r\n        </ConfigHandleContext.Provider>\r\n        <div\r\n          className={styles.wrapper}\r\n          onKeyDown={handleKeyDown}\r\n          tabIndex={0}\r\n          ref={wrapperRef}\r\n        >\r\n          {currentLog?.name && (\r\n            <div className={styles.choosedBaselIne}>\r\n              <span className={styles.loaded}>\r\n                {OverflowTooltip(`已加载：${currentLog?.name}`)}\r\n              </span>\r\n              <Button size=\"small\" onClick={baselineExit}>\r\n                退出\r\n              </Button>\r\n            </div>\r\n          )}\r\n\r\n          {listCellWidth && TaskListComponent && (\r\n            <div\r\n              ref={taskListRef}\r\n              className={styles.taskListWrapper}\r\n              id=\"ganttTaskListWrapper\"\r\n              style={{\r\n                width: `${taskListWidth}px`,\r\n                visibility: tasks?.length ? \"visible\" : \"hidden\",\r\n              }}\r\n            >\r\n              {TaskListComponent}\r\n            </div>\r\n          )}\r\n          {tasks.length > 0 && (\r\n            <TaskGantt\r\n              ref={taskGanttContainerRef}\r\n              gridProps={gridProps}\r\n              calendarProps={calendarProps}\r\n              barProps={barProps}\r\n              ganttHeight={ganttHeight}\r\n              scrollX={scrollX}\r\n              onScroll={handleScrollX}\r\n              listBottomHeight={listBottomHeight}\r\n              taskListHeight={taskListRef?.current?.offsetHeight}\r\n              headerHeight={headerHeight}\r\n            />\r\n          )}\r\n          <div\r\n            className={\r\n              taskListWidth <= minWidth\r\n                ? `${styles.dividerWrapper} ${styles.reverse}`\r\n                : styles.dividerWrapper\r\n            }\r\n            style={{\r\n              left: `${\r\n                taskListWidth - minWidth > 0\r\n                  ? taskListWidth + paddingLeft\r\n                  : paddingLeft\r\n              }px`,\r\n              visibility: tasks?.length ? \"visible\" : \"hidden\",\r\n              height: `calc(100% - ${listBottomHeight}px)`,\r\n            }}\r\n          >\r\n            <div\r\n              className={styles.dividerContainer}\r\n              style={{\r\n                height: `calc(100% - ${headerHeight}px)`,\r\n                top: `${headerHeight}px`,\r\n              }}\r\n            >\r\n              <hr\r\n                onMouseDown={\r\n                  taskListWidth <= minWidth ? undefined : handleDividerMouseDown\r\n                }\r\n              />\r\n              <hr className={styles.maskLine} />\r\n              <hr className={styles.maskLineTop} />\r\n              <span\r\n                className={styles.dividerIconWarpper}\r\n                onMouseDown={e => e.stopPropagation()}\r\n                onClick={handleDividerClick}\r\n              >\r\n                <ArrowIcon />\r\n              </span>\r\n            </div>\r\n          </div>\r\n          {isViewModeChange && (\r\n            <DataMode\r\n              toToday={toToday}\r\n              modeChange={modeChange}\r\n              todayX={todayX}\r\n              svgContainerWidth={svgContainerWidth}\r\n              refScrollX={refScrollX.current}\r\n            />\r\n          )}\r\n          {ganttEvent.changedTask && !isHiddenShowTooltip && (\r\n            <Tooltip\r\n              arrowIndent={arrowIndent}\r\n              rowHeight={rowHeight}\r\n              svgContainerHeight={svgContainerHeight}\r\n              svgContainerWidth={svgContainerWidth}\r\n              fontFamily={fontFamily}\r\n              fontSize={fontSize}\r\n              scrollX={scrollX}\r\n              scrollY={scrollY}\r\n              task={ganttEvent.changedTask}\r\n              headerHeight={headerHeight}\r\n              taskListWidth={taskListWidth}\r\n              TooltipContent={TooltipContent}\r\n              renderUserAvatar={renderUserAvatar}\r\n            />\r\n          )}\r\n          {currentConnection && (\r\n            <DeleteTooltip\r\n              tasks={tasks}\r\n              taskListWidth={taskListWidth}\r\n              currentConnection={currentConnection}\r\n              boundTop={boundTop}\r\n              itemLinks={itemLinks}\r\n              delConnection={delConnection}\r\n              setCurrentConnection={setCurrentConnection}\r\n              svgContainerHeight={svgContainerHeight}\r\n            />\r\n          )}\r\n          {tasks.length > 0 && (\r\n            <VerticalScroll\r\n              ref={verticalScrollContainerRef}\r\n              ganttFullHeight={ganttFullHeight}\r\n              ganttHeight={ganttHeight}\r\n              headerHeight={headerHeight}\r\n              listBottomHeight={listBottomHeight}\r\n              onScroll={handleScrollY}\r\n            />\r\n          )}\r\n          {tasks.length > 0 && (\r\n            <HorizontalScroll\r\n              ref={horizontalScrollContainerRef}\r\n              listBottomHeight={\r\n                isTableScrollX\r\n                  ? listBottomHeight\r\n                  : listBottomHeight - scrollBarHeight\r\n              }\r\n              svgWidth={svgWidth}\r\n              taskListWidth={taskListWidth}\r\n              onScroll={handleScrollX}\r\n            />\r\n          )}\r\n        </div>\r\n      </GanttConfigContext.Provider>\r\n    </div>\r\n  );\r\n};\r\n"],"names":["ViewMode","viewModeOptions","label","value","DateDeltaInit","Month","Year","common","leap","Quarter","LeapMounth","LeapQuarter","intlDTCache","getCachedDateTimeFormat","locString","opts","key","JSON","stringify","dtf","Intl","DateTimeFormat","addToDate","date","quantity","scale","newDate","Date","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","getMilliseconds","startOfDate","scores","shouldReset","_scale","maxScore","indexOf","ganttDateRange","viewMode","newStartDate","now","newEndDate","year","oneYear","Week","getMonday","Day","seedDates","startDate","endDate","currentDate","dates","HalfDay","QuarterDay","push","getLocaleMonth","locale","bottomValue","month","format","replace","toLocaleUpperCase","day","getDay","diff","setDate","getWeekNumberISO8601","tmpDate","valueOf","dayNumber","firstThursday","setMonth","weekNumber","Math","ceil","toString","length","barBackgroundColorPivotalPath","barBackgroundColorTimeError","errorLinkBorderColor","pivotalPathLinkBorderColor","scrollBarHeight","dayFormat","dayTimeFormat","drawerWidth","daySeconds","Tooltip","memo","task","rowHeight","svgContainerHeight","svgContainerWidth","scrollX","scrollY","arrowIndent","fontSize","fontFamily","headerHeight","taskListWidth","TooltipContent","renderUserAvatar","tooltipRef","useRef","useState","relatedY","setRelatedY","relatedX","setRelatedX","UserAvatar","useMemo","item","assignee","React","Fragment","useEffect","current","newRelatedX","x2","newRelatedY","index","tooltipHeight","offsetHeight","tooltipWidth","offsetWidth","tooltipLowerPoint","tooltipLeftmostPoint","fullChartWidth","x1","ref","className","styles","tooltipDetailsContainer","tooltipDetailsContainerHidden","style","left","type","top","userAvatar","StandardTooltipContent","tooltipDefaultContainer","tooltipId","tooltipName","name","lightColor","status","dayjs","end","start","Svg","IconComponent","props","Icon","DeleteTooltip","tasks","delConnection","itemLinks","currentConnection","boundTop","setCurrentConnection","path","window","location","origin","sourceTask","filter","ele","id","connection","sourceId","targetTask","targetId","originalEvent","clientY","clientX","removeConnection","currentLink","source","objectId","destination","linkType","getData","tooltipDeleteContainer","tooltipDeleteDefaultContainer","taskInfo","title","itemType","icon","src","endpoints","anchor","cssClass","connect","connectionLine","connectionIcon","ConnectionIcon","unconnectionIcon","onClick","UnconnectionIcon","VerticalScrollComponent","ganttHeight","ganttFullHeight","onScroll","listBottomHeight","scrollHeight","height","marginTop","marginBottom","scroll","width","VerticalScroll","forwardRef","GanttConfigContext","createContext","ConfigHandleContext","BaseLineContext","extend","weekday","isRestDay","dt","includes","GridBody","svgWidth","columnWidth","todayColor","offsetLeft","taskListHeight","onDateChange","useContext","ganttConfig","translateX","setTranslateX","translateY","setTranslateY","isShow","setIsShow","parts","setParts","remainderDays","setRemainderDays","currentIndex","setCurrentDataIndex","y","invalidColumn","gridRows","rowLines","x","y1","y2","gridRowLine","handleMouseMove","useCallback","event","pointerX","currentDataIndex","floor","dateRemainder","dayWidth","remainder","handleInvalidColumnMouseMove","row","invalidBarClick","taskIndex","Object","assign","time","startOf","toDate","i","onMouseEnter","e","target","parentNode","firstChild","fill","onMouseLeave","gridRow","onMouseMove","ry","rx","cursor","getAttribute","Number","tickX","ticks","today","getTime","gridTick","gridTickWeekday","currentStamp","toLocaleDateString","currentMinus","totalMinus","newTickX","cx","cy","r","stroke","strokeWidth","invalidBar","defaultProps","Grid","TopPartOfCalendar","x1Line","y1Line","y2Line","xText","yText","calendarTopTick","calendarTopText","Calendar","dateSetup","bottomValuesInit","calendarBottomText","getCalendarValuesForYear","topValues","bottomValues","getCalendarValuesForQuarter","topDefaultWidth","topDefaultHeight","currentQuarter","topValue","getCalendarValuesForMonth","getCalendarValuesForWeek","weeksCount","getCalendarValuesForDay","getCalendarValuesForOther","hour","calendarHeader","Arrow","taskFrom","taskTo","taskHeight","indexCompare","taskToEndPosition","trianglePoints","d","points","isKeyboardEvent","undefined","isLeapYear","getQuarter","currMonth","convertToBarTasks","barCornerRadius","handleWidth","barProgressColor","barProgressSelectedColor","barBackgroundColor","barBackgroundSelectedColor","projectProgressColor","projectProgressSelectedColor","projectBackgroundColor","projectBackgroundSelectedColor","milestoneBackgroundColor","milestoneBackgroundSelectedColor","dateDelta","getTimezoneOffset","barTasks","map","t","convertToBarTask","dependencies","j","dependence","findIndex","barChildren","barTask","convertToMilestone","convertToBar","taskXCoordinate","taskYCoordinate","backgroundColor","backgroundSelectedColor","progressColor","progressSelectedColor","typeInternal","progress","xDate","precision","round","progressWithByParams","taskX1","taskX2","progressByX","barWidth","progressPercent","getProgressPoint","progressX","taskY","point","join","startByX","xStep","steps","additionalXValue","newX","endByX","moveByX","newX1","newX2","dateByX","taskX","taskDate","timeStep","handleTaskBySVGMouseEvent","svgX","action","selectedTask","initEventX1Delta","result","handleTaskBySVGMouseEventForMilestone","handleTaskBySVGMouseEventForBar","changedTask","isChanged","newMoveX1","newMoveX2","BarDisplay","isSelected","progressWidth","onMouseDown","isLog","getBarColor","isTimeErrorItem","isOverdueItem","isPivotalPathItem","barBackground","opacity","BarDateHandle","BarProgressHandle","progressPoint","barHandleProgress","canChangeLayout","commonConfig","isSource","isTarget","maxConnections","endpoint","radius","endpointStyle","connector","alwaysRespectStubs","cornerRadius","stub","connectorStyle","strokeOpacity","connectorHoverStyle","outlineWidth","outlineStroke","connectorOverlays","offsetCalculators","CIRCLE","el","parseInt","ELLIPSE","RECT","sizeCalculators","w","h","relationInit","FS","FF","SS","SF","relationReverse","pointOverEvent","barRef","jsPlumb","classList","add","selectEndpoints","element","addClass","pointOutEvent","remove","removeClass","barAnchor","milestone","Left","Right","normal","useHover","passiveAction","addHoverClass","setVisible","removeHoverClass","nodeDom","addEventListener","removeEventListener","useAddPoint","addPointFinished","setAddPointFinished","setIdChanged","rightPoint","addEndpoint","uuid","bind","leftPoint","deleteEndpoint","Bar","isProgressChangeable","isDateChangeable","onEventStart","setPointInited","ganttEvent","handleHeight","revalidate","barWrapper","tabIndex","barHandleBackground","BarSmall","triangleX","triangleY","projectLeftTriangle","projectRightTriangle","BarParent","base64Milestone","Milestone","milestoneWrapper","milestoneBackground","href","Project","barColor","processColor","projectWith","projectWrapper","projectBackground","projectTop","TaskItem","isDelete","taskItem","setTaskItem","onKeyDown","stopPropagation","onDoubleClick","onFocus","TaskItemLog","TaskGanttContent","logTasks","svg","arrowColor","setGanttEvent","setFailedTask","setSelectedTask","onProgressChange","onDelete","addConnection","clickBaselineItem","isConnect","containerRef","connectUuids","setConnectUuids","createSVGPoint","setXStep","setInitEventX1Delta","isMoving","setIsMoving","jsPlumbInstance","setJsPlumbInstance","pointInited","connectClickHandle","container","connections","getConnections","forEach","newXStep","preventDefault","matrixTransform","getScreenCTM","inverse","handleMouseUp","operationSuccess","originalSelectedTask","newChangedTask","isNotLikeOriginal","handleBarEventStart","error","console","offsetX","nativeEvent","currentLogItem","getLinkTypeId","relation","getHasLinkItems","hasLinkItems","link","needUpdateItems","keys","concat","checkIsPivotalPathLink","relationType","targetPivotalPathItem","checkIsErrorLink","subItems","subItem","flag","targetItems","ancestors","then","ready","instance","getInstance","fire","originalOffset","getOffset","originalSize","getSize","tn","tagName","toUpperCase","apply","setContainer","conn","taskSource","taskTarget","message","warning","linkTypeId","dropEndpoint","desinationTask","infor","params","setData","select","unbind","isEqual","newConnectUuids","itemFilter","isErrorLink","isPivotalPathLink","setSuspendDrawing","uuidObj","uuids","setPaintStyle","deleteEveryConnection","child","cuttentLog","find","isDisabled","TaskGanttComponent","gridProps","calendarProps","barProps","ganttSVGRef","horizontalContainerRef","verticalGanttContainerRef","newBarProps","useImperativeHandle","ganttVerticalContainer","xmlns","horizontalContainer","position","TaskGantt","HorizontalScrollComponent","dividerWidth","marginLeft","bottom","HorizontalScroll","Option","Select","filterOption","input","option","toLowerCase","filterFields","customField","fieldType","filterDeleteFields","filterData","ItemModal","visible","handleCancel","handleOk","currentItem","timeList","Form","useForm","form","itemTypeData","getCustomFields","setIsSelected","setCustomField","confirmLoading","setConfirmLoading","resetFields","setFieldsValue","percentage","isDefault","fetch","fields","handleConfirm","validateFields","values","omit","fileldFilter","f","obj","info","log","itemCheck","_","Promise","reject","Error","resolve","handelChange","val","Modal","onOk","onCancel","cancelText","okText","labelCol","span","wrapperCol","layout","Item","rules","required","validator","placeholder","onChange","showSearch","allowClear","Time","columns","dataIndex","render","text","res","QuestionCircleOutlined","_text","record","Space","editTime","del","configHandle","setCurrentItem","setIndex","newTimeList","addTime","confirm","content","delConfig","splice","TimeModal","timeTips","WarningIcon","color","Table","dataSource","pagination","timeConfigTable","rowKey","timeConfigAddBtn","Button","PlusOutlined","OtherConfig","checked","setChecked","otherConfig","autoPatch","question","Switch","TextArea","Input","AddEdit","currentBaseline","modalVisible","setModalVisible","baselineList","isEdit","description","onFinish","confirmOk","nameValidator","callback","findRepeat","maxLength","BaseLine","baseLineHandle","setCurrentLog","currentLog","OverflowTooltip","setLogTasks","deleteBaseline","handleMenuClick","currentBaseLine","currentBaselineOmit","setCurrentBaseline","addBaseline","chooseLog","panel","createBaseline","disabled","list","activeBaseline","checkedIcon","Checked","createTime","createdAt","handleIcon","EditOutlined","DeleteOutlined","Display","currentValue","setCurrentValue","handleChange","newConfig","displayPopover","Row","displayRow","Col","textAlignR","pivotalPath","overdue","Panel","Collapse","GanttConfig","toGantt","currentPanel","activeKey","setActiveKey","isArray","genHeader","extraHeader","des","Drawer","onClose","getContainer","settingsModalContainer","contentWrapperStyle","maxWidth","maskClosable","mask","expandIcon","isActive","CollapseIcon","activeRotate","collapse","header","Baseline","GuideModal","toPanel","toCancel","toConfig","closable","footer","guideInfor","clickThis","getLocalStorageItem","defalut","localStorage","getItem","parse","setLocalStorageItem","setItem","TabPane","Tabs","DataMode","toToday","modeChange","todayX","refScrollX","isShowToday","todayBtn","dataMode","defaultActiveKey","tabPosition","tab","widthData","Gantt","baseLineLog","isUpdate","listCellWidth","listWidth","barFill","onSelect","renderTaskListComponent","renderOverflowTooltip","actionRef","workspaceId","isViewModeChange","onMouseEvent","onClickEvent","configVisibleChange","tableQuerySelector","wrapperRef","taskListRef","onMouseEventRef","taskGanttContainerRef","verticalScrollContainerRef","horizontalScrollContainerRef","setViewMode","setColumnWidth","setDateSetup","CACHE_LIST_WIDTH_KEY","cacheListWidth","utils","initListWidth","setTaskHeight","setTaskListWidth","setSvgContainerWidth","setGanttHeight","setSvgContainerHeight","setBarTasks","isTableScrollX","setIsTableScrollX","failedTask","eleListTableBodyRef","setScrollY","setScrollX","refScrollY","ignoreScrollEvent","setIgnoreScrollEvent","guideModalVisible","setGuideModalVisible","setCurrentPanel","dividerPositionRef","minWidth","paddingLeft","newDates","prevStateTask","newTaskList","newTaskHeight","setElementsScrollY","scrollTop","setElementsScrollX","scrollLeft","handleWheel","abs","deltaX","deltaY","scrollMove","newScrollX","isScroll","clientWidth","scrollWidth","max","newScrollY","passive","handleScrollY","currentTarget","handleScrollX","handleKeyDown","isX","handleSelectedTask","taskId","newSelectedTask","oldSelectedTask","boundLeft","getBoundingClientRect","TaskListComponent","isHiddenShowTooltip","setTimeout","document","querySelector","handleDividerMouseDown","distance","handleDividerClick","baselineExit","openGuide","panelCanel","box","Provider","wrapper","choosedBaselIne","loaded","size","taskListWrapper","visibility","dividerWrapper","reverse","dividerContainer","maskLine","maskLineTop","dividerIconWarpper","ArrowIcon"],"mappings":"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"}